module.exports=[7782,(e,t,r)=>{"use strict";var i,n,s;Object.defineProperty(r,"__esModule",{value:!0}),r.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=r.DEFAULT_MAX_SEND_MESSAGE_LENGTH=r.Propagate=r.LogVerbosity=r.Status=void 0,function(e){e[e.OK=0]="OK",e[e.CANCELLED=1]="CANCELLED",e[e.UNKNOWN=2]="UNKNOWN",e[e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",e[e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",e[e.NOT_FOUND=5]="NOT_FOUND",e[e.ALREADY_EXISTS=6]="ALREADY_EXISTS",e[e.PERMISSION_DENIED=7]="PERMISSION_DENIED",e[e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",e[e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",e[e.ABORTED=10]="ABORTED",e[e.OUT_OF_RANGE=11]="OUT_OF_RANGE",e[e.UNIMPLEMENTED=12]="UNIMPLEMENTED",e[e.INTERNAL=13]="INTERNAL",e[e.UNAVAILABLE=14]="UNAVAILABLE",e[e.DATA_LOSS=15]="DATA_LOSS",e[e.UNAUTHENTICATED=16]="UNAUTHENTICATED"}(i||(r.Status=i={})),function(e){e[e.DEBUG=0]="DEBUG",e[e.INFO=1]="INFO",e[e.ERROR=2]="ERROR",e[e.NONE=3]="NONE"}(n||(r.LogVerbosity=n={})),function(e){e[e.DEADLINE=1]="DEADLINE",e[e.CENSUS_STATS_CONTEXT=2]="CENSUS_STATS_CONTEXT",e[e.CENSUS_TRACING_CONTEXT=4]="CENSUS_TRACING_CONTEXT",e[e.CANCELLATION=8]="CANCELLATION",e[e.DEFAULTS=65535]="DEFAULTS"}(s||(r.Propagate=s={})),r.DEFAULT_MAX_SEND_MESSAGE_LENGTH=-1,r.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH=4194304},33137,(e,t,r)=>{"use strict";var i,n,s,a;Object.defineProperty(r,"__esModule",{value:!0}),r.isTracerEnabled=r.trace=r.log=r.setLoggerVerbosity=r.setLogger=r.getLogger=void 0;let o=e.r(7782),l=e.r(5365),c=e.r(65748).version,u={error:(e,...t)=>{console.error("E "+e,...t)},info:(e,...t)=>{console.error("I "+e,...t)},debug:(e,...t)=>{console.error("D "+e,...t)}},h=o.LogVerbosity.ERROR;switch((null!=(n=null!=(i=process.env.GRPC_NODE_VERBOSITY)?i:process.env.GRPC_VERBOSITY)?n:"").toUpperCase()){case"DEBUG":h=o.LogVerbosity.DEBUG;break;case"INFO":h=o.LogVerbosity.INFO;break;case"ERROR":h=o.LogVerbosity.ERROR;break;case"NONE":h=o.LogVerbosity.NONE}r.getLogger=()=>u,r.setLogger=e=>{u=e},r.setLoggerVerbosity=e=>{h=e},r.log=(e,...t)=>{let r;if(e>=h){switch(e){case o.LogVerbosity.DEBUG:r=u.debug;break;case o.LogVerbosity.INFO:r=u.info;break;case o.LogVerbosity.ERROR:r=u.error}r||(r=u.error),r&&r.bind(u)(...t)}};let d=null!=(a=null!=(s=process.env.GRPC_NODE_TRACE)?s:process.env.GRPC_TRACE)?a:"",f=new Set,p=new Set;for(let e of d.split(","))e.startsWith("-")?p.add(e.substring(1)):f.add(e);let m=f.has("all");function g(e,t,i){y(t)&&(0,r.log)(e,new Date().toISOString()+" | v"+c+" "+l.pid+" | "+t+" | "+i)}function y(e){return!p.has(e)&&(m||f.has(e))}r.trace=g,r.isTracerEnabled=y},44162,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getErrorCode=r.getErrorMessage=void 0,r.getErrorMessage=function(e){return e instanceof Error?e.message:String(e)},r.getErrorCode=function(e){return"object"==typeof e&&null!==e&&"code"in e&&"number"==typeof e.code?e.code:null}},10409,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Metadata=void 0;let i=e.r(33137),n=e.r(7782),s=e.r(44162),a=/^[0-9a-z_.-]+$/,o=/^[ -~]*$/;function l(e){return a.test(e)}function c(e){return o.test(e)}function u(e){return e.endsWith("-bin")}function h(e){return!e.startsWith("grpc-")}function d(e){return e.toLowerCase()}function f(e,t){if(!l(e))throw Error('Metadata key "'+e+'" contains illegal characters');if(null!=t)if(u(e)){if(!Buffer.isBuffer(t))throw Error("keys that end with '-bin' must have Buffer values")}else{if(Buffer.isBuffer(t))throw Error("keys that don't end with '-bin' must have String values");if(!c(t))throw Error('Metadata string value "'+t+'" contains illegal characters')}}class p{constructor(e={}){this.internalRepr=new Map,this.options=e}set(e,t){f(e=d(e),t),this.internalRepr.set(e,[t])}add(e,t){f(e=d(e),t);let r=this.internalRepr.get(e);void 0===r?this.internalRepr.set(e,[t]):r.push(t)}remove(e){e=d(e),this.internalRepr.delete(e)}get(e){return e=d(e),this.internalRepr.get(e)||[]}getMap(){let e={};for(let[t,r]of this.internalRepr)if(r.length>0){let i=r[0];e[t]=Buffer.isBuffer(i)?Buffer.from(i):i}return e}clone(){let e=new p(this.options),t=e.internalRepr;for(let[e,r]of this.internalRepr){let i=r.map(e=>Buffer.isBuffer(e)?Buffer.from(e):e);t.set(e,i)}return e}merge(e){for(let[t,r]of e.internalRepr){let e=(this.internalRepr.get(t)||[]).concat(r);this.internalRepr.set(t,e)}}setOptions(e){this.options=e}getOptions(){return this.options}toHttp2Headers(){let e={};for(let[t,r]of this.internalRepr)e[t]=r.map(m);return e}toJSON(){let e={};for(let[t,r]of this.internalRepr)e[t]=r;return e}static fromHttp2Headers(e){let t=new p;for(let r of Object.keys(e)){if(":"===r.charAt(0))continue;let a=e[r];try{u(r)?Array.isArray(a)?a.forEach(e=>{t.add(r,Buffer.from(e,"base64"))}):void 0!==a&&(h(r)?a.split(",").forEach(e=>{t.add(r,Buffer.from(e.trim(),"base64"))}):t.add(r,Buffer.from(a,"base64"))):Array.isArray(a)?a.forEach(e=>{t.add(r,e)}):void 0!==a&&t.add(r,a)}catch(t){let e=`Failed to add metadata entry ${r}: ${a}. ${(0,s.getErrorMessage)(t)}. For more information see https://github.com/grpc/grpc-node/issues/1173`;(0,i.log)(n.LogVerbosity.ERROR,e)}}return t}}r.Metadata=p;let m=e=>Buffer.isBuffer(e)?e.toString("base64"):e},30470,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.CallCredentials=void 0;let i=e.r(10409);function n(e){return"getRequestHeaders"in e&&"function"==typeof e.getRequestHeaders}class s{static createFromMetadataGenerator(e){return new o(e)}static createFromGoogleCredential(e){return s.createFromMetadataGenerator((t,r)=>{let s;(s=n(e)?e.getRequestHeaders(t.service_url):new Promise((r,i)=>{e.getRequestMetadata(t.service_url,(e,t)=>{e?i(e):t?r(t):i(Error("Headers not set by metadata plugin"))})})).then(e=>{let t=new i.Metadata;for(let r of Object.keys(e))t.add(r,e[r]);r(null,t)},e=>{r(e)})})}static createEmpty(){return new l}}r.CallCredentials=s;class a extends s{constructor(e){super(),this.creds=e}async generateMetadata(e){let t=new i.Metadata;for(let r of(await Promise.all(this.creds.map(t=>t.generateMetadata(e)))))t.merge(r);return t}compose(e){return new a(this.creds.concat([e]))}_equals(e){return this===e||e instanceof a&&this.creds.every((t,r)=>t._equals(e.creds[r]))}}class o extends s{constructor(e){super(),this.metadataGenerator=e}generateMetadata(e){return new Promise((t,r)=>{this.metadataGenerator(e,(e,i)=>{void 0!==i?t(i):r(e)})})}compose(e){return new a([this,e])}_equals(e){return this===e||e instanceof o&&this.metadataGenerator===e.metadataGenerator}}class l extends s{generateMetadata(e){return Promise.resolve(new i.Metadata)}compose(e){return e}_equals(e){return e instanceof l}}},19335,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getDefaultRootsData=r.CIPHER_SUITES=void 0;let i=e.r(22734);r.CIPHER_SUITES=process.env.GRPC_SSL_CIPHER_SUITES;let n=process.env.GRPC_DEFAULT_SSL_ROOTS_FILE_PATH,s=null;r.getDefaultRootsData=function(){return n?(null===s&&(s=i.readFileSync(n)),s):null}},11877,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ChannelCredentials=void 0;let i=e.r(55004),n=e.r(30470),s=e.r(19335);function a(e,t){if(e&&!(e instanceof Buffer))throw TypeError(`${t}, if provided, must be a Buffer.`)}class o{constructor(e){this.callCredentials=e||n.CallCredentials.createEmpty()}_getCallCredentials(){return this.callCredentials}static createSsl(e,t,r,n){var o;if(a(e,"Root certificate"),a(t,"Private key"),a(r,"Certificate chain"),t&&!r)throw Error("Private key must be given with accompanying certificate chain");if(!t&&r)throw Error("Certificate chain must be given with accompanying private key");return new c((0,i.createSecureContext)({ca:null!=(o=null!=e?e:(0,s.getDefaultRootsData)())?o:void 0,key:null!=t?t:void 0,cert:null!=r?r:void 0,ciphers:s.CIPHER_SUITES}),null!=n?n:{})}static createFromSecureContext(e,t){return new c(e,null!=t?t:{})}static createInsecure(){return new l}}r.ChannelCredentials=o;class l extends o{constructor(e){super(e)}compose(e){throw Error("Cannot compose insecure credentials")}_getConnectionOptions(){return null}_isSecure(){return!1}_equals(e){return e instanceof l}}class c extends o{constructor(e,t){super(),this.secureContext=e,this.verifyOptions=t,this.connectionOptions={secureContext:e},(null==t?void 0:t.checkServerIdentity)&&(this.connectionOptions.checkServerIdentity=t.checkServerIdentity)}compose(e){return new u(this,this.callCredentials.compose(e))}_getConnectionOptions(){return Object.assign({},this.connectionOptions)}_isSecure(){return!0}_equals(e){return this===e||e instanceof c&&this.secureContext===e.secureContext&&this.verifyOptions.checkServerIdentity===e.verifyOptions.checkServerIdentity}}class u extends o{constructor(e,t){super(t),this.channelCredentials=e}compose(e){let t=this.callCredentials.compose(e);return new u(this.channelCredentials,t)}_getConnectionOptions(){return this.channelCredentials._getConnectionOptions()}_isSecure(){return!0}_equals(e){return this===e||e instanceof u&&this.channelCredentials._equals(e.channelCredentials)&&this.callCredentials._equals(e.callCredentials)}}},29068,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.validateLoadBalancingConfig=r.getFirstUsableConfig=r.isLoadBalancerNameRegistered=r.createLoadBalancer=r.registerDefaultLoadBalancerType=r.registerLoadBalancerType=r.createChildChannelControlHelper=void 0,r.createChildChannelControlHelper=function(e,t){var r,i,n,s,a,o,l,c,u,h;return{createSubchannel:null!=(i=null==(r=t.createSubchannel)?void 0:r.bind(t))?i:e.createSubchannel.bind(e),updateState:null!=(s=null==(n=t.updateState)?void 0:n.bind(t))?s:e.updateState.bind(e),requestReresolution:null!=(o=null==(a=t.requestReresolution)?void 0:a.bind(t))?o:e.requestReresolution.bind(e),addChannelzChild:null!=(c=null==(l=t.addChannelzChild)?void 0:l.bind(t))?c:e.addChannelzChild.bind(e),removeChannelzChild:null!=(h=null==(u=t.removeChannelzChild)?void 0:u.bind(t))?h:e.removeChannelzChild.bind(e)}};let i={},n=null;r.registerLoadBalancerType=function(e,t,r){i[e]={LoadBalancer:t,LoadBalancingConfig:r}},r.registerDefaultLoadBalancerType=function(e){n=e},r.createLoadBalancer=function(e,t){let r=e.getLoadBalancerName();return r in i?new i[r].LoadBalancer(t):null},r.isLoadBalancerNameRegistered=function(e){return e in i},r.getFirstUsableConfig=function(e,t=!1){for(let t of e)if(t.getLoadBalancerName()in i)return t;return t&&n?new i[n].LoadBalancingConfig:null},r.validateLoadBalancingConfig=function(e){if(null===e||"object"!=typeof e)throw Error("Load balancing config must be an object");let t=Object.keys(e);if(1!==t.length)throw Error("Provided load balancing config has multiple conflicting entries");let r=t[0];if(r in i)return i[r].LoadBalancingConfig.createFromJson(e[r]);throw Error(`Unrecognized load balancing config name ${r}`)}},63361,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.extractAndSelectServiceConfig=r.validateServiceConfig=r.validateRetryThrottling=void 0;let i=e.r(46786),n=e.r(7782),s=e.r(29068),a=/^\d+(\.\d{1,9})?s$/,o="node";function l(e){if("service"in e&&""!==e.service){if("string"!=typeof e.service)throw Error(`Invalid method config name: invalid service: expected type string, got ${typeof e.service}`);if(!("method"in e)||""===e.method)return{service:e.service};if("string"!=typeof e.method)throw Error(`Invalid method config name: invalid method: expected type string, got ${typeof e.service}`);return{service:e.service,method:e.method}}if("method"in e&&void 0!==e.method)throw Error("Invalid method config name: method set with empty or unset service");return{}}function c(e){if(!("maxAttempts"in e)||!Number.isInteger(e.maxAttempts)||e.maxAttempts<2)throw Error("Invalid method config retry policy: maxAttempts must be an integer at least 2");if(!("initialBackoff"in e)||"string"!=typeof e.initialBackoff||!a.test(e.initialBackoff))throw Error("Invalid method config retry policy: initialBackoff must be a string consisting of a positive integer followed by s");if(!("maxBackoff"in e)||"string"!=typeof e.maxBackoff||!a.test(e.maxBackoff))throw Error("Invalid method config retry policy: maxBackoff must be a string consisting of a positive integer followed by s");if(!("backoffMultiplier"in e)||"number"!=typeof e.backoffMultiplier||e.backoffMultiplier<=0)throw Error("Invalid method config retry policy: backoffMultiplier must be a number greater than 0");if(!("retryableStatusCodes"in e&&Array.isArray(e.retryableStatusCodes)))throw Error("Invalid method config retry policy: retryableStatusCodes is required");if(0===e.retryableStatusCodes.length)throw Error("Invalid method config retry policy: retryableStatusCodes must be non-empty");for(let t of e.retryableStatusCodes)if("number"==typeof t){if(!Object.values(n.Status).includes(t))throw Error("Invalid method config retry policy: retryableStatusCodes value not in status code range")}else if("string"==typeof t){if(!Object.values(n.Status).includes(t.toUpperCase()))throw Error("Invalid method config retry policy: retryableStatusCodes value not a status code name")}else throw Error("Invalid method config retry policy: retryableStatusCodes value must be a string or number");return{maxAttempts:e.maxAttempts,initialBackoff:e.initialBackoff,maxBackoff:e.maxBackoff,backoffMultiplier:e.backoffMultiplier,retryableStatusCodes:e.retryableStatusCodes}}function u(e){if(!("maxAttempts"in e)||!Number.isInteger(e.maxAttempts)||e.maxAttempts<2)throw Error("Invalid method config hedging policy: maxAttempts must be an integer at least 2");if("hedgingDelay"in e&&("string"!=typeof e.hedgingDelay||!a.test(e.hedgingDelay)))throw Error("Invalid method config hedging policy: hedgingDelay must be a string consisting of a positive integer followed by s");if("nonFatalStatusCodes"in e&&Array.isArray(e.nonFatalStatusCodes))for(let t of e.nonFatalStatusCodes)if("number"==typeof t){if(!Object.values(n.Status).includes(t))throw Error("Invlid method config hedging policy: nonFatalStatusCodes value not in status code range")}else if("string"==typeof t){if(!Object.values(n.Status).includes(t.toUpperCase()))throw Error("Invlid method config hedging policy: nonFatalStatusCodes value not a status code name")}else throw Error("Invlid method config hedging policy: nonFatalStatusCodes value must be a string or number");let t={maxAttempts:e.maxAttempts};return e.hedgingDelay&&(t.hedgingDelay=e.hedgingDelay),e.nonFatalStatusCodes&&(t.nonFatalStatusCodes=e.nonFatalStatusCodes),t}function h(e){var t;let r={name:[]};if(!("name"in e)||!Array.isArray(e.name))throw Error("Invalid method config: invalid name array");for(let t of e.name)r.name.push(l(t));if("waitForReady"in e){if("boolean"!=typeof e.waitForReady)throw Error("Invalid method config: invalid waitForReady");r.waitForReady=e.waitForReady}if("timeout"in e)if("object"==typeof e.timeout){if(!("seconds"in e.timeout)||"number"!=typeof e.timeout.seconds)throw Error("Invalid method config: invalid timeout.seconds");if(!("nanos"in e.timeout)||"number"!=typeof e.timeout.nanos)throw Error("Invalid method config: invalid timeout.nanos");r.timeout=e.timeout}else if("string"==typeof e.timeout&&a.test(e.timeout)){let i=e.timeout.substring(0,e.timeout.length-1).split(".");r.timeout={seconds:0|i[0],nanos:(null!=(t=i[1])?t:0)|0}}else throw Error("Invalid method config: invalid timeout");if("maxRequestBytes"in e){if("number"!=typeof e.maxRequestBytes)throw Error("Invalid method config: invalid maxRequestBytes");r.maxRequestBytes=e.maxRequestBytes}if("maxResponseBytes"in e){if("number"!=typeof e.maxResponseBytes)throw Error("Invalid method config: invalid maxRequestBytes");r.maxResponseBytes=e.maxResponseBytes}if("retryPolicy"in e)if("hedgingPolicy"in e)throw Error("Invalid method config: retryPolicy and hedgingPolicy cannot both be specified");else r.retryPolicy=c(e.retryPolicy);else"hedgingPolicy"in e&&(r.hedgingPolicy=u(e.hedgingPolicy));return r}function d(e){if(!("maxTokens"in e)||"number"!=typeof e.maxTokens||e.maxTokens<=0||e.maxTokens>1e3)throw Error("Invalid retryThrottling: maxTokens must be a number in (0, 1000]");if(!("tokenRatio"in e)||"number"!=typeof e.tokenRatio||e.tokenRatio<=0)throw Error("Invalid retryThrottling: tokenRatio must be a number greater than 0");return{maxTokens:+e.maxTokens.toFixed(3),tokenRatio:+e.tokenRatio.toFixed(3)}}function f(e){let t={loadBalancingConfig:[],methodConfig:[]};if("loadBalancingPolicy"in e)if("string"==typeof e.loadBalancingPolicy)t.loadBalancingPolicy=e.loadBalancingPolicy;else throw Error("Invalid service config: invalid loadBalancingPolicy");if("loadBalancingConfig"in e)if(Array.isArray(e.loadBalancingConfig))for(let r of e.loadBalancingConfig)t.loadBalancingConfig.push((0,s.validateLoadBalancingConfig)(r));else throw Error("Invalid service config: invalid loadBalancingConfig");if("methodConfig"in e&&Array.isArray(e.methodConfig))for(let r of e.methodConfig)t.methodConfig.push(h(r));"retryThrottling"in e&&(t.retryThrottling=d(e.retryThrottling));let r=[];for(let e of t.methodConfig)for(let t of e.name){for(let e of r)if(t.service===e.service&&t.method===e.method)throw Error(`Invalid service config: duplicate name ${t.service}/${t.method}`);r.push(t)}return t}function p(e){if(!("serviceConfig"in e))throw Error("Invalid service config choice: missing service config");let t={serviceConfig:f(e.serviceConfig)};if("clientLanguage"in e)if(Array.isArray(e.clientLanguage))for(let r of(t.clientLanguage=[],e.clientLanguage))if("string"==typeof r)t.clientLanguage.push(r);else throw Error("Invalid service config choice: invalid clientLanguage");else throw Error("Invalid service config choice: invalid clientLanguage");if("clientHostname"in e)if(Array.isArray(e.clientHostname))for(let r of(t.clientHostname=[],e.clientHostname))if("string"==typeof r)t.clientHostname.push(r);else throw Error("Invalid service config choice: invalid clientHostname");else throw Error("Invalid service config choice: invalid clientHostname");if("percentage"in e)if("number"==typeof e.percentage&&0<=e.percentage&&e.percentage<=100)t.percentage=e.percentage;else throw Error("Invalid service config choice: invalid percentage");let r=["clientLanguage","percentage","clientHostname","serviceConfig"];for(let t in e)if(!r.includes(t))throw Error(`Invalid service config choice: unexpected field ${t}`);return t}function m(e,t){if(!Array.isArray(e))throw Error("Invalid service config list");for(let r of e){let e=p(r);if("number"!=typeof e.percentage||!(t>e.percentage)){if(Array.isArray(e.clientHostname)){let t=!1;for(let r of e.clientHostname)r===i.hostname()&&(t=!0);if(!t)continue}if(Array.isArray(e.clientLanguage)){let t=!1;for(let r of e.clientLanguage)r===o&&(t=!0);if(!t)continue}return e.serviceConfig}}throw Error("No matching service config found")}r.validateRetryThrottling=d,r.validateServiceConfig=f,r.extractAndSelectServiceConfig=function(e,t){for(let r of e)if(r.length>0&&r[0].startsWith("grpc_config="))return m(JSON.parse(r.join("").substring(12)),t);return null}},35967,(e,t,r)=>{"use strict";var i;Object.defineProperty(r,"__esModule",{value:!0}),r.ConnectivityState=void 0,function(e){e[e.IDLE=0]="IDLE",e[e.CONNECTING=1]="CONNECTING",e[e.READY=2]="READY",e[e.TRANSIENT_FAILURE=3]="TRANSIENT_FAILURE",e[e.SHUTDOWN=4]="SHUTDOWN"}(i||(r.ConnectivityState=i={}))},177,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.uriToString=r.splitHostPort=r.parseUri=void 0;let i=/^(?:([A-Za-z0-9+.-]+):)?(?:\/\/([^/]*)\/)?(.+)$/;r.parseUri=function(e){let t=i.exec(e);return null===t?null:{scheme:t[1],authority:t[2],path:t[3]}};let n=/^\d+$/;r.splitHostPort=function(e){if(e.startsWith("[")){let t=e.indexOf("]");if(-1===t)return null;let r=e.substring(1,t);if(-1===r.indexOf(":"))return null;if(!(e.length>t+1))return{host:r};if(":"!==e[t+1])return null;{let i=e.substring(t+2);return n.test(i)?{host:r,port:+i}:null}}{let t=e.split(":");return 2!==t.length?{host:e}:n.test(t[1])?{host:t[0],port:+t[1]}:null}},r.uriToString=function(e){let t="";return void 0!==e.scheme&&(t+=e.scheme+":"),void 0!==e.authority&&(t+="//"+e.authority+"/"),t+=e.path}},54718,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.mapUriDefaultScheme=r.getDefaultAuthority=r.createResolver=r.registerDefaultScheme=r.registerResolver=void 0;let i=e.r(177),n={},s=null;r.registerResolver=function(e,t){n[e]=t},r.registerDefaultScheme=function(e){s=e},r.createResolver=function(e,t,r){if(void 0!==e.scheme&&e.scheme in n)return new n[e.scheme](e,t,r);throw Error(`No resolver could be created for target ${(0,i.uriToString)(e)}`)},r.getDefaultAuthority=function(e){if(void 0!==e.scheme&&e.scheme in n)return n[e.scheme].getDefaultAuthority(e);throw Error(`Invalid target ${(0,i.uriToString)(e)}`)},r.mapUriDefaultScheme=function(e){if(void 0===e.scheme||!(e.scheme in n))if(null!==s)return{scheme:s,authority:void 0,path:(0,i.uriToString)(e)};else return null;return e}},32199,(e,t,r)=>{"use strict";var i;Object.defineProperty(r,"__esModule",{value:!0}),r.QueuePicker=r.UnavailablePicker=r.PickResultType=void 0;let n=e.r(10409),s=e.r(7782);!function(e){e[e.COMPLETE=0]="COMPLETE",e[e.QUEUE=1]="QUEUE",e[e.TRANSIENT_FAILURE=2]="TRANSIENT_FAILURE",e[e.DROP=3]="DROP"}(i||(r.PickResultType=i={}));class a{constructor(e){this.status=Object.assign({code:s.Status.UNAVAILABLE,details:"No connection established",metadata:new n.Metadata},e)}pick(e){return{pickResultType:i.TRANSIENT_FAILURE,subchannel:null,status:this.status,onCallStarted:null,onCallEnded:null}}}r.UnavailablePicker=a;class o{constructor(e){this.loadBalancer=e,this.calledExitIdle=!1}pick(e){return this.calledExitIdle||(process.nextTick(()=>{this.loadBalancer.exitIdle()}),this.calledExitIdle=!0),{pickResultType:i.QUEUE,subchannel:null,status:null,onCallStarted:null,onCallEnded:null}}}r.QueuePicker=o},29319,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.BackoffTimeout=void 0;let i=1e3,n=1.6,s=12e4,a=.2;function o(e,t){return Math.random()*(t-e)+e}class l{constructor(e,t){this.callback=e,this.initialDelay=i,this.multiplier=n,this.maxDelay=s,this.jitter=a,this.running=!1,this.hasRef=!0,this.startTime=new Date,this.endTime=new Date,t&&(t.initialDelay&&(this.initialDelay=t.initialDelay),t.multiplier&&(this.multiplier=t.multiplier),t.jitter&&(this.jitter=t.jitter),t.maxDelay&&(this.maxDelay=t.maxDelay)),this.nextDelay=this.initialDelay,this.timerId=setTimeout(()=>{},0),clearTimeout(this.timerId)}runTimer(e){var t,r;this.endTime=this.startTime,this.endTime.setMilliseconds(this.endTime.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),this.timerId=setTimeout(()=>{this.callback(),this.running=!1},e),this.hasRef||null==(r=(t=this.timerId).unref)||r.call(t)}runOnce(){this.running=!0,this.startTime=new Date,this.runTimer(this.nextDelay);let e=Math.min(this.nextDelay*this.multiplier,this.maxDelay),t=e*this.jitter;this.nextDelay=e+o(-t,t)}stop(){clearTimeout(this.timerId),this.running=!1}reset(){if(this.nextDelay=this.initialDelay,this.running){let e=new Date,t=this.startTime;t.setMilliseconds(t.getMilliseconds()+this.nextDelay),clearTimeout(this.timerId),e<t?this.runTimer(t.getTime()-e.getTime()):this.running=!1}}isRunning(){return this.running}ref(){var e,t;this.hasRef=!0,null==(t=(e=this.timerId).ref)||t.call(e)}unref(){var e,t;this.hasRef=!1,null==(t=(e=this.timerId).unref)||t.call(e)}getEndTime(){return this.endTime}}r.BackoffTimeout=l},52387,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ChildLoadBalancerHandler=void 0;let i=e.r(29068),n=e.r(35967),s="child_load_balancer_helper";class a{constructor(e){this.channelControlHelper=e,this.currentChild=null,this.pendingChild=null,this.latestConfig=null,this.ChildPolicyHelper=class{constructor(e){this.parent=e,this.child=null}createSubchannel(e,t){return this.parent.channelControlHelper.createSubchannel(e,t)}updateState(e,t){var r;if(this.calledByPendingChild()){if(e===n.ConnectivityState.CONNECTING)return;null==(r=this.parent.currentChild)||r.destroy(),this.parent.currentChild=this.parent.pendingChild,this.parent.pendingChild=null}else if(!this.calledByCurrentChild())return;this.parent.channelControlHelper.updateState(e,t)}requestReresolution(){var e;let t=null!=(e=this.parent.pendingChild)?e:this.parent.currentChild;this.child===t&&this.parent.channelControlHelper.requestReresolution()}setChild(e){this.child=e}addChannelzChild(e){this.parent.channelControlHelper.addChannelzChild(e)}removeChannelzChild(e){this.parent.channelControlHelper.removeChannelzChild(e)}calledByPendingChild(){return this.child===this.parent.pendingChild}calledByCurrentChild(){return this.child===this.parent.currentChild}}}configUpdateRequiresNewPolicyInstance(e,t){return e.getLoadBalancerName()!==t.getLoadBalancerName()}updateAddressList(e,t,r){let n;if(null===this.currentChild||null===this.latestConfig||this.configUpdateRequiresNewPolicyInstance(this.latestConfig,t)){let e=new this.ChildPolicyHelper(this),r=(0,i.createLoadBalancer)(t,e);e.setChild(r),null===this.currentChild?(this.currentChild=r,n=this.currentChild):(this.pendingChild&&this.pendingChild.destroy(),this.pendingChild=r,n=this.pendingChild)}else n=null===this.pendingChild?this.currentChild:this.pendingChild;this.latestConfig=t,n.updateAddressList(e,t,r)}exitIdle(){this.currentChild&&(this.currentChild.exitIdle(),this.pendingChild&&this.pendingChild.exitIdle())}resetBackoff(){this.currentChild&&(this.currentChild.resetBackoff(),this.pendingChild&&this.pendingChild.resetBackoff())}destroy(){this.currentChild&&(this.currentChild.destroy(),this.currentChild=null),this.pendingChild&&(this.pendingChild.destroy(),this.pendingChild=null)}getTypeName(){return s}}r.ChildLoadBalancerHandler=a},67668,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ResolvingLoadBalancer=void 0;let i=e.r(29068),n=e.r(63361),s=e.r(35967),a=e.r(54718),o=e.r(32199),l=e.r(29319),c=e.r(7782),u=e.r(10409),h=e.r(33137),d=e.r(7782),f=e.r(177),p=e.r(52387),m="resolving_load_balancer";function g(e){h.trace(d.LogVerbosity.DEBUG,m,e)}let y=["SERVICE_AND_METHOD","SERVICE","EMPTY"];function v(e,t,r,i){for(let n of r.name)switch(i){case"EMPTY":if(!n.service&&!n.method)return!0;break;case"SERVICE":if(n.service===e&&!n.method)return!0;break;case"SERVICE_AND_METHOD":if(n.service===e&&n.method===t)return!0}return!1}function b(e,t,r,i){for(let n of r)if(v(e,t,n,i))return n;return null}function S(e){return function(t,r){var i,n;let s=t.split("/").filter(e=>e.length>0),a=null!=(i=s[0])?i:"",o=null!=(n=s[1])?n:"";if(e&&e.methodConfig)for(let t of y){let r=b(a,o,e.methodConfig,t);if(r)return{methodConfig:r,pickInformation:{},status:c.Status.OK,dynamicFilterFactories:[]}}return{methodConfig:{name:[]},pickInformation:{},status:c.Status.OK,dynamicFilterFactories:[]}}}class C{constructor(e,t,r,h,d){this.target=e,this.channelControlHelper=t,this.onSuccessfulResolution=h,this.onFailedResolution=d,this.latestChildState=s.ConnectivityState.IDLE,this.latestChildPicker=new o.QueuePicker(this),this.currentState=s.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1,r["grpc.service_config"]?this.defaultServiceConfig=(0,n.validateServiceConfig)(JSON.parse(r["grpc.service_config"])):this.defaultServiceConfig={loadBalancingConfig:[],methodConfig:[]},this.updateState(s.ConnectivityState.IDLE,new o.QueuePicker(this)),this.childLoadBalancer=new p.ChildLoadBalancerHandler({createSubchannel:t.createSubchannel.bind(t),requestReresolution:()=>{this.backoffTimeout.isRunning()?(g("requestReresolution delayed by backoff timer until "+this.backoffTimeout.getEndTime().toISOString()),this.continueResolving=!0):this.updateResolution()},updateState:(e,t)=>{this.latestChildState=e,this.latestChildPicker=t,this.updateState(e,t)},addChannelzChild:t.addChannelzChild.bind(t),removeChannelzChild:t.removeChannelzChild.bind(t)}),this.innerResolver=(0,a.createResolver)(e,{onSuccessfulResolution:(e,t,r,n,s)=>{var a;this.backoffTimeout.stop(),this.backoffTimeout.reset();let o=null;null===t?null===r?(this.previousServiceConfig=null,o=this.defaultServiceConfig):null===this.previousServiceConfig?this.handleResolutionFailure(r):o=this.previousServiceConfig:(o=t,this.previousServiceConfig=t);let l=null!=(a=null==o?void 0:o.loadBalancingConfig)?a:[],h=(0,i.getFirstUsableConfig)(l,!0);if(null===h)return void this.handleResolutionFailure({code:c.Status.UNAVAILABLE,details:"All load balancer options in service config are not compatible",metadata:new u.Metadata});this.childLoadBalancer.updateAddressList(e,h,s);let d=null!=o?o:this.defaultServiceConfig;this.onSuccessfulResolution(d,null!=n?n:S(d))},onError:e=>{this.handleResolutionFailure(e)}},r);const f={initialDelay:r["grpc.initial_reconnect_backoff_ms"],maxDelay:r["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new l.BackoffTimeout(()=>{this.continueResolving?(this.updateResolution(),this.continueResolving=!1):this.updateState(this.latestChildState,this.latestChildPicker)},f),this.backoffTimeout.unref()}updateResolution(){this.innerResolver.updateResolution(),this.currentState===s.ConnectivityState.IDLE&&this.updateState(s.ConnectivityState.CONNECTING,new o.QueuePicker(this)),this.backoffTimeout.runOnce()}updateState(e,t){g((0,f.uriToString)(this.target)+" "+s.ConnectivityState[this.currentState]+" -> "+s.ConnectivityState[e]),e===s.ConnectivityState.IDLE&&(t=new o.QueuePicker(this)),this.currentState=e,this.channelControlHelper.updateState(e,t)}handleResolutionFailure(e){this.latestChildState===s.ConnectivityState.IDLE&&(this.updateState(s.ConnectivityState.TRANSIENT_FAILURE,new o.UnavailablePicker(e)),this.onFailedResolution(e))}exitIdle(){(this.currentState===s.ConnectivityState.IDLE||this.currentState===s.ConnectivityState.TRANSIENT_FAILURE)&&(this.backoffTimeout.isRunning()?this.continueResolving=!0:this.updateResolution()),this.childLoadBalancer.exitIdle()}updateAddressList(e,t){throw Error("updateAddressList not supported on ResolvingLoadBalancer")}resetBackoff(){this.backoffTimeout.reset(),this.childLoadBalancer.resetBackoff()}destroy(){this.childLoadBalancer.destroy(),this.innerResolver.destroy(),this.backoffTimeout.reset(),this.backoffTimeout.stop(),this.latestChildState=s.ConnectivityState.IDLE,this.latestChildPicker=new o.QueuePicker(this),this.currentState=s.ConnectivityState.IDLE,this.previousServiceConfig=null,this.continueResolving=!1}getTypeName(){return"resolving_load_balancer"}}r.ResolvingLoadBalancer=C},65101,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.channelOptionsEqual=r.recognizedOptions=void 0,r.recognizedOptions={"grpc.ssl_target_name_override":!0,"grpc.primary_user_agent":!0,"grpc.secondary_user_agent":!0,"grpc.default_authority":!0,"grpc.keepalive_time_ms":!0,"grpc.keepalive_timeout_ms":!0,"grpc.keepalive_permit_without_calls":!0,"grpc.service_config":!0,"grpc.max_concurrent_streams":!0,"grpc.initial_reconnect_backoff_ms":!0,"grpc.max_reconnect_backoff_ms":!0,"grpc.use_local_subchannel_pool":!0,"grpc.max_send_message_length":!0,"grpc.max_receive_message_length":!0,"grpc.enable_http_proxy":!0,"grpc.enable_channelz":!0,"grpc.dns_min_time_between_resolutions_ms":!0,"grpc.enable_retries":!0,"grpc.per_rpc_retry_buffer_size":!0,"grpc.retry_buffer_size":!0,"grpc.max_connection_age_ms":!0,"grpc.max_connection_age_grace_ms":!0,"grpc-node.max_session_memory":!0,"grpc.service_config_disable_resolution":!0,"grpc.client_idle_timeout_ms":!0,"grpc-node.tls_enable_trace":!0},r.channelOptionsEqual=function(e,t){let r=Object.keys(e).sort(),i=Object.keys(t).sort();if(r.length!==i.length)return!1;for(let n=0;n<r.length;n+=1)if(r[n]!==i[n]||e[r[n]]!==t[i[n]])return!1;return!0}},76054,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.stringToSubchannelAddress=r.subchannelAddressToString=r.subchannelAddressEqual=r.isTcpSubchannelAddress=void 0;let i=e.r(4446);function n(e){return"port"in e}r.isTcpSubchannelAddress=n,r.subchannelAddressEqual=function(e,t){return!e&&!t||!!e&&!!t&&(n(e)?n(t)&&e.host===t.host&&e.port===t.port:!n(t)&&e.path===t.path)},r.subchannelAddressToString=function(e){return n(e)?e.host+":"+e.port:e.path};let s=443;r.stringToSubchannelAddress=function(e,t){return(0,i.isIP)(e)?{host:e,port:null!=t?t:s}:{path:e}}},15831,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.addAdminServicesToServer=r.registerAdminService=void 0;let i=[];r.registerAdminService=function(e,t){i.push({getServiceDefinition:e,getHandlers:t})},r.addAdminServicesToServer=function(e){for(let{getServiceDefinition:t,getHandlers:r}of i)e.addService(t(),r())}},47045,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ClientDuplexStreamImpl=r.ClientWritableStreamImpl=r.ClientReadableStreamImpl=r.ClientUnaryCallImpl=r.callErrorFromStatus=void 0;let i=e.r(27699),n=e.r(88947),s=e.r(7782);r.callErrorFromStatus=function(e,t){let r=`${e.code} ${s.Status[e.code]}: ${e.details}`,i=Error(r),n=`${i.stack}
for call at
${t}`;return Object.assign(Error(r),e,{stack:n})};class a extends i.EventEmitter{constructor(){super()}cancel(){var e;null==(e=this.call)||e.cancelWithStatus(s.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return null!=(t=null==(e=this.call)?void 0:e.getPeer())?t:"unknown"}}r.ClientUnaryCallImpl=a;class o extends n.Readable{constructor(e){super({objectMode:!0}),this.deserialize=e}cancel(){var e;null==(e=this.call)||e.cancelWithStatus(s.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return null!=(t=null==(e=this.call)?void 0:e.getPeer())?t:"unknown"}_read(e){var t;null==(t=this.call)||t.startRead()}}r.ClientReadableStreamImpl=o;class l extends n.Writable{constructor(e){super({objectMode:!0}),this.serialize=e}cancel(){var e;null==(e=this.call)||e.cancelWithStatus(s.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return null!=(t=null==(e=this.call)?void 0:e.getPeer())?t:"unknown"}_write(e,t,r){var i;let n={callback:r},s=Number(t);Number.isNaN(s)||(n.flags=s),null==(i=this.call)||i.sendMessageWithContext(n,e)}_final(e){var t;null==(t=this.call)||t.halfClose(),e()}}r.ClientWritableStreamImpl=l;class c extends n.Duplex{constructor(e,t){super({objectMode:!0}),this.serialize=e,this.deserialize=t}cancel(){var e;null==(e=this.call)||e.cancelWithStatus(s.Status.CANCELLED,"Cancelled on client")}getPeer(){var e,t;return null!=(t=null==(e=this.call)?void 0:e.getPeer())?t:"unknown"}_read(e){var t;null==(t=this.call)||t.startRead()}_write(e,t,r){var i;let n={callback:r},s=Number(t);Number.isNaN(s)||(n.flags=s),null==(i=this.call)||i.sendMessageWithContext(n,e)}_final(e){var t;null==(t=this.call)||t.halfClose(),e()}}r.ClientDuplexStreamImpl=c},608,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.InterceptingListenerImpl=r.isInterceptingListener=void 0,r.isInterceptingListener=function(e){return void 0!==e.onReceiveMetadata&&1===e.onReceiveMetadata.length};class i{constructor(e,t){this.listener=e,this.nextListener=t,this.processingMetadata=!1,this.hasPendingMessage=!1,this.processingMessage=!1,this.pendingStatus=null}processPendingMessage(){this.hasPendingMessage&&(this.nextListener.onReceiveMessage(this.pendingMessage),this.pendingMessage=null,this.hasPendingMessage=!1)}processPendingStatus(){this.pendingStatus&&this.nextListener.onReceiveStatus(this.pendingStatus)}onReceiveMetadata(e){this.processingMetadata=!0,this.listener.onReceiveMetadata(e,e=>{this.processingMetadata=!1,this.nextListener.onReceiveMetadata(e),this.processPendingMessage(),this.processPendingStatus()})}onReceiveMessage(e){this.processingMessage=!0,this.listener.onReceiveMessage(e,e=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessage=e,this.hasPendingMessage=!0):(this.nextListener.onReceiveMessage(e),this.processPendingStatus())})}onReceiveStatus(e){this.listener.onReceiveStatus(e,e=>{this.processingMetadata||this.processingMessage?this.pendingStatus=e:this.nextListener.onReceiveStatus(e)})}}r.InterceptingListenerImpl=i},53692,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getInterceptingCall=r.InterceptingCall=r.RequesterBuilder=r.ListenerBuilder=r.InterceptorConfigurationError=void 0;let i=e.r(10409),n=e.r(608),s=e.r(7782),a=e.r(44162);class o extends Error{constructor(e){super(e),this.name="InterceptorConfigurationError",Error.captureStackTrace(this,o)}}r.InterceptorConfigurationError=o;class l{constructor(){this.metadata=void 0,this.message=void 0,this.status=void 0}withOnReceiveMetadata(e){return this.metadata=e,this}withOnReceiveMessage(e){return this.message=e,this}withOnReceiveStatus(e){return this.status=e,this}build(){return{onReceiveMetadata:this.metadata,onReceiveMessage:this.message,onReceiveStatus:this.status}}}r.ListenerBuilder=l;class c{constructor(){this.start=void 0,this.message=void 0,this.halfClose=void 0,this.cancel=void 0}withStart(e){return this.start=e,this}withSendMessage(e){return this.message=e,this}withHalfClose(e){return this.halfClose=e,this}withCancel(e){return this.cancel=e,this}build(){return{start:this.start,sendMessage:this.message,halfClose:this.halfClose,cancel:this.cancel}}}r.RequesterBuilder=c;let u=(e,t)=>{t(e)},h=(e,t)=>{t(e)},d=(e,t)=>{t(e)},f={start:(e,t,r)=>{r(e,t)},sendMessage:(e,t)=>{t(e)},halfClose:e=>{e()},cancel:e=>{e()}};class p{constructor(e,t){var r,i,n,s;this.nextCall=e,this.processingMetadata=!1,this.pendingMessageContext=null,this.processingMessage=!1,this.pendingHalfClose=!1,t?this.requester={start:null!=(r=t.start)?r:f.start,sendMessage:null!=(i=t.sendMessage)?i:f.sendMessage,halfClose:null!=(n=t.halfClose)?n:f.halfClose,cancel:null!=(s=t.cancel)?s:f.cancel}:this.requester=f}cancelWithStatus(e,t){this.requester.cancel(()=>{this.nextCall.cancelWithStatus(e,t)})}getPeer(){return this.nextCall.getPeer()}processPendingMessage(){this.pendingMessageContext&&(this.nextCall.sendMessageWithContext(this.pendingMessageContext,this.pendingMessage),this.pendingMessageContext=null,this.pendingMessage=null)}processPendingHalfClose(){this.pendingHalfClose&&this.nextCall.halfClose()}start(e,t){var r,i,s,a,o,l;let c={onReceiveMetadata:null!=(i=null==(r=null==t?void 0:t.onReceiveMetadata)?void 0:r.bind(t))?i:e=>{},onReceiveMessage:null!=(a=null==(s=null==t?void 0:t.onReceiveMessage)?void 0:s.bind(t))?a:e=>{},onReceiveStatus:null!=(l=null==(o=null==t?void 0:t.onReceiveStatus)?void 0:o.bind(t))?l:e=>{}};this.processingMetadata=!0,this.requester.start(e,c,(e,t)=>{var r,i,s;let a;if(this.processingMetadata=!1,(0,n.isInterceptingListener)(t))a=t;else{let e={onReceiveMetadata:null!=(r=t.onReceiveMetadata)?r:u,onReceiveMessage:null!=(i=t.onReceiveMessage)?i:h,onReceiveStatus:null!=(s=t.onReceiveStatus)?s:d};a=new n.InterceptingListenerImpl(e,c)}this.nextCall.start(e,a),this.processPendingMessage(),this.processPendingHalfClose()})}sendMessageWithContext(e,t){this.processingMessage=!0,this.requester.sendMessage(t,r=>{this.processingMessage=!1,this.processingMetadata?(this.pendingMessageContext=e,this.pendingMessage=t):(this.nextCall.sendMessageWithContext(e,r),this.processPendingHalfClose())})}sendMessage(e){this.sendMessageWithContext({},e)}startRead(){this.nextCall.startRead()}halfClose(){this.requester.halfClose(()=>{this.processingMetadata||this.processingMessage?this.pendingHalfClose=!0:this.nextCall.halfClose()})}}function m(e,t,r){var i,n;let s=null!=(i=r.deadline)?i:1/0,a=r.host,o=null!=(n=r.parent)?n:null,l=r.propagate_flags,c=r.credentials,u=e.createCall(t,s,a,o,l);return c&&u.setCredentials(c),u}r.InterceptingCall=p;class g{constructor(e,t){this.call=e,this.methodDefinition=t}cancelWithStatus(e,t){this.call.cancelWithStatus(e,t)}getPeer(){return this.call.getPeer()}sendMessageWithContext(e,t){let r;try{r=this.methodDefinition.requestSerialize(t)}catch(e){this.call.cancelWithStatus(s.Status.INTERNAL,`Request message serialization failure: ${(0,a.getErrorMessage)(e)}`);return}this.call.sendMessageWithContext(e,r)}sendMessage(e){this.sendMessageWithContext({},e)}start(e,t){let r=null;this.call.start(e,{onReceiveMetadata:e=>{var r;null==(r=null==t?void 0:t.onReceiveMetadata)||r.call(t,e)},onReceiveMessage:e=>{var n;let o;try{o=this.methodDefinition.responseDeserialize(e)}catch(e){r={code:s.Status.INTERNAL,details:`Response message parsing error: ${(0,a.getErrorMessage)(e)}`,metadata:new i.Metadata},this.call.cancelWithStatus(r.code,r.details);return}null==(n=null==t?void 0:t.onReceiveMessage)||n.call(t,o)},onReceiveStatus:e=>{var i,n;r?null==(i=null==t?void 0:t.onReceiveStatus)||i.call(t,r):null==(n=null==t?void 0:t.onReceiveStatus)||n.call(t,e)}})}startRead(){this.call.startRead()}halfClose(){this.call.halfClose()}}class y extends g{constructor(e,t){super(e,t)}start(e,t){var r,i;let n=!1,s={onReceiveMetadata:null!=(i=null==(r=null==t?void 0:t.onReceiveMetadata)?void 0:r.bind(t))?i:e=>{},onReceiveMessage:e=>{var r;n=!0,null==(r=null==t?void 0:t.onReceiveMessage)||r.call(t,e)},onReceiveStatus:e=>{var r,i;n||null==(r=null==t?void 0:t.onReceiveMessage)||r.call(t,null),null==(i=null==t?void 0:t.onReceiveStatus)||i.call(t,e)}};super.start(e,s),this.call.startRead()}}class v extends g{}function b(e,t,r){let i=m(e,r.path,t);return r.responseStream?new v(i,r):new y(i,r)}r.getInterceptingCall=function(e,t,r,i){if(e.clientInterceptors.length>0&&e.clientInterceptorProviders.length>0)throw new o("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(e.callInterceptors.length>0&&e.callInterceptorProviders.length>0)throw new o("Both interceptors and interceptor_providers were passed as call options. Only one of these is allowed.");let n=[];n=e.callInterceptors.length>0||e.callInterceptorProviders.length>0?[].concat(e.callInterceptors,e.callInterceptorProviders.map(e=>e(t))).filter(e=>e):[].concat(e.clientInterceptors,e.clientInterceptorProviders.map(e=>e(t))).filter(e=>e);let s=Object.assign({},r,{method_definition:t});return n.reduceRight((e,t)=>r=>t(r,e),e=>b(i,e,t))(s)}},88028,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Client=void 0;let i=e.r(47045),n=e.r(12786),s=e.r(35967),a=e.r(7782),o=e.r(10409),l=e.r(53692),c=Symbol(),u=Symbol(),h=Symbol(),d=Symbol();function f(e){return"function"==typeof e}function p(e){return e.stack.split("\n").slice(1).join("\n")}class m{constructor(e,t,r={}){var i,s;if(r=Object.assign({},r),this[u]=null!=(i=r.interceptors)?i:[],delete r.interceptors,this[h]=null!=(s=r.interceptor_providers)?s:[],delete r.interceptor_providers,this[u].length>0&&this[h].length>0)throw Error("Both interceptors and interceptor_providers were passed as options to the client constructor. Only one of these is allowed.");if(this[d]=r.callInvocationTransformer,delete r.callInvocationTransformer,r.channelOverride)this[c]=r.channelOverride;else if(r.channelFactoryOverride){const i=r.channelFactoryOverride;delete r.channelFactoryOverride,this[c]=i(e,t,r)}else this[c]=new n.ChannelImplementation(e,t,r)}close(){this[c].close()}getChannel(){return this[c]}waitForReady(e,t){let r=i=>{let n;if(i)return void t(Error("Failed to connect before the deadline"));try{n=this[c].getConnectivityState(!0)}catch(e){t(Error("The channel has been closed"));return}if(n===s.ConnectivityState.READY)t();else try{this[c].watchConnectivityState(n,e,r)}catch(e){t(Error("The channel has been closed"))}};setImmediate(r)}checkOptionalUnaryResponseArguments(e,t,r){if(f(e))return{metadata:new o.Metadata,options:{},callback:e};if(f(t))if(e instanceof o.Metadata)return{metadata:e,options:{},callback:t};else return{metadata:new o.Metadata,options:e,callback:t};if(!(e instanceof o.Metadata&&t instanceof Object&&f(r)))throw Error("Incorrect arguments passed");return{metadata:e,options:t,callback:r}}makeUnaryRequest(e,t,r,n,s,o,f){var m,g;let y=this.checkOptionalUnaryResponseArguments(s,o,f),v={path:e,requestStream:!1,responseStream:!1,requestSerialize:t,responseDeserialize:r},b={argument:n,metadata:y.metadata,call:new i.ClientUnaryCallImpl,channel:this[c],methodDefinition:v,callOptions:y.options,callback:y.callback};this[d]&&(b=this[d](b));let S=b.call,C={clientInterceptors:this[u],clientInterceptorProviders:this[h],callInterceptors:null!=(m=b.callOptions.interceptors)?m:[],callInterceptorProviders:null!=(g=b.callOptions.interceptor_providers)?g:[]},T=(0,l.getInterceptingCall)(C,b.methodDefinition,b.callOptions,b.channel);S.call=T;let E=null,_=!1,w=Error();return T.start(b.metadata,{onReceiveMetadata:e=>{S.emit("metadata",e)},onReceiveMessage(e){null!==E&&T.cancelWithStatus(a.Status.INTERNAL,"Too many responses received"),E=e},onReceiveStatus(e){if(!_){if(_=!0,e.code===a.Status.OK)if(null===E){let t=p(w);b.callback((0,i.callErrorFromStatus)({code:a.Status.INTERNAL,details:"No message received",metadata:e.metadata},t))}else b.callback(null,E);else{let t=p(w);b.callback((0,i.callErrorFromStatus)(e,t))}w=null,S.emit("status",e)}}}),T.sendMessage(n),T.halfClose(),S}makeClientStreamRequest(e,t,r,n,s,o){var f,m;let g=this.checkOptionalUnaryResponseArguments(n,s,o),y={path:e,requestStream:!0,responseStream:!1,requestSerialize:t,responseDeserialize:r},v={metadata:g.metadata,call:new i.ClientWritableStreamImpl(t),channel:this[c],methodDefinition:y,callOptions:g.options,callback:g.callback};this[d]&&(v=this[d](v));let b=v.call,S={clientInterceptors:this[u],clientInterceptorProviders:this[h],callInterceptors:null!=(f=v.callOptions.interceptors)?f:[],callInterceptorProviders:null!=(m=v.callOptions.interceptor_providers)?m:[]},C=(0,l.getInterceptingCall)(S,v.methodDefinition,v.callOptions,v.channel);b.call=C;let T=null,E=!1,_=Error();return C.start(v.metadata,{onReceiveMetadata:e=>{b.emit("metadata",e)},onReceiveMessage(e){null!==T&&C.cancelWithStatus(a.Status.INTERNAL,"Too many responses received"),T=e},onReceiveStatus(e){if(!E){if(E=!0,e.code===a.Status.OK)if(null===T){let t=p(_);v.callback((0,i.callErrorFromStatus)({code:a.Status.INTERNAL,details:"No message received",metadata:e.metadata},t))}else v.callback(null,T);else{let t=p(_);v.callback((0,i.callErrorFromStatus)(e,t))}_=null,b.emit("status",e)}}}),b}checkMetadataAndOptions(e,t){let r,i;return e instanceof o.Metadata?(r=e,i=t||{}):(i=e||{},r=new o.Metadata),{metadata:r,options:i}}makeServerStreamRequest(e,t,r,n,s,o){var f,m;let g=this.checkMetadataAndOptions(s,o),y={path:e,requestStream:!1,responseStream:!0,requestSerialize:t,responseDeserialize:r},v={argument:n,metadata:g.metadata,call:new i.ClientReadableStreamImpl(r),channel:this[c],methodDefinition:y,callOptions:g.options};this[d]&&(v=this[d](v));let b=v.call,S={clientInterceptors:this[u],clientInterceptorProviders:this[h],callInterceptors:null!=(f=v.callOptions.interceptors)?f:[],callInterceptorProviders:null!=(m=v.callOptions.interceptor_providers)?m:[]},C=(0,l.getInterceptingCall)(S,v.methodDefinition,v.callOptions,v.channel);b.call=C;let T=!1,E=Error();return C.start(v.metadata,{onReceiveMetadata(e){b.emit("metadata",e)},onReceiveMessage(e){b.push(e)},onReceiveStatus(e){if(!T){if(T=!0,b.push(null),e.code!==a.Status.OK){let t=p(E);b.emit("error",(0,i.callErrorFromStatus)(e,t))}E=null,b.emit("status",e)}}}),C.sendMessage(n),C.halfClose(),b}makeBidiStreamRequest(e,t,r,n,s){var o,f;let m=this.checkMetadataAndOptions(n,s),g={path:e,requestStream:!0,responseStream:!0,requestSerialize:t,responseDeserialize:r},y={metadata:m.metadata,call:new i.ClientDuplexStreamImpl(t,r),channel:this[c],methodDefinition:g,callOptions:m.options};this[d]&&(y=this[d](y));let v=y.call,b={clientInterceptors:this[u],clientInterceptorProviders:this[h],callInterceptors:null!=(o=y.callOptions.interceptors)?o:[],callInterceptorProviders:null!=(f=y.callOptions.interceptor_providers)?f:[]},S=(0,l.getInterceptingCall)(b,y.methodDefinition,y.callOptions,y.channel);v.call=S;let C=!1,T=Error();return S.start(y.metadata,{onReceiveMetadata(e){v.emit("metadata",e)},onReceiveMessage(e){v.push(e)},onReceiveStatus(e){if(!C){if(C=!0,v.push(null),e.code!==a.Status.OK){let t=p(T);v.emit("error",(0,i.callErrorFromStatus)(e,t))}T=null,v.emit("status",e)}}}),v}}r.Client=m},33859,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.loadPackageDefinition=r.makeClientConstructor=void 0;let i=e.r(88028),n={unary:i.Client.prototype.makeUnaryRequest,server_stream:i.Client.prototype.makeServerStreamRequest,client_stream:i.Client.prototype.makeClientStreamRequest,bidi:i.Client.prototype.makeBidiStreamRequest};function s(e){return["__proto__","prototype","constructor"].includes(e)}function a(e,t,r){r||(r={});class a extends i.Client{}return Object.keys(e).forEach(t=>{let r;if(s(t))return;let i=e[t];if("string"==typeof t&&"$"===t.charAt(0))throw Error("Method names cannot start with $");r=i.requestStream?i.responseStream?"bidi":"client_stream":i.responseStream?"server_stream":"unary";let l=i.requestSerialize,c=i.responseDeserialize,u=o(n[r],i.path,l,c);a.prototype[t]=u,Object.assign(a.prototype[t],i),i.originalName&&!s(i.originalName)&&(a.prototype[i.originalName]=a.prototype[t])}),a.service=e,a.serviceName=t,a}function o(e,t,r,i){return function(...n){return e.call(this,t,r,i,...n)}}function l(e){return"format"in e}r.makeClientConstructor=a,r.loadPackageDefinition=function(e){let t={};for(let r in e)if(Object.prototype.hasOwnProperty.call(e,r)){let i=e[r],n=r.split(".");if(n.some(e=>s(e)))continue;let o=n[n.length-1],c=t;for(let e of n.slice(0,-1))c[e]||(c[e]={}),c=c[e];l(i)?c[o]=i:c[o]=a(i,o,{})}return t}},26904,(e,t,r)=>{var i=1/0,n="[object Symbol]",s=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,a=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,o="\ud800-\udfff",l="\\u0300-\\u036f\\ufe20-\\ufe23",c="\\u20d0-\\u20f0",u="\\u2700-\\u27bf",h="a-z\\xdf-\\xf6\\xf8-\\xff",d="A-Z\\xc0-\\xd6\\xd8-\\xde",f="\\ufe0e\\ufe0f",p="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",m="['â€™]",g="["+o+"]",y="["+p+"]",v="["+l+c+"]",b="\\d+",S="["+u+"]",C="["+h+"]",T="[^"+o+p+b+u+h+d+"]",E="\ud83c[\udffb-\udfff]",_="[^"+o+"]",w="(?:\ud83c[\udde6-\uddff]){2}",R="[\ud800-\udbff][\udc00-\udfff]",k="["+d+"]",A="\\u200d",I="(?:"+C+"|"+T+")",O="(?:"+k+"|"+T+")",N="(?:"+m+"(?:d|ll|m|re|s|t|ve))?",x="(?:"+m+"(?:D|LL|M|RE|S|T|VE))?",D="(?:"+v+"|"+E+")?",P="["+f+"]?",M="(?:"+A+"(?:"+[_,w,R].join("|")+")"+P+D+")*",L=P+D+M,F="(?:"+[S,w,R].join("|")+")"+L,B="(?:"+[_+v+"?",v,w,R,g].join("|")+")",j=RegExp(m,"g"),U=RegExp(v,"g"),V=RegExp(E+"(?="+E+")|"+B+L,"g"),z=RegExp([k+"?"+C+"+"+N+"(?="+[y,k,"$"].join("|")+")",O+"+"+x+"(?="+[y,k+I,"$"].join("|")+")",k+"?"+I+"+"+N,k+"+"+x,b,F].join("|"),"g"),q=RegExp("["+A+o+l+c+f+"]"),$=/[a-z][A-Z]|[A-Z]{2,}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,H={Ã€:"A",Ã:"A",Ã‚:"A",Ãƒ:"A",Ã„:"A",Ã…:"A",Ã :"a",Ã¡:"a",Ã¢:"a",Ã£:"a",Ã¤:"a",Ã¥:"a",Ã‡:"C",Ã§:"c",Ã:"D",Ã°:"d",Ãˆ:"E",Ã‰:"E",ÃŠ:"E",Ã‹:"E",Ã¨:"e",Ã©:"e",Ãª:"e",Ã«:"e",ÃŒ:"I",Ã:"I",ÃŽ:"I",Ã:"I",Ã¬:"i",Ã­:"i",Ã®:"i",Ã¯:"i",Ã‘:"N",Ã±:"n",Ã’:"O",Ã“:"O",Ã”:"O",Ã•:"O",Ã–:"O",Ã˜:"O",Ã²:"o",Ã³:"o",Ã´:"o",Ãµ:"o",Ã¶:"o",Ã¸:"o",Ã™:"U",Ãš:"U",Ã›:"U",Ãœ:"U",Ã¹:"u",Ãº:"u",Ã»:"u",Ã¼:"u",Ã:"Y",Ã½:"y",Ã¿:"y",Ã†:"Ae",Ã¦:"ae",Ãž:"Th",Ã¾:"th",ÃŸ:"ss",Ä€:"A",Ä‚:"A",Ä„:"A",Ä:"a",Äƒ:"a",Ä…:"a",Ä†:"C",Äˆ:"C",ÄŠ:"C",ÄŒ:"C",Ä‡:"c",Ä‰:"c",Ä‹:"c",Ä:"c",ÄŽ:"D",Ä:"D",Ä:"d",Ä‘:"d",Ä’:"E",Ä”:"E",Ä–:"E",Ä˜:"E",Äš:"E",Ä“:"e",Ä•:"e",Ä—:"e",Ä™:"e",Ä›:"e",Äœ:"G",Äž:"G",Ä :"G",Ä¢:"G",Ä:"g",ÄŸ:"g",Ä¡:"g",Ä£:"g",Ä¤:"H",Ä¦:"H",Ä¥:"h",Ä§:"h",Ä¨:"I",Äª:"I",Ä¬:"I",Ä®:"I",Ä°:"I",Ä©:"i",Ä«:"i",Ä­:"i",Ä¯:"i",Ä±:"i",Ä´:"J",Äµ:"j",Ä¶:"K",Ä·:"k",Ä¸:"k",Ä¹:"L",Ä»:"L",Ä½:"L",Ä¿:"L",Å:"L",Äº:"l",Ä¼:"l",Ä¾:"l",Å€:"l",Å‚:"l",Åƒ:"N",Å…:"N",Å‡:"N",ÅŠ:"N",Å„:"n",Å†:"n",Åˆ:"n",Å‹:"n",ÅŒ:"O",ÅŽ:"O",Å:"O",Å:"o",Å:"o",Å‘:"o",Å”:"R",Å–:"R",Å˜:"R",Å•:"r",Å—:"r",Å™:"r",Åš:"S",Åœ:"S",Åž:"S",Å :"S",Å›:"s",Å:"s",ÅŸ:"s",Å¡:"s",Å¢:"T",Å¤:"T",Å¦:"T",Å£:"t",Å¥:"t",Å§:"t",Å¨:"U",Åª:"U",Å¬:"U",Å®:"U",Å°:"U",Å²:"U",Å©:"u",Å«:"u",Å­:"u",Å¯:"u",Å±:"u",Å³:"u",Å´:"W",Åµ:"w",Å¶:"Y",Å·:"y",Å¸:"Y",Å¹:"Z",Å»:"Z",Å½:"Z",Åº:"z",Å¼:"z",Å¾:"z",Ä²:"IJ",Ä³:"ij",Å’:"Oe",Å“:"oe",Å‰:"'n",Å¿:"ss"},W=e.g&&e.g.Object===Object&&e.g,G="object"==typeof self&&self&&self.Object===Object&&self,Q=W||G||Function("return this")();function K(e,t,r,i){var n=-1,s=e?e.length:0;for(i&&s&&(r=e[++n]);++n<s;)r=t(r,e[n],n,e);return r}function J(e){return e.split("")}function Y(e){return e.match(s)||[]}var X=function(e){return function(t){return null==e?void 0:e[t]}}(H);function Z(e){return q.test(e)}function ee(e){return $.test(e)}function et(e){return Z(e)?er(e):J(e)}function er(e){return e.match(V)||[]}function ei(e){return e.match(z)||[]}var en=Object.prototype.toString,es=Q.Symbol,ea=es?es.prototype:void 0,eo=ea?ea.toString:void 0;function el(e,t,r){var i=-1,n=e.length;t<0&&(t=-t>n?0:n+t),(r=r>n?n:r)<0&&(r+=n),n=t>r?0:r-t>>>0,t>>>=0;for(var s=Array(n);++i<n;)s[i]=e[i+t];return s}function ec(e){if("string"==typeof e)return e;if(ef(e))return eo?eo.call(e):"";var t=e+"";return"0"==t&&1/e==-i?"-0":t}function eu(e,t,r){var i=e.length;return r=void 0===r?i:r,!t&&r>=i?e:el(e,t,r)}function eh(e){return function(t){var r=Z(t=ep(t))?et(t):void 0,i=r?r[0]:t.charAt(0),n=r?eu(r,1).join(""):t.slice(1);return i[e]()+n}}function ed(e){return!!e&&"object"==typeof e}function ef(e){return"symbol"==typeof e||ed(e)&&en.call(e)==n}function ep(e){return null==e?"":ec(e)}var em=function(e){return function(t){return K(eb(ey(t).replace(j,"")),e,"")}}(function(e,t,r){return t=t.toLowerCase(),e+(r?eg(t):t)});function eg(e){return ev(ep(e).toLowerCase())}function ey(e){return(e=ep(e))&&e.replace(a,X).replace(U,"")}var ev=eh("toUpperCase");function eb(e,t,r){return(e=ep(e),void 0===(t=r?void 0:t))?ee(e)?ei(e):Y(e):e.match(t)||[]}t.exports=em},1396,(e,t,r)=>{"use strict";t.exports=function e(e,t){for(var r=Array(arguments.length-1),i=0,n=2,s=!0;n<arguments.length;)r[i++]=arguments[n++];return new Promise(function(n,a){r[i]=function(e){if(s)if(s=!1,e)a(e);else{for(var t=Array(arguments.length-1),r=0;r<t.length;)t[r++]=arguments[r];n.apply(null,t)}};try{e.apply(t||null,r)}catch(e){s&&(s=!1,a(e))}})}},31323,(e,t,r)=>{"use strict";var i=r;i.length=function(e){var t=e.length;if(!t)return 0;for(var r=0;--t%4>1&&"="===e.charAt(t);)++r;return Math.ceil(3*e.length)/4-r};for(var n=Array(64),s=Array(123),a=0;a<64;)s[n[a]=a<26?a+65:a<52?a+71:a<62?a-4:a-59|43]=a++;i.encode=function(e,t,r){for(var i,s=null,a=[],o=0,l=0;t<r;){var c=e[t++];switch(l){case 0:a[o++]=n[c>>2],i=(3&c)<<4,l=1;break;case 1:a[o++]=n[i|c>>4],i=(15&c)<<2,l=2;break;case 2:a[o++]=n[i|c>>6],a[o++]=n[63&c],l=0}o>8191&&((s||(s=[])).push(String.fromCharCode.apply(String,a)),o=0)}return(l&&(a[o++]=n[i],a[o++]=61,1===l&&(a[o++]=61)),s)?(o&&s.push(String.fromCharCode.apply(String,a.slice(0,o))),s.join("")):String.fromCharCode.apply(String,a.slice(0,o))};var o="invalid encoding";i.decode=function(e,t,r){for(var i,n=r,a=0,l=0;l<e.length;){var c=e.charCodeAt(l++);if(61===c&&a>1)break;if(void 0===(c=s[c]))throw Error(o);switch(a){case 0:i=c,a=1;break;case 1:t[r++]=i<<2|(48&c)>>4,i=c,a=2;break;case 2:t[r++]=(15&i)<<4|(60&c)>>2,i=c,a=3;break;case 3:t[r++]=(3&i)<<6|c,a=0}}if(1===a)throw Error(o);return r-n},i.test=function(e){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(e)}},17878,(e,t,r)=>{"use strict";function i(){this._listeners={}}t.exports=i,i.prototype.on=function(e,t,r){return(this._listeners[e]||(this._listeners[e]=[])).push({fn:t,ctx:r||this}),this},i.prototype.off=function(e,t){if(void 0===e)this._listeners={};else if(void 0===t)this._listeners[e]=[];else for(var r=this._listeners[e],i=0;i<r.length;)r[i].fn===t?r.splice(i,1):++i;return this},i.prototype.emit=function(e){var t=this._listeners[e];if(t){for(var r=[],i=1;i<arguments.length;)r.push(arguments[i++]);for(i=0;i<t.length;)t[i].fn.apply(t[i++].ctx,r)}return this}},84048,(e,t,r)=>{"use strict";function i(e){return"undefined"!=typeof Float32Array?!function(){var t=new Float32Array([-0]),r=new Uint8Array(t.buffer),i=128===r[3];function n(e,i,n){t[0]=e,i[n]=r[0],i[n+1]=r[1],i[n+2]=r[2],i[n+3]=r[3]}function s(e,i,n){t[0]=e,i[n]=r[3],i[n+1]=r[2],i[n+2]=r[1],i[n+3]=r[0]}function a(e,i){return r[0]=e[i],r[1]=e[i+1],r[2]=e[i+2],r[3]=e[i+3],t[0]}function o(e,i){return r[3]=e[i],r[2]=e[i+1],r[1]=e[i+2],r[0]=e[i+3],t[0]}e.writeFloatLE=i?n:s,e.writeFloatBE=i?s:n,e.readFloatLE=i?a:o,e.readFloatBE=i?o:a}():!function(){function t(e,t,r,i){var n=+(t<0);if(n&&(t=-t),0===t)e(1/t>0?0:0x80000000,r,i);else if(isNaN(t))e(0x7fc00000,r,i);else if(t>34028234663852886e22)e((n<<31|0x7f800000)>>>0,r,i);else if(t<11754943508222875e-54)e((n<<31|Math.round(t/1401298464324817e-60))>>>0,r,i);else{var s=Math.floor(Math.log(t)/Math.LN2),a=8388607&Math.round(t*Math.pow(2,-s)*8388608);e((n<<31|s+127<<23|a)>>>0,r,i)}}function r(e,t,r){var i=e(t,r),n=(i>>31)*2+1,s=i>>>23&255,a=8388607&i;return 255===s?a?NaN:1/0*n:0===s?1401298464324817e-60*n*a:n*Math.pow(2,s-150)*(a+8388608)}e.writeFloatLE=t.bind(null,n),e.writeFloatBE=t.bind(null,s),e.readFloatLE=r.bind(null,a),e.readFloatBE=r.bind(null,o)}(),"undefined"!=typeof Float64Array?!function(){var t=new Float64Array([-0]),r=new Uint8Array(t.buffer),i=128===r[7];function n(e,i,n){t[0]=e,i[n]=r[0],i[n+1]=r[1],i[n+2]=r[2],i[n+3]=r[3],i[n+4]=r[4],i[n+5]=r[5],i[n+6]=r[6],i[n+7]=r[7]}function s(e,i,n){t[0]=e,i[n]=r[7],i[n+1]=r[6],i[n+2]=r[5],i[n+3]=r[4],i[n+4]=r[3],i[n+5]=r[2],i[n+6]=r[1],i[n+7]=r[0]}function a(e,i){return r[0]=e[i],r[1]=e[i+1],r[2]=e[i+2],r[3]=e[i+3],r[4]=e[i+4],r[5]=e[i+5],r[6]=e[i+6],r[7]=e[i+7],t[0]}function o(e,i){return r[7]=e[i],r[6]=e[i+1],r[5]=e[i+2],r[4]=e[i+3],r[3]=e[i+4],r[2]=e[i+5],r[1]=e[i+6],r[0]=e[i+7],t[0]}e.writeDoubleLE=i?n:s,e.writeDoubleBE=i?s:n,e.readDoubleLE=i?a:o,e.readDoubleBE=i?o:a}():!function(){function t(e,t,r,i,n,s){var a,o=+(i<0);if(o&&(i=-i),0===i)e(0,n,s+t),e(1/i>0?0:0x80000000,n,s+r);else if(isNaN(i))e(0,n,s+t),e(0x7ff80000,n,s+r);else if(i>17976931348623157e292)e(0,n,s+t),e((o<<31|0x7ff00000)>>>0,n,s+r);else if(i<22250738585072014e-324)e((a=i/5e-324)>>>0,n,s+t),e((o<<31|a/0x100000000)>>>0,n,s+r);else{var l=Math.floor(Math.log(i)/Math.LN2);1024===l&&(l=1023),e(0x10000000000000*(a=i*Math.pow(2,-l))>>>0,n,s+t),e((o<<31|l+1023<<20|1048576*a&1048575)>>>0,n,s+r)}}function r(e,t,r,i,n){var s=e(i,n+t),a=e(i,n+r),o=(a>>31)*2+1,l=a>>>20&2047,c=0x100000000*(1048575&a)+s;return 2047===l?c?NaN:1/0*o:0===l?5e-324*o*c:o*Math.pow(2,l-1075)*(c+0x10000000000000)}e.writeDoubleLE=t.bind(null,n,0,4),e.writeDoubleBE=t.bind(null,s,4,0),e.readDoubleLE=r.bind(null,a,0,4),e.readDoubleBE=r.bind(null,o,4,0)}(),e}function n(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function s(e,t,r){t[r]=e>>>24,t[r+1]=e>>>16&255,t[r+2]=e>>>8&255,t[r+3]=255&e}function a(e,t){return(e[t]|e[t+1]<<8|e[t+2]<<16|e[t+3]<<24)>>>0}function o(e,t){return(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}t.exports=i(i)},93423,(__turbopack_context__,module,exports)=>{"use strict";function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(e){}return null}module.exports=inquire},4226,(e,t,r)=>{"use strict";var i=r;i.length=function(e){for(var t=0,r=0,i=0;i<e.length;++i)(r=e.charCodeAt(i))<128?t+=1:r<2048?t+=2:(64512&r)==55296&&(64512&e.charCodeAt(i+1))==56320?(++i,t+=4):t+=3;return t},i.read=function(e,t,r){if(r-t<1)return"";for(var i,n=null,s=[],a=0;t<r;)(i=e[t++])<128?s[a++]=i:i>191&&i<224?s[a++]=(31&i)<<6|63&e[t++]:i>239&&i<365?(i=((7&i)<<18|(63&e[t++])<<12|(63&e[t++])<<6|63&e[t++])-65536,s[a++]=55296+(i>>10),s[a++]=56320+(1023&i)):s[a++]=(15&i)<<12|(63&e[t++])<<6|63&e[t++],a>8191&&((n||(n=[])).push(String.fromCharCode.apply(String,s)),a=0);return n?(a&&n.push(String.fromCharCode.apply(String,s.slice(0,a))),n.join("")):String.fromCharCode.apply(String,s.slice(0,a))},i.write=function(e,t,r){for(var i,n,s=r,a=0;a<e.length;++a)(i=e.charCodeAt(a))<128?t[r++]=i:(i<2048?t[r++]=i>>6|192:((64512&i)==55296&&(64512&(n=e.charCodeAt(a+1)))==56320?(i=65536+((1023&i)<<10)+(1023&n),++a,t[r++]=i>>18|240,t[r++]=i>>12&63|128):t[r++]=i>>12|224,t[r++]=i>>6&63|128),t[r++]=63&i|128);return r-s}},56880,(e,t,r)=>{"use strict";t.exports=function e(e,t,r){var i=r||8192,n=i>>>1,s=null,a=i;return function(r){if(r<1||r>n)return e(r);a+r>i&&(s=e(i),a=0);var o=t.call(s,a,a+=r);return 7&a&&(a=(7|a)+1),o}}},82512,(e,t,r)=>{"use strict";t.exports=n;var i=e.r(30005);function n(e,t){this.lo=e>>>0,this.hi=t>>>0}var s=n.zero=new n(0,0);s.toNumber=function(){return 0},s.zzEncode=s.zzDecode=function(){return this},s.length=function(){return 1};var a=n.zeroHash="\0\0\0\0\0\0\0\0";n.fromNumber=function(e){if(0===e)return s;var t=e<0;t&&(e=-e);var r=e>>>0,i=(e-r)/0x100000000>>>0;return t&&(i=~i>>>0,r=~r>>>0,++r>0xffffffff&&(r=0,++i>0xffffffff&&(i=0))),new n(r,i)},n.from=function(e){if("number"==typeof e)return n.fromNumber(e);if(i.isString(e))if(!i.Long)return n.fromNumber(parseInt(e,10));else e=i.Long.fromString(e);return e.low||e.high?new n(e.low>>>0,e.high>>>0):s},n.prototype.toNumber=function(e){if(!e&&this.hi>>>31){var t=~this.lo+1>>>0,r=~this.hi>>>0;return t||(r=r+1>>>0),-(t+0x100000000*r)}return this.lo+0x100000000*this.hi},n.prototype.toLong=function(e){return i.Long?new i.Long(0|this.lo,0|this.hi,!!e):{low:0|this.lo,high:0|this.hi,unsigned:!!e}};var o=String.prototype.charCodeAt;n.fromHash=function(e){return e===a?s:new n((o.call(e,0)|o.call(e,1)<<8|o.call(e,2)<<16|o.call(e,3)<<24)>>>0,(o.call(e,4)|o.call(e,5)<<8|o.call(e,6)<<16|o.call(e,7)<<24)>>>0)},n.prototype.toHash=function(){return String.fromCharCode(255&this.lo,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,255&this.hi,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},n.prototype.zzEncode=function(){var e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this},n.prototype.zzDecode=function(){var e=-(1&this.lo);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this},n.prototype.length=function(){var e=this.lo,t=(this.lo>>>28|this.hi<<4)>>>0,r=this.hi>>>24;return 0===r?0===t?e<16384?e<128?1:2:e<2097152?3:4:t<16384?t<128?5:6:t<2097152?7:8:r<128?9:10}},30005,(e,t,r)=>{"use strict";var i=r;function n(e,t,r){for(var i=Object.keys(t),n=0;n<i.length;++n)void 0!==e[i[n]]&&r||(e[i[n]]=t[i[n]]);return e}function s(e){function t(e,r){if(!(this instanceof t))return new t(e,r);Object.defineProperty(this,"message",{get:function(){return e}}),Error.captureStackTrace?Error.captureStackTrace(this,t):Object.defineProperty(this,"stack",{value:Error().stack||""}),r&&n(this,r)}return t.prototype=Object.create(Error.prototype,{constructor:{value:t,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return e},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),t}i.asPromise=e.r(1396),i.base64=e.r(31323),i.EventEmitter=e.r(17878),i.float=e.r(84048),i.inquire=e.r(93423),i.utf8=e.r(4226),i.pool=e.r(56880),i.LongBits=e.r(82512),i.isNode=!!(e.g&&e.g.process&&e.g.process.versions&&e.g.process.versions.node),i.global=i.isNode&&e.g||"undefined"!=typeof self&&self||e.e,i.emptyArray=Object.freeze?Object.freeze([]):[],i.emptyObject=Object.freeze?Object.freeze({}):{},i.isInteger=Number.isInteger||function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},i.isString=function(e){return"string"==typeof e||e instanceof String},i.isObject=function(e){return e&&"object"==typeof e},i.isset=i.isSet=function(e,t){var r=e[t];return!!(null!=r&&e.hasOwnProperty(t))&&("object"!=typeof r||(Array.isArray(r)?r.length:Object.keys(r).length)>0)},i.Buffer=function(){try{var e=i.inquire("buffer").Buffer;return e.prototype.utf8Write?e:null}catch(e){return null}}(),i._Buffer_from=null,i._Buffer_allocUnsafe=null,i.newBuffer=function(e){return"number"==typeof e?i.Buffer?i._Buffer_allocUnsafe(e):new i.Array(e):i.Buffer?i._Buffer_from(e):"undefined"==typeof Uint8Array?e:new Uint8Array(e)},i.Array="undefined"!=typeof Uint8Array?Uint8Array:Array,i.Long=i.global.dcodeIO&&i.global.dcodeIO.Long||i.global.Long||i.inquire("long"),i.key2Re=/^true|false|0|1$/,i.key32Re=/^-?(?:0|[1-9][0-9]*)$/,i.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,i.longToHash=function(e){return e?i.LongBits.from(e).toHash():i.LongBits.zeroHash},i.longFromHash=function(e,t){var r=i.LongBits.fromHash(e);return i.Long?i.Long.fromBits(r.lo,r.hi,t):r.toNumber(!!t)},i.merge=n,i.lcFirst=function(e){return e.charAt(0).toLowerCase()+e.substring(1)},i.newError=s,i.ProtocolError=s("ProtocolError"),i.oneOfGetter=function(e){for(var t={},r=0;r<e.length;++r)t[e[r]]=1;return function(){for(var e=Object.keys(this),r=e.length-1;r>-1;--r)if(1===t[e[r]]&&void 0!==this[e[r]]&&null!==this[e[r]])return e[r]}},i.oneOfSetter=function(e){return function(t){for(var r=0;r<e.length;++r)e[r]!==t&&delete this[e[r]]}},i.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},i._configure=function(){var e=i.Buffer;if(!e){i._Buffer_from=i._Buffer_allocUnsafe=null;return}i._Buffer_from=e.from!==Uint8Array.from&&e.from||function(t,r){return new e(t,r)},i._Buffer_allocUnsafe=e.allocUnsafe||function(t){return new e(t)}}},72705,(e,t,r)=>{"use strict";t.exports={}},45618,(e,t,r)=>{"use strict";function i(e,t){"string"==typeof e&&(t=e,e=void 0);var r=[];function n(e){if("string"!=typeof e){var t=s();if(i.verbose&&console.log("codegen: "+t),t="return "+t,e){for(var a=Object.keys(e),o=Array(a.length+1),l=Array(a.length),c=0;c<a.length;)o[c]=a[c],l[c]=e[a[c++]];return o[c]=t,Function.apply(null,o).apply(null,l)}return Function(t)()}for(var u=Array(arguments.length-1),h=0;h<u.length;)u[h]=arguments[++h];if(h=0,e=e.replace(/%([%dfijs])/g,function(e,t){var r=u[h++];switch(t){case"d":case"f":return String(Number(r));case"i":return String(Math.floor(r));case"j":return JSON.stringify(r);case"s":return String(r)}return"%"}),h!==u.length)throw Error("parameter count mismatch");return r.push(e),n}function s(i){return"function "+(i||t||"")+"("+(e&&e.join(",")||"")+"){\n  "+r.join("\n  ")+"\n}"}return n.toString=s,n}t.exports=i,i.verbose=!1},45364,(e,t,r)=>{"use strict";t.exports=s;var i=e.r(1396),n=e.r(93423)("fs");function s(e,t,r){return("function"==typeof t?(r=t,t={}):t||(t={}),r)?!t.xhr&&n&&n.readFile?n.readFile(e,function(i,n){return i&&"undefined"!=typeof XMLHttpRequest?s.xhr(e,t,r):i?r(i):r(null,t.binary?n:n.toString("utf8"))}):s.xhr(e,t,r):i(s,this,e,t)}s.xhr=function(e,t,r){var i=new XMLHttpRequest;i.onreadystatechange=function(){if(4===i.readyState){if(0!==i.status&&200!==i.status)return r(Error("status "+i.status));if(t.binary){var e=i.response;if(!e){e=[];for(var n=0;n<i.responseText.length;++n)e.push(255&i.responseText.charCodeAt(n))}return r(null,"undefined"!=typeof Uint8Array?new Uint8Array(e):e)}return r(null,i.responseText)}},t.binary&&("overrideMimeType"in i&&i.overrideMimeType("text/plain; charset=x-user-defined"),i.responseType="arraybuffer"),i.open("GET",e),i.send()}},67074,(e,t,r)=>{"use strict";var i=r,n=i.isAbsolute=function(e){return/^(?:\/|\w+:)/.test(e)},s=i.normalize=function(e){var t=(e=e.replace(/\\/g,"/").replace(/\/{2,}/g,"/")).split("/"),r=n(e),i="";r&&(i=t.shift()+"/");for(var s=0;s<t.length;)".."===t[s]?s>0&&".."!==t[s-1]?t.splice(--s,2):r?t.splice(s,1):++s:"."===t[s]?t.splice(s,1):++s;return i+t.join("/")};i.resolve=function(e,t,r){return(r||(t=s(t)),n(t))?t:(r||(e=s(e)),(e=e.replace(/(?:\/|^)[^/]+$/,"")).length?s(e+"/"+t):t)}},85442,(e,t,r)=>{"use strict";t.exports=h;var i,n,s,a=e.r(90844);((h.prototype=Object.create(a.prototype)).constructor=h).className="Namespace";var o=e.r(845),l=e.r(61863),c=e.r(1769);function u(e,t){if(e&&e.length){for(var r={},i=0;i<e.length;++i)r[e[i].name]=e[i].toJSON(t);return r}}function h(e,t){a.call(this,e,t),this.nested=void 0,this._nestedArray=null,this._lookupCache={},this._needsRecursiveFeatureResolution=!0,this._needsRecursiveResolve=!0}function d(e){e._nestedArray=null,e._lookupCache={};for(var t=e;t=t.parent;)t._lookupCache={};return e}h.fromJSON=function(e,t){return new h(e,t.options).addJSON(t.nested)},h.arrayToJSON=u,h.isReservedId=function(e,t){if(e){for(var r=0;r<e.length;++r)if("string"!=typeof e[r]&&e[r][0]<=t&&e[r][1]>t)return!0}return!1},h.isReservedName=function(e,t){if(e){for(var r=0;r<e.length;++r)if(e[r]===t)return!0}return!1},Object.defineProperty(h.prototype,"nestedArray",{get:function(){return this._nestedArray||(this._nestedArray=l.toArray(this.nested))}}),h.prototype.toJSON=function(e){return l.toObject(["options",this.options,"nested",u(this.nestedArray,e)])},h.prototype.addJSON=function(e){var t=this;if(e)for(var r,a=Object.keys(e),l=0;l<a.length;++l)r=e[a[l]],t.add((void 0!==r.fields?i.fromJSON:void 0!==r.values?s.fromJSON:void 0!==r.methods?n.fromJSON:void 0!==r.id?o.fromJSON:h.fromJSON)(a[l],r));return this},h.prototype.get=function(e){return this.nested&&this.nested[e]||null},h.prototype.getEnum=function(e){if(this.nested&&this.nested[e]instanceof s)return this.nested[e].values;throw Error("no such enum: "+e)},h.prototype.add=function(e){if(!(e instanceof o&&void 0!==e.extend||e instanceof i||e instanceof c||e instanceof s||e instanceof n||e instanceof h))throw TypeError("object must be a valid nested object");if(this.nested){var t=this.get(e.name);if(t)if(t instanceof h&&e instanceof h&&!(t instanceof i||t instanceof n)){for(var r=t.nestedArray,a=0;a<r.length;++a)e.add(r[a]);this.remove(t),this.nested||(this.nested={}),e.setOptions(t.options,!0)}else throw Error("duplicate name '"+e.name+"' in "+this)}else this.nested={};this.nested[e.name]=e,this instanceof i||this instanceof n||this instanceof s||this instanceof o||e._edition||(e._edition=e._defaultEdition),this._needsRecursiveFeatureResolution=!0,this._needsRecursiveResolve=!0;for(var l=this;l=l.parent;)l._needsRecursiveFeatureResolution=!0,l._needsRecursiveResolve=!0;return e.onAdd(this),d(this)},h.prototype.remove=function(e){if(!(e instanceof a))throw TypeError("object must be a ReflectionObject");if(e.parent!==this)throw Error(e+" is not a member of "+this);return delete this.nested[e.name],Object.keys(this.nested).length||(this.nested=void 0),e.onRemove(this),d(this)},h.prototype.define=function(e,t){if(l.isString(e))e=e.split(".");else if(!Array.isArray(e))throw TypeError("illegal path");if(e&&e.length&&""===e[0])throw Error("path must be relative");for(var r=this;e.length>0;){var i=e.shift();if(r.nested&&r.nested[i]){if(!((r=r.nested[i])instanceof h))throw Error("path conflicts with non-namespace objects")}else r.add(r=new h(i))}return t&&r.addJSON(t),r},h.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;this._resolveFeaturesRecursive(this._edition);var e=this.nestedArray,t=0;for(this.resolve();t<e.length;)e[t]instanceof h?e[t++].resolveAll():e[t++].resolve();return this._needsRecursiveResolve=!1,this},h.prototype._resolveFeaturesRecursive=function(e){return this._needsRecursiveFeatureResolution&&(this._needsRecursiveFeatureResolution=!1,e=this._edition||e,a.prototype._resolveFeaturesRecursive.call(this,e),this.nestedArray.forEach(t=>{t._resolveFeaturesRecursive(e)})),this},h.prototype.lookup=function(e,t,r){if("boolean"==typeof t?(r=t,t=void 0):t&&!Array.isArray(t)&&(t=[t]),l.isString(e)&&e.length){if("."===e)return this.root;e=e.split(".")}else if(!e.length)return this;var i=e.join(".");if(""===e[0])return this.root.lookup(e.slice(1),t);var n=this.root._fullyQualifiedObjects&&this.root._fullyQualifiedObjects["."+i];if(n&&(!t||t.indexOf(n.constructor)>-1)||(n=this._lookupImpl(e,i))&&(!t||t.indexOf(n.constructor)>-1))return n;if(r)return null;for(var s=this;s.parent;){if((n=s.parent._lookupImpl(e,i))&&(!t||t.indexOf(n.constructor)>-1))return n;s=s.parent}return null},h.prototype._lookupImpl=function(e,t){if(Object.prototype.hasOwnProperty.call(this._lookupCache,t))return this._lookupCache[t];var r=this.get(e[0]),i=null;if(r)1===e.length?i=r:r instanceof h&&(e=e.slice(1),i=r._lookupImpl(e,e.join(".")));else for(var n=0;n<this.nestedArray.length;++n)this._nestedArray[n]instanceof h&&(r=this._nestedArray[n]._lookupImpl(e,t))&&(i=r);return this._lookupCache[t]=i,i},h.prototype.lookupType=function(e){var t=this.lookup(e,[i]);if(!t)throw Error("no such type: "+e);return t},h.prototype.lookupEnum=function(e){var t=this.lookup(e,[s]);if(!t)throw Error("no such Enum '"+e+"' in "+this);return t},h.prototype.lookupTypeOrEnum=function(e){var t=this.lookup(e,[i,s]);if(!t)throw Error("no such Type or Enum '"+e+"' in "+this);return t},h.prototype.lookupService=function(e){var t=this.lookup(e,[n]);if(!t)throw Error("no such Service '"+e+"' in "+this);return t},h._configure=function(e,t,r){i=e,n=t,s=r}},74755,(e,t,r)=>{"use strict";t.exports=a;var i=e.r(845);((a.prototype=Object.create(i.prototype)).constructor=a).className="MapField";var n=e.r(93145),s=e.r(61863);function a(e,t,r,n,a,o){if(i.call(this,e,t,n,void 0,void 0,a,o),!s.isString(r))throw TypeError("keyType must be a string");this.keyType=r,this.resolvedKeyType=null,this.map=!0}a.fromJSON=function(e,t){return new a(e,t.id,t.keyType,t.type,t.options,t.comment)},a.prototype.toJSON=function(e){var t=!!e&&!!e.keepComments;return s.toObject(["keyType",this.keyType,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])},a.prototype.resolve=function(){if(this.resolved)return this;if(void 0===n.mapKey[this.keyType])throw Error("invalid key type: "+this.keyType);return i.prototype.resolve.call(this)},a.d=function(e,t,r){return"function"==typeof r?r=s.decorateType(r).name:r&&"object"==typeof r&&(r=s.decorateEnum(r).name),function(i,n){s.decorateType(i.constructor).add(new a(n,e,t,r))}}},51212,(e,t,r)=>{"use strict";t.exports=s;var i=e.r(90844);((s.prototype=Object.create(i.prototype)).constructor=s).className="Method";var n=e.r(61863);function s(e,t,r,s,a,o,l,c,u){if(n.isObject(a)?(l=a,a=o=void 0):n.isObject(o)&&(l=o,o=void 0),!(void 0===t||n.isString(t)))throw TypeError("type must be a string");if(!n.isString(r))throw TypeError("requestType must be a string");if(!n.isString(s))throw TypeError("responseType must be a string");i.call(this,e,l),this.type=t||"rpc",this.requestType=r,this.requestStream=!!a||void 0,this.responseType=s,this.responseStream=!!o||void 0,this.resolvedRequestType=null,this.resolvedResponseType=null,this.comment=c,this.parsedOptions=u}s.fromJSON=function(e,t){return new s(e,t.type,t.requestType,t.responseType,t.requestStream,t.responseStream,t.options,t.comment,t.parsedOptions)},s.prototype.toJSON=function(e){var t=!!e&&!!e.keepComments;return n.toObject(["type","rpc"!==this.type&&this.type||void 0,"requestType",this.requestType,"requestStream",this.requestStream,"responseType",this.responseType,"responseStream",this.responseStream,"options",this.options,"comment",t?this.comment:void 0,"parsedOptions",this.parsedOptions])},s.prototype.resolve=function(){return this.resolved?this:(this.resolvedRequestType=this.parent.lookupType(this.requestType),this.resolvedResponseType=this.parent.lookupType(this.responseType),i.prototype.resolve.call(this))}},51591,(e,t,r)=>{"use strict";t.exports=n;var i=e.r(30005);function n(e,t,r){if("function"!=typeof e)throw TypeError("rpcImpl must be a function");i.EventEmitter.call(this),this.rpcImpl=e,this.requestDelimited=!!t,this.responseDelimited=!!r}(n.prototype=Object.create(i.EventEmitter.prototype)).constructor=n,n.prototype.rpcCall=function e(t,r,n,s,a){if(!s)throw TypeError("request must be specified");var o=this;if(!a)return i.asPromise(e,o,t,r,n,s);if(!o.rpcImpl)return void setTimeout(function(){a(Error("already ended"))},0);try{return o.rpcImpl(t,r[o.requestDelimited?"encodeDelimited":"encode"](s).finish(),function(e,r){if(e)return o.emit("error",e,t),a(e);if(null===r)return void o.end(!0);if(!(r instanceof n))try{r=n[o.responseDelimited?"decodeDelimited":"decode"](r)}catch(e){return o.emit("error",e,t),a(e)}return o.emit("data",r,t),a(null,r)})}catch(e){o.emit("error",e,t),setTimeout(function(){a(e)},0);return}},n.prototype.end=function(e){return this.rpcImpl&&(e||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}},74521,(e,t,r)=>{"use strict";r.Service=e.r(51591)},54392,(e,t,r)=>{"use strict";t.exports=o;var i=e.r(85442);((o.prototype=Object.create(i.prototype)).constructor=o).className="Service";var n=e.r(51212),s=e.r(61863),a=e.r(74521);function o(e,t){i.call(this,e,t),this.methods={},this._methodsArray=null}function l(e){return e._methodsArray=null,e}o.fromJSON=function(e,t){var r=new o(e,t.options);if(t.methods)for(var i=Object.keys(t.methods),s=0;s<i.length;++s)r.add(n.fromJSON(i[s],t.methods[i[s]]));return t.nested&&r.addJSON(t.nested),t.edition&&(r._edition=t.edition),r.comment=t.comment,r._defaultEdition="proto3",r},o.prototype.toJSON=function(e){var t=i.prototype.toJSON.call(this,e),r=!!e&&!!e.keepComments;return s.toObject(["edition",this._editionToJSON(),"options",t&&t.options||void 0,"methods",i.arrayToJSON(this.methodsArray,e)||{},"nested",t&&t.nested||void 0,"comment",r?this.comment:void 0])},Object.defineProperty(o.prototype,"methodsArray",{get:function(){return this._methodsArray||(this._methodsArray=s.toArray(this.methods))}}),o.prototype.get=function(e){return this.methods[e]||i.prototype.get.call(this,e)},o.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;i.prototype.resolve.call(this);for(var e=this.methodsArray,t=0;t<e.length;++t)e[t].resolve();return this},o.prototype._resolveFeaturesRecursive=function(e){return this._needsRecursiveFeatureResolution&&(e=this._edition||e,i.prototype._resolveFeaturesRecursive.call(this,e),this.methodsArray.forEach(t=>{t._resolveFeaturesRecursive(e)})),this},o.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);return e instanceof n?(this.methods[e.name]=e,e.parent=this,l(this)):i.prototype.add.call(this,e)},o.prototype.remove=function(e){if(e instanceof n){if(this.methods[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.methods[e.name],e.parent=null,l(this)}return i.prototype.remove.call(this,e)},o.prototype.create=function(e,t,r){for(var i,n=new a.Service(e,t,r),o=0;o<this.methodsArray.length;++o){var l=s.lcFirst((i=this._methodsArray[o]).resolve().name).replace(/[^$\w_]/g,"");n[l]=s.codegen(["r","c"],s.isReserved(l)?l+"_":l)("return this.rpcCall(m,q,s,r,c)")({m:i,q:i.resolvedRequestType.ctor,s:i.resolvedResponseType.ctor})}return n}},3864,(e,t,r)=>{"use strict";t.exports=n;var i=e.r(30005);function n(e){if(e)for(var t=Object.keys(e),r=0;r<t.length;++r)this[t[r]]=e[t[r]]}n.create=function(e){return this.$type.create(e)},n.encode=function(e,t){return this.$type.encode(e,t)},n.encodeDelimited=function(e,t){return this.$type.encodeDelimited(e,t)},n.decode=function(e){return this.$type.decode(e)},n.decodeDelimited=function(e){return this.$type.decodeDelimited(e)},n.verify=function(e){return this.$type.verify(e)},n.fromObject=function(e){return this.$type.fromObject(e)},n.toObject=function(e,t){return this.$type.toObject(e,t)},n.prototype.toJSON=function(){return this.$type.toObject(this,i.toJSONOptions)}},15303,(e,t,r)=>{"use strict";t.exports=l;var i,n=e.r(30005),s=n.LongBits,a=n.utf8;function o(e,t){return RangeError("index out of range: "+e.pos+" + "+(t||1)+" > "+e.len)}function l(e){this.buf=e,this.pos=0,this.len=e.length}var c="undefined"!=typeof Uint8Array?function(e){if(e instanceof Uint8Array||Array.isArray(e))return new l(e);throw Error("illegal buffer")}:function(e){if(Array.isArray(e))return new l(e);throw Error("illegal buffer")},u=function(){return n.Buffer?function(e){return(l.create=function(e){return n.Buffer.isBuffer(e)?new i(e):c(e)})(e)}:c};function h(){var e=new s(0,0),t=0;if(this.len-this.pos>4){for(;t<4;++t)if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(127&this.buf[this.pos])<<28)>>>0,e.hi=(e.hi|(127&this.buf[this.pos])>>4)>>>0,this.buf[this.pos++]<128)return e;t=0}else{for(;t<3;++t){if(this.pos>=this.len)throw o(this);if(e.lo=(e.lo|(127&this.buf[this.pos])<<7*t)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(127&this.buf[this.pos++])<<7*t)>>>0,e}if(this.len-this.pos>4){for(;t<5;++t)if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}else for(;t<5;++t){if(this.pos>=this.len)throw o(this);if(e.hi=(e.hi|(127&this.buf[this.pos])<<7*t+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}function d(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}function f(){if(this.pos+8>this.len)throw o(this,8);return new s(d(this.buf,this.pos+=4),d(this.buf,this.pos+=4))}l.create=u(),l.prototype._slice=n.Array.prototype.subarray||n.Array.prototype.slice,l.prototype.uint32=function(){var e=0xffffffff;return function(){if(e=(127&this.buf[this.pos])>>>0,this.buf[this.pos++]<128||(e=(e|(127&this.buf[this.pos])<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(127&this.buf[this.pos])<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(127&this.buf[this.pos])<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(15&this.buf[this.pos])<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,o(this,10);return e}}(),l.prototype.int32=function(){return 0|this.uint32()},l.prototype.sint32=function(){var e=this.uint32();return e>>>1^-(1&e)},l.prototype.bool=function(){return 0!==this.uint32()},l.prototype.fixed32=function(){if(this.pos+4>this.len)throw o(this,4);return d(this.buf,this.pos+=4)},l.prototype.sfixed32=function(){if(this.pos+4>this.len)throw o(this,4);return 0|d(this.buf,this.pos+=4)},l.prototype.float=function(){if(this.pos+4>this.len)throw o(this,4);var e=n.float.readFloatLE(this.buf,this.pos);return this.pos+=4,e},l.prototype.double=function(){if(this.pos+8>this.len)throw o(this,4);var e=n.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,e},l.prototype.bytes=function(){var e=this.uint32(),t=this.pos,r=this.pos+e;if(r>this.len)throw o(this,e);if(this.pos+=e,Array.isArray(this.buf))return this.buf.slice(t,r);if(t===r){var i=n.Buffer;return i?i.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,t,r)},l.prototype.string=function(){var e=this.bytes();return a.read(e,0,e.length)},l.prototype.skip=function(e){if("number"==typeof e){if(this.pos+e>this.len)throw o(this,e);this.pos+=e}else do if(this.pos>=this.len)throw o(this);while(128&this.buf[this.pos++])return this},l.prototype.skipType=function(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;4!=(e=7&this.uint32());)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+e+" at offset "+this.pos)}return this},l._configure=function(e){i=e,l.create=u(),i._configure();var t=n.Long?"toLong":"toNumber";n.merge(l.prototype,{int64:function(){return h.call(this)[t](!1)},uint64:function(){return h.call(this)[t](!0)},sint64:function(){return h.call(this).zzDecode()[t](!1)},fixed64:function(){return f.call(this)[t](!0)},sfixed64:function(){return f.call(this)[t](!1)}})}},50285,(e,t,r)=>{"use strict";t.exports=h;var i,n=e.r(30005),s=n.LongBits,a=n.base64,o=n.utf8;function l(e,t,r){this.fn=e,this.len=t,this.next=void 0,this.val=r}function c(){}function u(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}function h(){this.len=0,this.head=new l(c,0,0),this.tail=this.head,this.states=null}var d=function(){return n.Buffer?function(){return(h.create=function(){return new i})()}:function(){return new h}};function f(e,t,r){t[r]=255&e}function p(e,t,r){for(;e>127;)t[r++]=127&e|128,e>>>=7;t[r]=e}function m(e,t){this.len=e,this.next=void 0,this.val=t}function g(e,t,r){for(;e.hi;)t[r++]=127&e.lo|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=127&e.lo|128,e.lo=e.lo>>>7;t[r++]=e.lo}function y(e,t,r){t[r]=255&e,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}h.create=d(),h.alloc=function(e){return new n.Array(e)},n.Array!==Array&&(h.alloc=n.pool(h.alloc,n.Array.prototype.subarray)),h.prototype._push=function(e,t,r){return this.tail=this.tail.next=new l(e,t,r),this.len+=t,this},m.prototype=Object.create(l.prototype),m.prototype.fn=p,h.prototype.uint32=function(e){return this.len+=(this.tail=this.tail.next=new m((e>>>=0)<128?1:e<16384?2:e<2097152?3:e<0x10000000?4:5,e)).len,this},h.prototype.int32=function(e){return e<0?this._push(g,10,s.fromNumber(e)):this.uint32(e)},h.prototype.sint32=function(e){return this.uint32((e<<1^e>>31)>>>0)},h.prototype.uint64=function(e){var t=s.from(e);return this._push(g,t.length(),t)},h.prototype.int64=h.prototype.uint64,h.prototype.sint64=function(e){var t=s.from(e).zzEncode();return this._push(g,t.length(),t)},h.prototype.bool=function(e){return this._push(f,1,+!!e)},h.prototype.fixed32=function(e){return this._push(y,4,e>>>0)},h.prototype.sfixed32=h.prototype.fixed32,h.prototype.fixed64=function(e){var t=s.from(e);return this._push(y,4,t.lo)._push(y,4,t.hi)},h.prototype.sfixed64=h.prototype.fixed64,h.prototype.float=function(e){return this._push(n.float.writeFloatLE,4,e)},h.prototype.double=function(e){return this._push(n.float.writeDoubleLE,8,e)};var v=n.Array.prototype.set?function(e,t,r){t.set(e,r)}:function(e,t,r){for(var i=0;i<e.length;++i)t[r+i]=e[i]};h.prototype.bytes=function(e){var t=e.length>>>0;if(!t)return this._push(f,1,0);if(n.isString(e)){var r=h.alloc(t=a.length(e));a.decode(e,r,0),e=r}return this.uint32(t)._push(v,t,e)},h.prototype.string=function(e){var t=o.length(e);return t?this.uint32(t)._push(o.write,t,e):this._push(f,1,0)},h.prototype.fork=function(){return this.states=new u(this),this.head=this.tail=new l(c,0,0),this.len=0,this},h.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new l(c,0,0),this.len=0),this},h.prototype.ldelim=function(){var e=this.head,t=this.tail,r=this.len;return this.reset().uint32(r),r&&(this.tail.next=e.next,this.tail=t,this.len+=r),this},h.prototype.finish=function(){for(var e=this.head.next,t=this.constructor.alloc(this.len),r=0;e;)e.fn(e.val,t,r),r+=e.len,e=e.next;return t},h._configure=function(e){i=e,h.create=d(),i._configure()}},75416,(e,t,r)=>{"use strict";t.exports=o;var i=e.r(27463),n=e.r(93145),s=e.r(61863);function a(e){return"missing required '"+e.name+"'"}function o(e){for(var t=s.codegen(["r","l","e"],e.name+"$decode")("if(!(r instanceof Reader))")("r=Reader.create(r)")("var c=l===undefined?r.len:r.pos+l,m=new this.ctor"+(e.fieldsArray.filter(function(e){return e.map}).length?",k,value":""))("while(r.pos<c){")("var t=r.uint32()")("if(t===e)")("break")("switch(t>>>3){"),r=0;r<e.fieldsArray.length;++r){var o=e._fieldsArray[r].resolve(),l=o.resolvedType instanceof i?"int32":o.type,c="m"+s.safeProp(o.name);t("case %i: {",o.id),o.map?(t("if(%s===util.emptyObject)",c)("%s={}",c)("var c2 = r.uint32()+r.pos"),void 0!==n.defaults[o.keyType]?t("k=%j",n.defaults[o.keyType]):t("k=null"),void 0!==n.defaults[l]?t("value=%j",n.defaults[l]):t("value=null"),t("while(r.pos<c2){")("var tag2=r.uint32()")("switch(tag2>>>3){")("case 1: k=r.%s(); break",o.keyType)("case 2:"),void 0===n.basic[l]?t("value=types[%i].decode(r,r.uint32())",r):t("value=r.%s()",l),t("break")("default:")("r.skipType(tag2&7)")("break")("}")("}"),void 0!==n.long[o.keyType]?t('%s[typeof k==="object"?util.longToHash(k):k]=value',c):t("%s[k]=value",c)):o.repeated?(t("if(!(%s&&%s.length))",c,c)("%s=[]",c),void 0!==n.packed[l]&&t("if((t&7)===2){")("var c2=r.uint32()+r.pos")("while(r.pos<c2)")("%s.push(r.%s())",c,l)("}else"),void 0===n.basic[l]?t(o.delimited?"%s.push(types[%i].decode(r,undefined,((t&~7)|4)))":"%s.push(types[%i].decode(r,r.uint32()))",c,r):t("%s.push(r.%s())",c,l)):void 0===n.basic[l]?t(o.delimited?"%s=types[%i].decode(r,undefined,((t&~7)|4))":"%s=types[%i].decode(r,r.uint32())",c,r):t("%s=r.%s()",c,l),t("break")("}")}for(t("default:")("r.skipType(t&7)")("break")("}")("}"),r=0;r<e._fieldsArray.length;++r){var u=e._fieldsArray[r];u.required&&t("if(!m.hasOwnProperty(%j))",u.name)("throw util.ProtocolError(%j,{instance:m})",a(u))}return t("return m")}},78085,(e,t,r)=>{"use strict";t.exports=l;var i=e.r(27463),n=e.r(61863);function s(e,t){return e.name+": "+t+(e.repeated&&"array"!==t?"[]":e.map&&"object"!==t?"{k:"+e.keyType+"}":"")+" expected"}function a(e,t,r,n){if(t.resolvedType)if(t.resolvedType instanceof i){e("switch(%s){",n)("default:")("return%j",s(t,"enum value"));for(var a=Object.keys(t.resolvedType.values),o=0;o<a.length;++o)e("case %i:",t.resolvedType.values[a[o]]);e("break")("}")}else e("{")("var e=types[%i].verify(%s);",r,n)("if(e)")("return%j+e",t.name+".")("}");else switch(t.type){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.isInteger(%s))",n)("return%j",s(t,"integer"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.isInteger(%s)&&!(%s&&util.isInteger(%s.low)&&util.isInteger(%s.high)))",n,n,n,n)("return%j",s(t,"integer|Long"));break;case"float":case"double":e('if(typeof %s!=="number")',n)("return%j",s(t,"number"));break;case"bool":e('if(typeof %s!=="boolean")',n)("return%j",s(t,"boolean"));break;case"string":e("if(!util.isString(%s))",n)("return%j",s(t,"string"));break;case"bytes":e('if(!(%s&&typeof %s.length==="number"||util.isString(%s)))',n,n,n)("return%j",s(t,"buffer"))}return e}function o(e,t,r){switch(t.keyType){case"int32":case"uint32":case"sint32":case"fixed32":case"sfixed32":e("if(!util.key32Re.test(%s))",r)("return%j",s(t,"integer key"));break;case"int64":case"uint64":case"sint64":case"fixed64":case"sfixed64":e("if(!util.key64Re.test(%s))",r)("return%j",s(t,"integer|Long key"));break;case"bool":e("if(!util.key2Re.test(%s))",r)("return%j",s(t,"boolean key"))}return e}function l(e){var t=n.codegen(["m"],e.name+"$verify")('if(typeof m!=="object"||m===null)')("return%j","object expected"),r=e.oneofsArray,i={};r.length&&t("var p={}");for(var l=0;l<e.fieldsArray.length;++l){var c=e._fieldsArray[l].resolve(),u="m"+n.safeProp(c.name);if(c.optional&&t("if(%s!=null&&m.hasOwnProperty(%j)){",u,c.name),c.map)t("if(!util.isObject(%s))",u)("return%j",s(c,"object"))("var k=Object.keys(%s)",u)("for(var i=0;i<k.length;++i){"),o(t,c,"k[i]"),a(t,c,l,u+"[k[i]]")("}");else if(c.repeated)t("if(!Array.isArray(%s))",u)("return%j",s(c,"array"))("for(var i=0;i<%s.length;++i){",u),a(t,c,l,u+"[i]")("}");else{if(c.partOf){var h=n.safeProp(c.partOf.name);1===i[c.partOf.name]&&t("if(p%s===1)",h)("return%j",c.partOf.name+": multiple values"),i[c.partOf.name]=1,t("p%s=1",h)}a(t,c,l,u)}c.optional&&t("}")}return t("return null")}},14005,(e,t,r)=>{"use strict";var i=r,n=e.r(27463),s=e.r(61863);function a(e,t,r,i){var s=!1;if(t.resolvedType)if(t.resolvedType instanceof n){e("switch(d%s){",i);for(var a=t.resolvedType.values,o=Object.keys(a),l=0;l<o.length;++l)a[o[l]]!==t.typeDefault||s||(e("default:")('if(typeof(d%s)==="number"){m%s=d%s;break}',i,i,i),t.repeated||e("break"),s=!0),e("case%j:",o[l])("case %i:",a[o[l]])("m%s=%j",i,a[o[l]])("break");e("}")}else e('if(typeof d%s!=="object")',i)("throw TypeError(%j)",t.fullName+": object expected")("m%s=types[%i].fromObject(d%s)",i,r,i);else{var c=!1;switch(t.type){case"double":case"float":e("m%s=Number(d%s)",i,i);break;case"uint32":case"fixed32":e("m%s=d%s>>>0",i,i);break;case"int32":case"sint32":case"sfixed32":e("m%s=d%s|0",i,i);break;case"uint64":c=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":e("if(util.Long)")("(m%s=util.Long.fromValue(d%s)).unsigned=%j",i,i,c)('else if(typeof d%s==="string")',i)("m%s=parseInt(d%s,10)",i,i)('else if(typeof d%s==="number")',i)("m%s=d%s",i,i)('else if(typeof d%s==="object")',i)("m%s=new util.LongBits(d%s.low>>>0,d%s.high>>>0).toNumber(%s)",i,i,i,c?"true":"");break;case"bytes":e('if(typeof d%s==="string")',i)("util.base64.decode(d%s,m%s=util.newBuffer(util.base64.length(d%s)),0)",i,i,i)("else if(d%s.length >= 0)",i)("m%s=d%s",i,i);break;case"string":e("m%s=String(d%s)",i,i);break;case"bool":e("m%s=Boolean(d%s)",i,i)}}return e}function o(e,t,r,i){if(t.resolvedType)t.resolvedType instanceof n?e("d%s=o.enums===String?(types[%i].values[m%s]===undefined?m%s:types[%i].values[m%s]):m%s",i,r,i,i,r,i,i):e("d%s=types[%i].toObject(m%s,o)",i,r,i);else{var s=!1;switch(t.type){case"double":case"float":e("d%s=o.json&&!isFinite(m%s)?String(m%s):m%s",i,i,i,i);break;case"uint64":s=!0;case"int64":case"sint64":case"fixed64":case"sfixed64":e('if(typeof m%s==="number")',i)("d%s=o.longs===String?String(m%s):m%s",i,i,i)("else")("d%s=o.longs===String?util.Long.prototype.toString.call(m%s):o.longs===Number?new util.LongBits(m%s.low>>>0,m%s.high>>>0).toNumber(%s):m%s",i,i,i,i,s?"true":"",i);break;case"bytes":e("d%s=o.bytes===String?util.base64.encode(m%s,0,m%s.length):o.bytes===Array?Array.prototype.slice.call(m%s):m%s",i,i,i,i,i);break;default:e("d%s=m%s",i,i)}}return e}i.fromObject=function(e){var t=e.fieldsArray,r=s.codegen(["d"],e.name+"$fromObject")("if(d instanceof this.ctor)")("return d");if(!t.length)return r("return new this.ctor");r("var m=new this.ctor");for(var i=0;i<t.length;++i){var o=t[i].resolve(),l=s.safeProp(o.name);o.map?(r("if(d%s){",l)('if(typeof d%s!=="object")',l)("throw TypeError(%j)",o.fullName+": object expected")("m%s={}",l)("for(var ks=Object.keys(d%s),i=0;i<ks.length;++i){",l),a(r,o,i,l+"[ks[i]]")("}")("}")):o.repeated?(r("if(d%s){",l)("if(!Array.isArray(d%s))",l)("throw TypeError(%j)",o.fullName+": array expected")("m%s=[]",l)("for(var i=0;i<d%s.length;++i){",l),a(r,o,i,l+"[i]")("}")("}")):(o.resolvedType instanceof n||r("if(d%s!=null){",l),a(r,o,i,l),o.resolvedType instanceof n||r("}"))}return r("return m")},i.toObject=function(e){var t=e.fieldsArray.slice().sort(s.compareFieldsById);if(!t.length)return s.codegen()("return {}");for(var r=s.codegen(["m","o"],e.name+"$toObject")("if(!o)")("o={}")("var d={}"),i=[],a=[],l=[],c=0;c<t.length;++c)t[c].partOf||(t[c].resolve().repeated?i:t[c].map?a:l).push(t[c]);if(i.length){for(r("if(o.arrays||o.defaults){"),c=0;c<i.length;++c)r("d%s=[]",s.safeProp(i[c].name));r("}")}if(a.length){for(r("if(o.objects||o.defaults){"),c=0;c<a.length;++c)r("d%s={}",s.safeProp(a[c].name));r("}")}if(l.length){for(r("if(o.defaults){"),c=0;c<l.length;++c){var u=l[c],h=s.safeProp(u.name);if(u.resolvedType instanceof n)r("d%s=o.enums===String?%j:%j",h,u.resolvedType.valuesById[u.typeDefault],u.typeDefault);else if(u.long)r("if(util.Long){")("var n=new util.Long(%i,%i,%j)",u.typeDefault.low,u.typeDefault.high,u.typeDefault.unsigned)("d%s=o.longs===String?n.toString():o.longs===Number?n.toNumber():n",h)("}else")("d%s=o.longs===String?%j:%i",h,u.typeDefault.toString(),u.typeDefault.toNumber());else if(u.bytes){var d="["+Array.prototype.slice.call(u.typeDefault).join(",")+"]";r("if(o.bytes===String)d%s=%j",h,String.fromCharCode.apply(String,u.typeDefault))("else{")("d%s=%s",h,d)("if(o.bytes!==Array)d%s=util.newBuffer(d%s)",h,h)("}")}else r("d%s=%j",h,u.typeDefault)}r("}")}var f=!1;for(c=0;c<t.length;++c){var u=t[c],p=e._fieldsArray.indexOf(u),h=s.safeProp(u.name);u.map?(f||(f=!0,r("var ks2")),r("if(m%s&&(ks2=Object.keys(m%s)).length){",h,h)("d%s={}",h)("for(var j=0;j<ks2.length;++j){"),o(r,u,p,h+"[ks2[j]]")("}")):u.repeated?(r("if(m%s&&m%s.length){",h,h)("d%s=[]",h)("for(var j=0;j<m%s.length;++j){",h),o(r,u,p,h+"[j]")("}")):(r("if(m%s!=null&&m.hasOwnProperty(%j)){",h,u.name),o(r,u,p,h),u.partOf&&r("if(o.oneofs)")("d%s=%j",s.safeProp(u.partOf.name),u.name)),r("}")}return r("return d")}},21531,(e,t,r)=>{"use strict";var i=r,n=e.r(3864);i[".google.protobuf.Any"]={fromObject:function(e){if(e&&e["@type"]){var t=e["@type"].substring(e["@type"].lastIndexOf("/")+1),r=this.lookup(t);if(r){var i="."===e["@type"].charAt(0)?e["@type"].slice(1):e["@type"];return -1===i.indexOf("/")&&(i="/"+i),this.create({type_url:i,value:r.encode(r.fromObject(e)).finish()})}}return this.fromObject(e)},toObject:function(e,t){var r="type.googleapis.com/",i="",s="";if(t&&t.json&&e.type_url&&e.value){s=e.type_url.substring(e.type_url.lastIndexOf("/")+1),i=e.type_url.substring(0,e.type_url.lastIndexOf("/")+1);var a=this.lookup(s);a&&(e=a.decode(e.value))}if(!(e instanceof this.ctor)&&e instanceof n){var o=e.$type.toObject(e,t),l="."===e.$type.fullName[0]?e.$type.fullName.slice(1):e.$type.fullName;return""===i&&(i=r),s=i+l,o["@type"]=s,o}return this.toObject(e,t)}}},65268,(e,t,r)=>{"use strict";t.exports=v;var i=e.r(85442);((v.prototype=Object.create(i.prototype)).constructor=v).className="Type";var n=e.r(27463),s=e.r(1769),a=e.r(845),o=e.r(74755),l=e.r(54392),c=e.r(3864),u=e.r(15303),h=e.r(50285),d=e.r(61863),f=e.r(42046),p=e.r(75416),m=e.r(78085),g=e.r(14005),y=e.r(21531);function v(e,t){i.call(this,e,t),this.fields={},this.oneofs=void 0,this.extensions=void 0,this.reserved=void 0,this.group=void 0,this._fieldsById=null,this._fieldsArray=null,this._oneofsArray=null,this._ctor=null}function b(e){return e._fieldsById=e._fieldsArray=e._oneofsArray=null,delete e.encode,delete e.decode,delete e.verify,e}Object.defineProperties(v.prototype,{fieldsById:{get:function(){if(this._fieldsById)return this._fieldsById;this._fieldsById={};for(var e=Object.keys(this.fields),t=0;t<e.length;++t){var r=this.fields[e[t]],i=r.id;if(this._fieldsById[i])throw Error("duplicate id "+i+" in "+this);this._fieldsById[i]=r}return this._fieldsById}},fieldsArray:{get:function(){return this._fieldsArray||(this._fieldsArray=d.toArray(this.fields))}},oneofsArray:{get:function(){return this._oneofsArray||(this._oneofsArray=d.toArray(this.oneofs))}},ctor:{get:function(){return this._ctor||(this.ctor=v.generateConstructor(this)())},set:function(e){var t=e.prototype;t instanceof c||((e.prototype=new c).constructor=e,d.merge(e.prototype,t)),e.$type=e.prototype.$type=this,d.merge(e,c,!0),this._ctor=e;for(var r=0;r<this.fieldsArray.length;++r)this._fieldsArray[r].resolve();var i={};for(r=0;r<this.oneofsArray.length;++r)i[this._oneofsArray[r].resolve().name]={get:d.oneOfGetter(this._oneofsArray[r].oneof),set:d.oneOfSetter(this._oneofsArray[r].oneof)};r&&Object.defineProperties(e.prototype,i)}}}),v.generateConstructor=function(e){for(var t,r=d.codegen(["p"],e.name),i=0;i<e.fieldsArray.length;++i)(t=e._fieldsArray[i]).map?r("this%s={}",d.safeProp(t.name)):t.repeated&&r("this%s=[]",d.safeProp(t.name));return r("if(p)for(var ks=Object.keys(p),i=0;i<ks.length;++i)if(p[ks[i]]!=null)")("this[ks[i]]=p[ks[i]]")},v.fromJSON=function(e,t){var r=new v(e,t.options);r.extensions=t.extensions,r.reserved=t.reserved;for(var c=Object.keys(t.fields),u=0;u<c.length;++u)r.add((void 0!==t.fields[c[u]].keyType?o.fromJSON:a.fromJSON)(c[u],t.fields[c[u]]));if(t.oneofs)for(c=Object.keys(t.oneofs),u=0;u<c.length;++u)r.add(s.fromJSON(c[u],t.oneofs[c[u]]));if(t.nested)for(c=Object.keys(t.nested),u=0;u<c.length;++u){var h=t.nested[c[u]];r.add((void 0!==h.id?a.fromJSON:void 0!==h.fields?v.fromJSON:void 0!==h.values?n.fromJSON:void 0!==h.methods?l.fromJSON:i.fromJSON)(c[u],h))}return t.extensions&&t.extensions.length&&(r.extensions=t.extensions),t.reserved&&t.reserved.length&&(r.reserved=t.reserved),t.group&&(r.group=!0),t.comment&&(r.comment=t.comment),t.edition&&(r._edition=t.edition),r._defaultEdition="proto3",r},v.prototype.toJSON=function(e){var t=i.prototype.toJSON.call(this,e),r=!!e&&!!e.keepComments;return d.toObject(["edition",this._editionToJSON(),"options",t&&t.options||void 0,"oneofs",i.arrayToJSON(this.oneofsArray,e),"fields",i.arrayToJSON(this.fieldsArray.filter(function(e){return!e.declaringField}),e)||{},"extensions",this.extensions&&this.extensions.length?this.extensions:void 0,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"group",this.group||void 0,"nested",t&&t.nested||void 0,"comment",r?this.comment:void 0])},v.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;i.prototype.resolveAll.call(this);var e=this.oneofsArray;for(r=0;r<e.length;)e[r++].resolve();for(var t=this.fieldsArray,r=0;r<t.length;)t[r++].resolve();return this},v.prototype._resolveFeaturesRecursive=function(e){return this._needsRecursiveFeatureResolution&&(e=this._edition||e,i.prototype._resolveFeaturesRecursive.call(this,e),this.oneofsArray.forEach(t=>{t._resolveFeatures(e)}),this.fieldsArray.forEach(t=>{t._resolveFeatures(e)})),this},v.prototype.get=function(e){return this.fields[e]||this.oneofs&&this.oneofs[e]||this.nested&&this.nested[e]||null},v.prototype.add=function(e){if(this.get(e.name))throw Error("duplicate name '"+e.name+"' in "+this);if(e instanceof a&&void 0===e.extend){if(this._fieldsById?this._fieldsById[e.id]:this.fieldsById[e.id])throw Error("duplicate id "+e.id+" in "+this);if(this.isReservedId(e.id))throw Error("id "+e.id+" is reserved in "+this);if(this.isReservedName(e.name))throw Error("name '"+e.name+"' is reserved in "+this);return e.parent&&e.parent.remove(e),this.fields[e.name]=e,e.message=this,e.onAdd(this),b(this)}return e instanceof s?(this.oneofs||(this.oneofs={}),this.oneofs[e.name]=e,e.onAdd(this),b(this)):i.prototype.add.call(this,e)},v.prototype.remove=function(e){if(e instanceof a&&void 0===e.extend){if(!this.fields||this.fields[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.fields[e.name],e.parent=null,e.onRemove(this),b(this)}if(e instanceof s){if(!this.oneofs||this.oneofs[e.name]!==e)throw Error(e+" is not a member of "+this);return delete this.oneofs[e.name],e.parent=null,e.onRemove(this),b(this)}return i.prototype.remove.call(this,e)},v.prototype.isReservedId=function(e){return i.isReservedId(this.reserved,e)},v.prototype.isReservedName=function(e){return i.isReservedName(this.reserved,e)},v.prototype.create=function(e){return new this.ctor(e)},v.prototype.setup=function(){for(var e=this.fullName,t=[],r=0;r<this.fieldsArray.length;++r)t.push(this._fieldsArray[r].resolve().resolvedType);this.encode=f(this)({Writer:h,types:t,util:d}),this.decode=p(this)({Reader:u,types:t,util:d}),this.verify=m(this)({types:t,util:d}),this.fromObject=g.fromObject(this)({types:t,util:d}),this.toObject=g.toObject(this)({types:t,util:d});var i=y[e];if(i){var n=Object.create(this);n.fromObject=this.fromObject,this.fromObject=i.fromObject.bind(n),n.toObject=this.toObject,this.toObject=i.toObject.bind(n)}return this},v.prototype.encode=function(e,t){return this.setup().encode(e,t)},v.prototype.encodeDelimited=function(e,t){return this.encode(e,t&&t.len?t.fork():t).ldelim()},v.prototype.decode=function(e,t){return this.setup().decode(e,t)},v.prototype.decodeDelimited=function(e){return e instanceof u||(e=u.create(e)),this.decode(e,e.uint32())},v.prototype.verify=function(e){return this.setup().verify(e)},v.prototype.fromObject=function(e){return this.setup().fromObject(e)},v.prototype.toObject=function(e,t){return this.setup().toObject(e,t)},v.d=function(e){return function(t){d.decorateType(t,e)}}},78465,(e,t,r)=>{"use strict";t.exports=h;var i,n,s,a=e.r(85442);((h.prototype=Object.create(a.prototype)).constructor=h).className="Root";var o=e.r(845),l=e.r(27463),c=e.r(1769),u=e.r(61863);function h(e){a.call(this,"",e),this.deferred=[],this.files=[],this._edition="proto2",this._fullyQualifiedObjects={}}function d(){}h.fromJSON=function(e,t){return t||(t=new h),e.options&&t.setOptions(e.options),t.addJSON(e.nested).resolveAll()},h.prototype.resolvePath=u.path.resolve,h.prototype.fetch=u.fetch,h.prototype.load=function e(t,r,i){"function"==typeof r&&(i=r,r=void 0);var a=this;if(!i)return u.asPromise(e,a,t,r);var o=i===d;function l(e,t){if(i){if(o)throw e;t&&t.resolveAll();var r=i;i=null,r(e,t)}}function c(e){var t=e.lastIndexOf("google/protobuf/");if(t>-1){var r=e.substring(t);if(r in s)return r}return null}function h(e,t){try{if(u.isString(t)&&"{"===t.charAt(0)&&(t=JSON.parse(t)),u.isString(t)){n.filename=e;var i,s=n(t,a,r),h=0;if(s.imports)for(;h<s.imports.length;++h)(i=c(s.imports[h])||a.resolvePath(e,s.imports[h]))&&f(i);if(s.weakImports)for(h=0;h<s.weakImports.length;++h)(i=c(s.weakImports[h])||a.resolvePath(e,s.weakImports[h]))&&f(i,!0)}else a.setOptions(t.options).addJSON(t.nested)}catch(e){l(e)}o||p||l(null,a)}function f(e,t){if(e=c(e)||e,!(a.files.indexOf(e)>-1)){if(a.files.push(e),e in s)return void(o?h(e,s[e]):(++p,setTimeout(function(){--p,h(e,s[e])})));if(o){var r;try{r=u.fs.readFileSync(e).toString("utf8")}catch(e){t||l(e);return}h(e,r)}else++p,a.fetch(e,function(r,n){if(--p,i){if(r)return void(t?p||l(null,a):l(r));h(e,n)}})}}var p=0;u.isString(t)&&(t=[t]);for(var m,g=0;g<t.length;++g)(m=a.resolvePath("",t[g]))&&f(m);return o?a.resolveAll():p||l(null,a),a},h.prototype.loadSync=function(e,t){if(!u.isNode)throw Error("not supported");return this.load(e,t,d)},h.prototype.resolveAll=function(){if(!this._needsRecursiveResolve)return this;if(this.deferred.length)throw Error("unresolvable extensions: "+this.deferred.map(function(e){return"'extend "+e.extend+"' in "+e.parent.fullName}).join(", "));return a.prototype.resolveAll.call(this)};var f=/^[A-Z]/;function p(e,t){var r=t.parent.lookup(t.extend);if(r){var i=new o(t.fullName,t.id,t.type,t.rule,void 0,t.options);return!!r.get(i.name)||(i.declaringField=t,t.extensionField=i,r.add(i),!0)}return!1}h.prototype._handleAdd=function(e){if(e instanceof o)void 0===e.extend||e.extensionField||p(this,e)||this.deferred.push(e);else if(e instanceof l)f.test(e.name)&&(e.parent[e.name]=e.values);else if(!(e instanceof c)){if(e instanceof i)for(var t=0;t<this.deferred.length;)p(this,this.deferred[t])?this.deferred.splice(t,1):++t;for(var r=0;r<e.nestedArray.length;++r)this._handleAdd(e._nestedArray[r]);f.test(e.name)&&(e.parent[e.name]=e)}(e instanceof i||e instanceof l||e instanceof o)&&(this._fullyQualifiedObjects[e.fullName]=e)},h.prototype._handleRemove=function(e){if(e instanceof o){if(void 0!==e.extend)if(e.extensionField)e.extensionField.parent.remove(e.extensionField),e.extensionField=null;else{var t=this.deferred.indexOf(e);t>-1&&this.deferred.splice(t,1)}}else if(e instanceof l)f.test(e.name)&&delete e.parent[e.name];else if(e instanceof a){for(var r=0;r<e.nestedArray.length;++r)this._handleRemove(e._nestedArray[r]);f.test(e.name)&&delete e.parent[e.name]}delete this._fullyQualifiedObjects[e.fullName]},h._configure=function(e,t,r){i=e,n=t,s=r}},61863,(e,t,r)=>{"use strict";var i,n,s=t.exports=e.r(30005),a=e.r(72705);s.codegen=e.r(45618),s.fetch=e.r(45364),s.path=e.r(67074),s.fs=s.inquire("fs"),s.toArray=function(e){if(e){for(var t=Object.keys(e),r=Array(t.length),i=0;i<t.length;)r[i]=e[t[i++]];return r}return[]},s.toObject=function(e){for(var t={},r=0;r<e.length;){var i=e[r++],n=e[r++];void 0!==n&&(t[i]=n)}return t};var o=/\\/g,l=/"/g;s.isReserved=function(e){return/^(?:do|if|in|for|let|new|try|var|case|else|enum|eval|false|null|this|true|void|with|break|catch|class|const|super|throw|while|yield|delete|export|import|public|return|static|switch|typeof|default|extends|finally|package|private|continue|debugger|function|arguments|interface|protected|implements|instanceof)$/.test(e)},s.safeProp=function(e){return!/^[$\w_]+$/.test(e)||s.isReserved(e)?'["'+e.replace(o,"\\\\").replace(l,'\\"')+'"]':"."+e},s.ucFirst=function(e){return e.charAt(0).toUpperCase()+e.substring(1)};var c=/_([a-z])/g;s.camelCase=function(e){return e.substring(0,1)+e.substring(1).replace(c,function(e,t){return t.toUpperCase()})},s.compareFieldsById=function(e,t){return e.id-t.id},s.decorateType=function(t,r){if(t.$type)return r&&t.$type.name!==r&&(s.decorateRoot.remove(t.$type),t.$type.name=r,s.decorateRoot.add(t.$type)),t.$type;i||(i=e.r(65268));var n=new i(r||t.name);return s.decorateRoot.add(n),n.ctor=t,Object.defineProperty(t,"$type",{value:n,enumerable:!1}),Object.defineProperty(t.prototype,"$type",{value:n,enumerable:!1}),n};var u=0;s.decorateEnum=function(t){if(t.$type)return t.$type;n||(n=e.r(27463));var r=new n("Enum"+u++,t);return s.decorateRoot.add(r),Object.defineProperty(t,"$type",{value:r,enumerable:!1}),r},s.setProperty=function(e,t,r,i){function n(e,t,r){var s=t.shift();if("__proto__"===s||"prototype"===s)return e;if(t.length>0)e[s]=n(e[s]||{},t,r);else{var a=e[s];if(a&&i)return e;a&&(r=[].concat(a).concat(r)),e[s]=r}return e}if("object"!=typeof e)throw TypeError("dst must be an object");if(!t)throw TypeError("path must be specified");return n(e,t=t.split("."),r)},Object.defineProperty(s,"decorateRoot",{get:function(){return a.decorated||(a.decorated=new(e.r(78465)))}})},93145,(e,t,r)=>{"use strict";var i=r,n=e.r(61863),s=["double","float","int32","uint32","sint32","fixed32","sfixed32","int64","uint64","sint64","fixed64","sfixed64","bool","string","bytes"];function a(e,t){var r=0,i={};for(t|=0;r<e.length;)i[s[r+t]]=e[r++];return i}i.basic=a([1,5,0,0,0,5,5,0,0,0,1,1,0,2,2]),i.defaults=a([0,0,0,0,0,0,0,0,0,0,0,0,!1,"",n.emptyArray,null]),i.long=a([0,0,0,1,1],7),i.mapKey=a([0,0,0,5,5,0,0,0,1,1,0,2],2),i.packed=a([1,5,0,0,0,5,5,0,0,0,1,1,0])},845,(e,t,r)=>{"use strict";t.exports=c;var i,n=e.r(90844);((c.prototype=Object.create(n.prototype)).constructor=c).className="Field";var s=e.r(27463),a=e.r(93145),o=e.r(61863),l=/^required|optional|repeated$/;function c(e,t,r,i,s,c,u){if(o.isObject(i)?(u=s,c=i,i=s=void 0):o.isObject(s)&&(u=c,c=s,s=void 0),n.call(this,e,c),!o.isInteger(t)||t<0)throw TypeError("id must be a non-negative integer");if(!o.isString(r))throw TypeError("type must be a string");if(void 0!==i&&!l.test(i=i.toString().toLowerCase()))throw TypeError("rule must be a string rule");if(void 0!==s&&!o.isString(s))throw TypeError("extend must be a string");"proto3_optional"===i&&(i="optional"),this.rule=i&&"optional"!==i?i:void 0,this.type=r,this.id=t,this.extend=s||void 0,this.repeated="repeated"===i,this.map=!1,this.message=null,this.partOf=null,this.typeDefault=null,this.defaultValue=null,this.long=!!o.Long&&void 0!==a.long[r],this.bytes="bytes"===r,this.resolvedType=null,this.extensionField=null,this.declaringField=null,this.comment=u}c.fromJSON=function(e,t){var r=new c(e,t.id,t.type,t.rule,t.extend,t.options,t.comment);return t.edition&&(r._edition=t.edition),r._defaultEdition="proto3",r},Object.defineProperty(c.prototype,"required",{get:function(){return"LEGACY_REQUIRED"===this._features.field_presence}}),Object.defineProperty(c.prototype,"optional",{get:function(){return!this.required}}),Object.defineProperty(c.prototype,"delimited",{get:function(){return this.resolvedType instanceof i&&"DELIMITED"===this._features.message_encoding}}),Object.defineProperty(c.prototype,"packed",{get:function(){return"PACKED"===this._features.repeated_field_encoding}}),Object.defineProperty(c.prototype,"hasPresence",{get:function(){return!this.repeated&&!this.map&&(this.partOf||this.declaringField||this.extensionField||"IMPLICIT"!==this._features.field_presence)}}),c.prototype.setOption=function(e,t,r){return n.prototype.setOption.call(this,e,t,r)},c.prototype.toJSON=function(e){var t=!!e&&!!e.keepComments;return o.toObject(["edition",this._editionToJSON(),"rule","optional"!==this.rule&&this.rule||void 0,"type",this.type,"id",this.id,"extend",this.extend,"options",this.options,"comment",t?this.comment:void 0])},c.prototype.resolve=function(){if(this.resolved)return this;if(void 0===(this.typeDefault=a.defaults[this.type])?(this.resolvedType=(this.declaringField?this.declaringField.parent:this.parent).lookupTypeOrEnum(this.type),this.resolvedType instanceof i?this.typeDefault=null:this.typeDefault=this.resolvedType.values[Object.keys(this.resolvedType.values)[0]]):this.options&&this.options.proto3_optional&&(this.typeDefault=null),this.options&&null!=this.options.default&&(this.typeDefault=this.options.default,this.resolvedType instanceof s&&"string"==typeof this.typeDefault&&(this.typeDefault=this.resolvedType.values[this.typeDefault])),this.options&&(void 0===this.options.packed||!this.resolvedType||this.resolvedType instanceof s||delete this.options.packed,Object.keys(this.options).length||(this.options=void 0)),this.long)this.typeDefault=o.Long.fromNumber(this.typeDefault,"u"===this.type.charAt(0)),Object.freeze&&Object.freeze(this.typeDefault);else if(this.bytes&&"string"==typeof this.typeDefault){var e;o.base64.test(this.typeDefault)?o.base64.decode(this.typeDefault,e=o.newBuffer(o.base64.length(this.typeDefault)),0):o.utf8.write(this.typeDefault,e=o.newBuffer(o.utf8.length(this.typeDefault)),0),this.typeDefault=e}return this.map?this.defaultValue=o.emptyObject:this.repeated?this.defaultValue=o.emptyArray:this.defaultValue=this.typeDefault,this.parent instanceof i&&(this.parent.ctor.prototype[this.name]=this.defaultValue),n.prototype.resolve.call(this)},c.prototype._inferLegacyProtoFeatures=function(e){if("proto2"!==e&&"proto3"!==e)return{};var t={};if("required"===this.rule&&(t.field_presence="LEGACY_REQUIRED"),this.parent&&void 0===a.defaults[this.type]){var r=this.parent.get(this.type.split(".").pop());r&&r instanceof i&&r.group&&(t.message_encoding="DELIMITED")}return!0===this.getOption("packed")?t.repeated_field_encoding="PACKED":!1===this.getOption("packed")&&(t.repeated_field_encoding="EXPANDED"),t},c.prototype._resolveFeatures=function(e){return n.prototype._resolveFeatures.call(this,this._edition||e)},c.d=function(e,t,r,i){return"function"==typeof t?t=o.decorateType(t).name:t&&"object"==typeof t&&(t=o.decorateEnum(t).name),function(n,s){o.decorateType(n.constructor).add(new c(s,e,t,r,{default:i}))}},c._configure=function(e){i=e}},1769,(e,t,r)=>{"use strict";t.exports=a;var i=e.r(90844);((a.prototype=Object.create(i.prototype)).constructor=a).className="OneOf";var n=e.r(845),s=e.r(61863);function a(e,t,r,n){if(Array.isArray(t)||(r=t,t=void 0),i.call(this,e,r),!(void 0===t||Array.isArray(t)))throw TypeError("fieldNames must be an Array");this.oneof=t||[],this.fieldsArray=[],this.comment=n}function o(e){if(e.parent)for(var t=0;t<e.fieldsArray.length;++t)e.fieldsArray[t].parent||e.parent.add(e.fieldsArray[t])}a.fromJSON=function(e,t){return new a(e,t.oneof,t.options,t.comment)},a.prototype.toJSON=function(e){var t=!!e&&!!e.keepComments;return s.toObject(["options",this.options,"oneof",this.oneof,"comment",t?this.comment:void 0])},a.prototype.add=function(e){if(!(e instanceof n))throw TypeError("field must be a Field");return e.parent&&e.parent!==this.parent&&e.parent.remove(e),this.oneof.push(e.name),this.fieldsArray.push(e),e.partOf=this,o(this),this},a.prototype.remove=function(e){if(!(e instanceof n))throw TypeError("field must be a Field");var t=this.fieldsArray.indexOf(e);if(t<0)throw Error(e+" is not a member of "+this);return this.fieldsArray.splice(t,1),(t=this.oneof.indexOf(e.name))>-1&&this.oneof.splice(t,1),e.partOf=null,this},a.prototype.onAdd=function(e){i.prototype.onAdd.call(this,e);for(var t=this,r=0;r<this.oneof.length;++r){var n=e.get(this.oneof[r]);n&&!n.partOf&&(n.partOf=t,t.fieldsArray.push(n))}o(this)},a.prototype.onRemove=function(e){for(var t,r=0;r<this.fieldsArray.length;++r)(t=this.fieldsArray[r]).parent&&t.parent.remove(t);i.prototype.onRemove.call(this,e)},Object.defineProperty(a.prototype,"isProto3Optional",{get:function(){if(null==this.fieldsArray||1!==this.fieldsArray.length)return!1;var e=this.fieldsArray[0];return null!=e.options&&!0===e.options.proto3_optional}}),a.d=function(){for(var e=Array(arguments.length),t=0;t<arguments.length;)e[t]=arguments[t++];return function(t,r){s.decorateType(t.constructor).add(new a(r,e)),Object.defineProperty(t,r,{get:s.oneOfGetter(e),set:s.oneOfSetter(e)})}}},90844,(e,t,r)=>{"use strict";t.exports=c,c.className="ReflectionObject";let i=e.r(1769);var n,s=e.r(61863),a={enum_type:"OPEN",field_presence:"EXPLICIT",json_format:"ALLOW",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"PACKED",utf8_validation:"VERIFY"},o={enum_type:"CLOSED",field_presence:"EXPLICIT",json_format:"LEGACY_BEST_EFFORT",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"EXPANDED",utf8_validation:"NONE"},l={enum_type:"OPEN",field_presence:"IMPLICIT",json_format:"ALLOW",message_encoding:"LENGTH_PREFIXED",repeated_field_encoding:"PACKED",utf8_validation:"VERIFY"};function c(e,t){if(!s.isString(e))throw TypeError("name must be a string");if(t&&!s.isObject(t))throw TypeError("options must be an object");this.options=t,this.parsedOptions=null,this.name=e,this._edition=null,this._defaultEdition="proto2",this._features={},this._featuresResolved=!1,this.parent=null,this.resolved=!1,this.comment=null,this.filename=null}Object.defineProperties(c.prototype,{root:{get:function(){for(var e=this;null!==e.parent;)e=e.parent;return e}},fullName:{get:function(){for(var e=[this.name],t=this.parent;t;)e.unshift(t.name),t=t.parent;return e.join(".")}}}),c.prototype.toJSON=function(){throw Error()},c.prototype.onAdd=function(e){this.parent&&this.parent!==e&&this.parent.remove(this),this.parent=e,this.resolved=!1;var t=e.root;t instanceof n&&t._handleAdd(this)},c.prototype.onRemove=function(e){var t=e.root;t instanceof n&&t._handleRemove(this),this.parent=null,this.resolved=!1},c.prototype.resolve=function(){return this.resolved||this.root instanceof n&&(this.resolved=!0),this},c.prototype._resolveFeaturesRecursive=function(e){return this._resolveFeatures(this._edition||e)},c.prototype._resolveFeatures=function(e){if(!this._featuresResolved){var t={};if(!e)throw Error("Unknown edition for "+this.fullName);var r=Object.assign(this.options?Object.assign({},this.options.features):{},this._inferLegacyProtoFeatures(e));if(this._edition){if("proto2"===e)t=Object.assign({},o);else if("proto3"===e)t=Object.assign({},l);else if("2023"===e)t=Object.assign({},a);else throw Error("Unknown edition: "+e);this._features=Object.assign(t,r||{}),this._featuresResolved=!0;return}if(this.partOf instanceof i){var n=Object.assign({},this.partOf._features);this._features=Object.assign(n,r||{})}else if(this.declaringField);else if(this.parent){var s=Object.assign({},this.parent._features);this._features=Object.assign(s,r||{})}else throw Error("Unable to find a parent for "+this.fullName);this.extensionField&&(this.extensionField._features=this._features),this._featuresResolved=!0}},c.prototype._inferLegacyProtoFeatures=function(){return{}},c.prototype.getOption=function(e){if(this.options)return this.options[e]},c.prototype.setOption=function(e,t,r){return this.options||(this.options={}),/^features\./.test(e)?s.setProperty(this.options,e,t,r):r&&void 0!==this.options[e]||(this.getOption(e)!==t&&(this.resolved=!1),this.options[e]=t),this},c.prototype.setParsedOption=function(e,t,r){this.parsedOptions||(this.parsedOptions=[]);var i=this.parsedOptions;if(r){var n=i.find(function(t){return Object.prototype.hasOwnProperty.call(t,e)});if(n){var a=n[e];s.setProperty(a,r,t)}else(n={})[e]=s.setProperty({},r,t),i.push(n)}else{var o={};o[e]=t,i.push(o)}return this},c.prototype.setOptions=function(e,t){if(e)for(var r=Object.keys(e),i=0;i<r.length;++i)this.setOption(r[i],e[r[i]],t);return this},c.prototype.toString=function(){var e=this.constructor.className,t=this.fullName;return t.length?e+" "+t:e},c.prototype._editionToJSON=function(){if(this._edition&&"proto3"!==this._edition)return this._edition},c._configure=function(e){n=e}},27463,(e,t,r)=>{"use strict";t.exports=a;var i=e.r(90844);((a.prototype=Object.create(i.prototype)).constructor=a).className="Enum";var n=e.r(85442),s=e.r(61863);function a(e,t,r,n,s,a){if(i.call(this,e,r),t&&"object"!=typeof t)throw TypeError("values must be an object");if(this.valuesById={},this.values=Object.create(this.valuesById),this.comment=n,this.comments=s||{},this.valuesOptions=a,this._valuesFeatures={},this.reserved=void 0,t)for(var o=Object.keys(t),l=0;l<o.length;++l)"number"==typeof t[o[l]]&&(this.valuesById[this.values[o[l]]=t[o[l]]]=o[l])}a.prototype._resolveFeatures=function(e){return e=this._edition||e,i.prototype._resolveFeatures.call(this,e),Object.keys(this.values).forEach(e=>{var t=Object.assign({},this._features);this._valuesFeatures[e]=Object.assign(t,this.valuesOptions&&this.valuesOptions[e]&&this.valuesOptions[e].features)}),this},a.fromJSON=function(e,t){var r=new a(e,t.values,t.options,t.comment,t.comments);return r.reserved=t.reserved,t.edition&&(r._edition=t.edition),r._defaultEdition="proto3",r},a.prototype.toJSON=function(e){var t=!!e&&!!e.keepComments;return s.toObject(["edition",this._editionToJSON(),"options",this.options,"valuesOptions",this.valuesOptions,"values",this.values,"reserved",this.reserved&&this.reserved.length?this.reserved:void 0,"comment",t?this.comment:void 0,"comments",t?this.comments:void 0])},a.prototype.add=function(e,t,r,i){if(!s.isString(e))throw TypeError("name must be a string");if(!s.isInteger(t))throw TypeError("id must be an integer");if(void 0!==this.values[e])throw Error("duplicate name '"+e+"' in "+this);if(this.isReservedId(t))throw Error("id "+t+" is reserved in "+this);if(this.isReservedName(e))throw Error("name '"+e+"' is reserved in "+this);if(void 0!==this.valuesById[t]){if(!(this.options&&this.options.allow_alias))throw Error("duplicate id "+t+" in "+this);this.values[e]=t}else this.valuesById[this.values[e]=t]=e;return i&&(void 0===this.valuesOptions&&(this.valuesOptions={}),this.valuesOptions[e]=i||null),this.comments[e]=r||null,this},a.prototype.remove=function(e){if(!s.isString(e))throw TypeError("name must be a string");var t=this.values[e];if(null==t)throw Error("name '"+e+"' does not exist in "+this);return delete this.valuesById[t],delete this.values[e],delete this.comments[e],this.valuesOptions&&delete this.valuesOptions[e],this},a.prototype.isReservedId=function(e){return n.isReservedId(this.reserved,e)},a.prototype.isReservedName=function(e){return n.isReservedName(this.reserved,e)}},42046,(e,t,r)=>{"use strict";t.exports=o;var i=e.r(27463),n=e.r(93145),s=e.r(61863);function a(e,t,r,i){return t.delimited?e("types[%i].encode(%s,w.uint32(%i)).uint32(%i)",r,i,(t.id<<3|3)>>>0,(t.id<<3|4)>>>0):e("types[%i].encode(%s,w.uint32(%i).fork()).ldelim()",r,i,(t.id<<3|2)>>>0)}function o(e){for(var t,r,o=s.codegen(["m","w"],e.name+"$encode")("if(!w)")("w=Writer.create()"),l=e.fieldsArray.slice().sort(s.compareFieldsById),t=0;t<l.length;++t){var c=l[t].resolve(),u=e._fieldsArray.indexOf(c),h=c.resolvedType instanceof i?"int32":c.type,d=n.basic[h];r="m"+s.safeProp(c.name),c.map?(o("if(%s!=null&&Object.hasOwnProperty.call(m,%j)){",r,c.name)("for(var ks=Object.keys(%s),i=0;i<ks.length;++i){",r)("w.uint32(%i).fork().uint32(%i).%s(ks[i])",(c.id<<3|2)>>>0,8|n.mapKey[c.keyType],c.keyType),void 0===d?o("types[%i].encode(%s[ks[i]],w.uint32(18).fork()).ldelim().ldelim()",u,r):o(".uint32(%i).%s(%s[ks[i]]).ldelim()",16|d,h,r),o("}")("}")):c.repeated?(o("if(%s!=null&&%s.length){",r,r),c.packed&&void 0!==n.packed[h]?o("w.uint32(%i).fork()",(c.id<<3|2)>>>0)("for(var i=0;i<%s.length;++i)",r)("w.%s(%s[i])",h,r)("w.ldelim()"):(o("for(var i=0;i<%s.length;++i)",r),void 0===d?a(o,c,u,r+"[i]"):o("w.uint32(%i).%s(%s[i])",(c.id<<3|d)>>>0,h,r)),o("}")):(c.optional&&o("if(%s!=null&&Object.hasOwnProperty.call(m,%j))",r,c.name),void 0===d?a(o,c,u,r):o("w.uint32(%i).%s(%s)",(c.id<<3|d)>>>0,h,r))}return o("return w")}},57027,(e,t,r)=>{"use strict";t.exports=s;var i=e.r(50285);(s.prototype=Object.create(i.prototype)).constructor=s;var n=e.r(30005);function s(){i.call(this)}function a(e,t,r){e.length<40?n.utf8.write(e,t,r):t.utf8Write?t.utf8Write(e,r):t.write(e,r)}s._configure=function(){s.alloc=n._Buffer_allocUnsafe,s.writeBytesBuffer=n.Buffer&&n.Buffer.prototype instanceof Uint8Array&&"set"===n.Buffer.prototype.set.name?function(e,t,r){t.set(e,r)}:function(e,t,r){if(e.copy)e.copy(t,r,0,e.length);else for(var i=0;i<e.length;)t[r++]=e[i++]}},s.prototype.bytes=function(e){n.isString(e)&&(e=n._Buffer_from(e,"base64"));var t=e.length>>>0;return this.uint32(t),t&&this._push(s.writeBytesBuffer,t,e),this},s.prototype.string=function(e){var t=n.Buffer.byteLength(e);return this.uint32(t),t&&this._push(a,t,e),this},s._configure()},22083,(e,t,r)=>{"use strict";t.exports=s;var i=e.r(15303);(s.prototype=Object.create(i.prototype)).constructor=s;var n=e.r(30005);function s(e){i.call(this,e)}s._configure=function(){n.Buffer&&(s.prototype._slice=n.Buffer.prototype.slice)},s.prototype.string=function(){var e=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+e,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+e,this.len))},s._configure()},67340,(e,t,r)=>{"use strict";var i=r;function n(){i.util._configure(),i.Writer._configure(i.BufferWriter),i.Reader._configure(i.BufferReader)}i.build="minimal",i.Writer=e.r(50285),i.BufferWriter=e.r(57027),i.Reader=e.r(15303),i.BufferReader=e.r(22083),i.util=e.r(30005),i.rpc=e.r(74521),i.roots=e.r(72705),i.configure=n,n()},16716,(e,t,r)=>{"use strict";var i=t.exports=e.r(67340);function n(e,t,r){return"function"==typeof t?(r=t,t=new i.Root):t||(t=new i.Root),t.load(e,r)}function s(e,t){return t||(t=new i.Root),t.loadSync(e)}i.build="light",i.load=n,i.loadSync=s,i.encoder=e.r(42046),i.decoder=e.r(75416),i.verifier=e.r(78085),i.converter=e.r(14005),i.ReflectionObject=e.r(90844),i.Namespace=e.r(85442),i.Root=e.r(78465),i.Enum=e.r(27463),i.Type=e.r(65268),i.Field=e.r(845),i.OneOf=e.r(1769),i.MapField=e.r(74755),i.Service=e.r(54392),i.Method=e.r(51212),i.Message=e.r(3864),i.wrappers=e.r(21531),i.types=e.r(93145),i.util=e.r(61863),i.ReflectionObject._configure(i.Root),i.Namespace._configure(i.Type,i.Service,i.Enum),i.Root._configure(i.Type),i.Field._configure(i.Type)},89325,(e,t,r)=>{"use strict";t.exports=f;var i=/[\s{}=;:[\],'"()<>]/g,n=/(?:"([^"\\]*(?:\\.[^"\\]*)*)")/g,s=/(?:'([^'\\]*(?:\\.[^'\\]*)*)')/g,a=/^ *[*/]+ */,o=/^\s*\*?\/*/,l=/\n/g,c=/\s/,u=/\\(.?)/g,h={0:"\0",r:"\r",n:"\n",t:"	"};function d(e){return e.replace(u,function(e,t){switch(t){case"\\":case"":return t;default:return h[t]||""}})}function f(e,t){e=e.toString();var r=0,u=e.length,h=1,f=0,p={},m=[],g=null;function y(e){return Error("illegal "+e+" (line "+h+")")}function v(){var t="'"===g?s:n;t.lastIndex=r-1;var i=t.exec(e);if(!i)throw y("string");return r=t.lastIndex,_(g),g=null,d(i[1])}function b(t){return e.charAt(t)}function S(r,i,n){var s,c={type:e.charAt(r++),lineEmpty:!1,leading:n},u=r-(t?2:3);do if(--u<0||"\n"===(s=e.charAt(u))){c.lineEmpty=!0;break}while(" "===s||"	"===s)for(var d=e.substring(r,i).split(l),m=0;m<d.length;++m)d[m]=d[m].replace(t?o:a,"").trim();c.text=d.join("\n").trim(),p[h]=c,f=h}function C(t){var r=T(t),i=e.substring(t,r);return/^\s*\/\//.test(i)}function T(e){for(var t=e;t<u&&"\n"!==b(t);)t++;return t}function E(){if(m.length>0)return m.shift();if(g)return v();var n,s,a,o,l,d=0===r;do{if(r===u)return null;for(n=!1;c.test(a=b(r));)if("\n"===a&&(d=!0,++h),++r===u)return null;if("/"===b(r)){if(++r===u)throw y("comment");if("/"===b(r))if(t){if(o=r,l=!1,C(r-1)){l=!0;do if((r=T(r))===u||(r++,!d))break;while(C(r))}else r=Math.min(u,T(r)+1);l&&(S(o,r,d),d=!0),h++,n=!0}else{for(l="/"===b(o=r+1);"\n"!==b(++r);)if(r===u)return null;++r,l&&(S(o,r-1,d),d=!0),++h,n=!0}else{if("*"!==(a=b(r)))return"/";o=r+1,l=t||"*"===b(o);do{if("\n"===a&&++h,++r===u)throw y("comment");s=a,a=b(r)}while("*"!==s||"/"!==a)++r,l&&(S(o,r-2,d),d=!0),n=!0}}}while(n)var f=r;if(i.lastIndex=0,!i.test(b(f++)))for(;f<u&&!i.test(b(f));)++f;var p=e.substring(r,r=f);return('"'===p||"'"===p)&&(g=p),p}function _(e){m.push(e)}function w(){if(!m.length){var e=E();if(null===e)return null;_(e)}return m[0]}function R(e,t){var r=w();if(r===e)return E(),!0;if(!t)throw y("token '"+r+"', '"+e+"' expected");return!1}function k(e){var r,i=null;return void 0===e?(r=p[h-1],delete p[h-1],r&&(t||"*"===r.type||r.lineEmpty)&&(i=r.leading?r.text:null)):(f<e&&w(),r=p[e],delete p[e],r&&!r.lineEmpty&&(t||"/"===r.type)&&(i=r.leading?null:r.text)),i}return Object.defineProperty({next:E,peek:w,push:_,skip:R,cmnt:k},"line",{get:function(){return h}})}f.unescape=d},60265,(e,t,r)=>{"use strict";t.exports=_,_.filename=null,_.defaults={keepCase:!1};var i=e.r(89325),n=e.r(78465),s=e.r(65268),a=e.r(845),o=e.r(74755),l=e.r(1769),c=e.r(27463),u=e.r(54392),h=e.r(51212),d=e.r(90844),f=e.r(93145),p=e.r(61863),m=/^[1-9][0-9]*$/,g=/^-?[1-9][0-9]*$/,y=/^0[x][0-9a-fA-F]+$/,v=/^-?0[x][0-9a-fA-F]+$/,b=/^0[0-7]+$/,S=/^-?0[0-7]+$/,C=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/,T=/^[a-zA-Z_][a-zA-Z_0-9]*$/,E=/^(?:\.?[a-zA-Z_][a-zA-Z_0-9]*)(?:\.[a-zA-Z_][a-zA-Z_0-9]*)*$/;function _(e,t,r){t instanceof n||(r=t,t=new n),r||(r=_.defaults);var w,R,k,A,I=r.preferTrailingComment||!1,O=i(e,r.alternateCommentMode||!1),N=O.next,x=O.push,D=O.peek,P=O.skip,M=O.cmnt,L=!0,F="proto2",B=t,j=[],U={},V=r.keepCase?function(e){return e}:p.camelCase;function z(){j.forEach(e=>{e._edition=F,Object.keys(U).forEach(t=>{void 0===e.getOption(t)&&e.setOption(t,U[t],!0)})})}function q(e,t,r){var i=_.filename;return r||(_.filename=null),Error("illegal "+(t||"token")+" '"+e+"' ("+(i?i+", ":"")+"line "+O.line+")")}function $(){var e,t=[];do{if('"'!==(e=N())&&"'"!==e)throw q(e);t.push(N()),P(e),e=D()}while('"'===e||"'"===e)return t.join("")}function H(e){var t=N();switch(t){case"'":case'"':return x(t),$();case"true":case"TRUE":return!0;case"false":case"FALSE":return!1}try{return G(t,!0)}catch(r){if(e&&E.test(t))return t;throw q(t,"value")}}function W(e,t){do if(t&&('"'===(r=D())||"'"===r)){var r,i,n=$();if(e.push(n),F>=2023)throw q(n,"id")}else try{e.push([i=Q(N()),P("to",!0)?Q(N()):i])}catch(i){if(t&&E.test(r)&&F>=2023)e.push(r);else throw i}while(P(",",!0))var s={options:void 0};s.setOption=function(e,t){void 0===this.options&&(this.options={}),this.options[e]=t},ee(s,function(e){if("option"===e)el(s,e),P(";");else throw q(e)},function(){ed(s)})}function G(e,t){var r=1;switch("-"===e.charAt(0)&&(r=-1,e=e.substring(1)),e){case"inf":case"INF":case"Inf":return 1/0*r;case"nan":case"NAN":case"Nan":case"NaN":return NaN;case"0":return 0}if(m.test(e))return r*parseInt(e,10);if(y.test(e))return r*parseInt(e,16);if(b.test(e))return r*parseInt(e,8);if(C.test(e))return r*parseFloat(e);throw q(e,"number",t)}function Q(e,t){switch(e){case"max":case"MAX":case"Max":return 0x1fffffff;case"0":return 0}if(!t&&"-"===e.charAt(0))throw q(e,"id");if(g.test(e))return parseInt(e,10);if(v.test(e))return parseInt(e,16);if(S.test(e))return parseInt(e,8);throw q(e,"id")}function K(){if(void 0!==R)throw q("package");if(R=N(),!E.test(R))throw q(R,"name");B=B.define(R),P(";")}function J(){var e,t=D();switch(t){case"weak":e=A||(A=[]),N();break;case"public":N();default:e=k||(k=[])}t=$(),P(";"),e.push(t)}function Y(){if(P("="),(F=$())<2023)throw q(F,"syntax");P(";")}function X(){if(P("="),!["2023"].includes(F=$()))throw q(F,"edition");P(";")}function Z(e,t){switch(t){case"option":return el(e,t),P(";"),!0;case"message":return et(e,t),!0;case"enum":return ea(e,t),!0;case"service":return ef(e,t),!0;case"extend":return em(e,t),!0}return!1}function ee(e,t,r){var i,n=O.line;if(e&&("string"!=typeof e.comment&&(e.comment=M()),e.filename=_.filename),P("{",!0)){for(;"}"!==(i=N());)t(i);P(";",!0)}else r&&r(),P(";"),e&&("string"!=typeof e.comment||I)&&(e.comment=M(n)||e.comment)}function et(e,t){if(!T.test(t=N()))throw q(t,"type name");var r=new s(t);ee(r,function(e){if(!Z(r,e))switch(e){case"map":en(r,e);break;case"required":if("proto2"!==F)throw q(e);case"repeated":er(r,e);break;case"optional":if("proto3"===F)er(r,"proto3_optional");else if("proto2"!==F)throw q(e);else er(r,"optional");break;case"oneof":es(r,e);break;case"extensions":W(r.extensions||(r.extensions=[]));break;case"reserved":W(r.reserved||(r.reserved=[]),!0);break;default:if("proto2"===F||!E.test(e))throw q(e);x(e),er(r,"optional")}}),e.add(r),e===B&&j.push(r)}function er(e,t,r){var i=N();if("group"===i)return void ei(e,t);for(;i.endsWith(".")||D().startsWith(".");)i+=N();if(!E.test(i))throw q(i,"type");var n=N();if(!T.test(n))throw q(n,"name");n=V(n),P("=");var s=new a(n,Q(N()),i,t,r);if(ee(s,function(e){if("option"===e)el(s,e),P(";");else throw q(e)},function(){ed(s)}),"proto3_optional"===t){var o=new l("_"+n);s.setOption("proto3_optional",!0),o.add(s),e.add(o)}else e.add(s);e===B&&j.push(s)}function ei(e,t){if(F>=2023)throw q("group");var r=N();if(!T.test(r))throw q(r,"name");var i=p.lcFirst(r);r===i&&(r=p.ucFirst(r)),P("=");var n=Q(N()),o=new s(r);o.group=!0;var l=new a(i,n,r,t);l.filename=_.filename,ee(o,function(e){switch(e){case"option":el(o,e),P(";");break;case"required":case"repeated":er(o,e);break;case"optional":"proto3"===F?er(o,"proto3_optional"):er(o,"optional");break;case"message":et(o,e);break;case"enum":ea(o,e);break;case"reserved":W(o.reserved||(o.reserved=[]),!0);break;default:throw q(e)}}),e.add(o).add(l)}function en(e){P("<");var t=N();if(void 0===f.mapKey[t])throw q(t,"type");P(",");var r=N();if(!E.test(r))throw q(r,"type");P(">");var i=N();if(!T.test(i))throw q(i,"name");P("=");var n=new o(V(i),Q(N()),t,r);ee(n,function(e){if("option"===e)el(n,e),P(";");else throw q(e)},function(){ed(n)}),e.add(n)}function es(e,t){if(!T.test(t=N()))throw q(t,"name");var r=new l(V(t));ee(r,function(e){"option"===e?(el(r,e),P(";")):(x(e),er(r,"optional"))}),e.add(r)}function ea(e,t){if(!T.test(t=N()))throw q(t,"name");var r=new c(t);ee(r,function(e){switch(e){case"option":el(r,e),P(";");break;case"reserved":W(r.reserved||(r.reserved=[]),!0),void 0===r.reserved&&(r.reserved=[]);break;default:eo(r,e)}}),e.add(r),e===B&&j.push(r)}function eo(e,t){if(!T.test(t))throw q(t,"name");P("=");var r=Q(N(),!0),i={options:void 0};i.getOption=function(e){return this.options[e]},i.setOption=function(e,t){d.prototype.setOption.call(i,e,t)},i.setParsedOption=function(){},ee(i,function(e){if("option"===e)el(i,e),P(";");else throw q(e)},function(){ed(i)}),e.add(t,r,i.comment,i.parsedOptions||i.options)}function el(e,t){var r,i,n=!0;for("option"===t&&(t=N());"="!==t;){if("("===t){var s=N();P(")"),t="("+s+")"}if(n){if(n=!1,t.includes(".")&&!t.includes("(")){var a=t.split(".");r=a[0]+".",t=a[1];continue}r=t}else i=i?i+=t:t;t=N()}var o=ec(e,i?r.concat(i):r);i=i&&"."===i[0]?i.slice(1):i,eh(e,r=r&&"."===r[r.length-1]?r.slice(0,-1):r,o,i)}function ec(e,t){if(P("{",!0)){for(var r={};!P("}",!0);){if(!T.test(w=N()))throw q(w,"name");if(null===w)throw q(w,"end of input");var i,n,s=w;if(P(":",!0),"{"===D())i=ec(e,t+"."+w);else if("["===D()){if(i=[],P("[",!0)){do n=H(!0),i.push(n);while(P(",",!0))P("]"),void 0!==n&&eu(e,t+"."+w,n)}}else i=H(!0),eu(e,t+"."+w,i);var a=r[s];a&&(i=[].concat(a).concat(i)),r[s]=i,P(",",!0),P(";",!0)}return r}var o=H(!0);return eu(e,t,o),o}function eu(e,t,r){if(B===e&&/^features\./.test(t)){U[t]=r;return}e.setOption&&e.setOption(t,r)}function eh(e,t,r,i){e.setParsedOption&&e.setParsedOption(t,r,i)}function ed(e){if(P("[",!0)){do el(e,"option");while(P(",",!0))P("]")}return e}function ef(e,t){if(!T.test(t=N()))throw q(t,"service name");var r=new u(t);ee(r,function(e){if(!Z(r,e))if("rpc"===e)ep(r,e);else throw q(e)}),e.add(r),e===B&&j.push(r)}function ep(e,t){var r=M(),i=t;if(!T.test(t=N()))throw q(t,"name");var n,s,a,o,l=t;if(P("("),P("stream",!0)&&(s=!0),!E.test(t=N())||(n=t,P(")"),P("returns"),P("("),P("stream",!0)&&(o=!0),!E.test(t=N())))throw q(t);a=t,P(")");var c=new h(l,i,n,a,s,o);c.comment=r,ee(c,function(e){if("option"===e)el(c,e),P(";");else throw q(e)}),e.add(c)}function em(e,t){if(!E.test(t=N()))throw q(t,"reference");var r=t;ee(null,function(t){switch(t){case"required":case"repeated":er(e,t,r);break;case"optional":"proto3"===F?er(e,"proto3_optional",r):er(e,"optional",r);break;default:if("proto2"===F||!E.test(t))throw q(t);x(t),er(e,"optional",r)}})}for(;null!==(w=N());)switch(w){case"package":if(!L)throw q(w);K();break;case"import":if(!L)throw q(w);J();break;case"syntax":if(!L)throw q(w);Y();break;case"edition":if(!L)throw q(w);X();break;case"option":el(B,w),P(";",!0);break;default:if(Z(B,w)){L=!1;continue}throw q(w)}return z(),_.filename=null,{package:R,imports:k,weakImports:A,root:t}}},61198,(e,t,r)=>{"use strict";t.exports=s;var i,n=/\/|\./;function s(e,t){n.test(e)||(e="google/protobuf/"+e+".proto",t={nested:{google:{nested:{protobuf:{nested:t}}}}}),s[e]=t}s("any",{Any:{fields:{type_url:{type:"string",id:1},value:{type:"bytes",id:2}}}}),s("duration",{Duration:i={fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}}}),s("timestamp",{Timestamp:i}),s("empty",{Empty:{fields:{}}}),s("struct",{Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}}}),s("wrappers",{DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}}}),s("field_mask",{FieldMask:{fields:{paths:{rule:"repeated",type:"string",id:1}}}}),s.get=function(e){return s[e]||null}},42484,(e,t,r)=>{"use strict";var i=t.exports=e.r(16716);i.build="full",i.tokenize=e.r(89325),i.parse=e.r(60265),i.common=e.r(61198),i.Root._configure(i.Type,i.parse,i.common)},98872,(e,t,r)=>{"use strict";t.exports=e.r(42484)},17641,(e,t,r)=>{"use strict";var i=e.r(98872);t.exports=r=i.descriptor=i.Root.fromJSON(e.r(35551)).lookup(".google.protobuf");var n=i.Namespace,s=i.Root,a=i.Enum,o=i.Type,l=i.Field,c=i.MapField,u=i.OneOf,h=i.Service,d=i.Method;function f(e,t,i){var c=r.FileDescriptorProto.create({name:e.filename||(e.fullName.substring(1).replace(/\./g,"_")||"root")+".proto"});O(i,c),e instanceof s||(c.package=e.fullName.substring(1));for(var u,d=0;d<e.nestedArray.length;++d)(u=e._nestedArray[d])instanceof o?c.messageType.push(u.toDescriptor(i)):u instanceof a?c.enumType.push(u.toDescriptor()):u instanceof l?c.extension.push(u.toDescriptor(i)):u instanceof h?c.service.push(u.toDescriptor()):u instanceof n&&f(u,t,i);c.options=R(e.options,r.FileOptions),c.messageType.length+c.enumType.length+c.extension.length+c.service.length&&t.push(c)}s.fromDescriptor=function(e){"number"==typeof e.length&&(e=r.FileDescriptorSet.decode(e));var t=new s;if(e.file)for(var i,n,c,u=0;u<e.file.length;++u){n=t,(i=e.file[u]).package&&i.package.length&&(n=t.define(i.package));var d=I(i);if(i.name&&i.name.length&&t.files.push(n.filename=i.name),i.messageType)for(c=0;c<i.messageType.length;++c)n.add(o.fromDescriptor(i.messageType[c],d));if(i.enumType)for(c=0;c<i.enumType.length;++c)n.add(a.fromDescriptor(i.enumType[c],d));if(i.extension)for(c=0;c<i.extension.length;++c)n.add(l.fromDescriptor(i.extension[c],d));if(i.service)for(c=0;c<i.service.length;++c)n.add(h.fromDescriptor(i.service[c],d));var f=_(i.options,r.FileOptions);if(f){var p=Object.keys(f);for(c=0;c<p.length;++c)n.setOption(p[c],f[p[c]])}}return t.resolveAll()},s.prototype.toDescriptor=function(e){var t=r.FileDescriptorSet.create();return f(this,t.file,e),t};var p=0;o.fromDescriptor=function(e,t,i){"number"==typeof e.length&&(e=r.DescriptorProto.decode(e));var n,s=new o(e.name.length?e.name:"Type"+p++,_(e.options,r.MessageOptions));if(i||(s._edition=t),e.oneofDecl)for(n=0;n<e.oneofDecl.length;++n)s.add(u.fromDescriptor(e.oneofDecl[n]));if(e.field)for(n=0;n<e.field.length;++n){var c=l.fromDescriptor(e.field[n],t,!0);s.add(c),e.field[n].hasOwnProperty("oneofIndex")&&s.oneofsArray[e.field[n].oneofIndex].add(c)}if(e.extension)for(n=0;n<e.extension.length;++n)s.add(l.fromDescriptor(e.extension[n],t,!0));if(e.nestedType)for(n=0;n<e.nestedType.length;++n)s.add(o.fromDescriptor(e.nestedType[n],t,!0)),e.nestedType[n].options&&e.nestedType[n].options.mapEntry&&s.setOption("map_entry",!0);if(e.enumType)for(n=0;n<e.enumType.length;++n)s.add(a.fromDescriptor(e.enumType[n],t,!0));if(e.extensionRange&&e.extensionRange.length)for(n=0,s.extensions=[];n<e.extensionRange.length;++n)s.extensions.push([e.extensionRange[n].start,e.extensionRange[n].end]);if(e.reservedRange&&e.reservedRange.length||e.reservedName&&e.reservedName.length){if(s.reserved=[],e.reservedRange)for(n=0;n<e.reservedRange.length;++n)s.reserved.push([e.reservedRange[n].start,e.reservedRange[n].end]);if(e.reservedName)for(n=0;n<e.reservedName.length;++n)s.reserved.push(e.reservedName[n])}return s},o.prototype.toDescriptor=function(e){var t,i,n=r.DescriptorProto.create({name:this.name});for(i=0;i<this.fieldsArray.length;++i)if(n.field.push(t=this._fieldsArray[i].toDescriptor(e)),this._fieldsArray[i]instanceof c){var s=T(this._fieldsArray[i].keyType,this._fieldsArray[i].resolvedKeyType,!1),u=T(this._fieldsArray[i].type,this._fieldsArray[i].resolvedType,!1),h=11===u||14===u?this._fieldsArray[i].resolvedType&&k(this.parent,this._fieldsArray[i].resolvedType)||this._fieldsArray[i].type:void 0;n.nestedType.push(r.DescriptorProto.create({name:t.typeName,field:[r.FieldDescriptorProto.create({name:"key",number:1,label:1,type:s}),r.FieldDescriptorProto.create({name:"value",number:2,label:1,type:u,typeName:h})],options:r.MessageOptions.create({mapEntry:!0})}))}for(i=0;i<this.oneofsArray.length;++i)n.oneofDecl.push(this._oneofsArray[i].toDescriptor());for(i=0;i<this.nestedArray.length;++i)this._nestedArray[i]instanceof l?n.field.push(this._nestedArray[i].toDescriptor(e)):this._nestedArray[i]instanceof o?n.nestedType.push(this._nestedArray[i].toDescriptor(e)):this._nestedArray[i]instanceof a&&n.enumType.push(this._nestedArray[i].toDescriptor());if(this.extensions)for(i=0;i<this.extensions.length;++i)n.extensionRange.push(r.DescriptorProto.ExtensionRange.create({start:this.extensions[i][0],end:this.extensions[i][1]}));if(this.reserved)for(i=0;i<this.reserved.length;++i)"string"==typeof this.reserved[i]?n.reservedName.push(this.reserved[i]):n.reservedRange.push(r.DescriptorProto.ReservedRange.create({start:this.reserved[i][0],end:this.reserved[i][1]}));return n.options=R(this.options,r.MessageOptions),n};var m=/^(?![eE])[0-9]*(?:\.[0-9]*)?(?:[eE][+-]?[0-9]+)?$/;l.fromDescriptor=function(e,t,i){if("number"==typeof e.length&&(e=r.DescriptorProto.decode(e)),"number"!=typeof e.number)throw Error("missing field id");switch(n=e.typeName&&e.typeName.length?e.typeName:S(e.type),e.label){case 1:s=void 0;break;case 2:s="required";break;case 3:s="repeated";break;default:throw Error("illegal label: "+e.label)}var n,s,a=e.extendee;void 0!==e.extendee&&(a=a.length?a:void 0);var o=new l(e.name.length?e.name:"field"+e.number,e.number,n,s,a);if(i||(o._edition=t),o.options=_(e.options,r.FieldOptions),e.proto3_optional&&(o.options.proto3_optional=!0),e.defaultValue&&e.defaultValue.length){var c=e.defaultValue;switch(c){case"true":case"TRUE":c=!0;break;case"false":case"FALSE":c=!1;break;default:m.exec(c)&&(c=parseInt(c))}o.setOption("default",c)}return C(e.type)&&("proto3"===t?e.options&&!e.options.packed&&o.setOption("packed",!1):(!t||"proto2"===t)&&e.options&&e.options.packed&&o.setOption("packed",!0)),o},l.prototype.toDescriptor=function(e){var t=r.FieldDescriptorProto.create({name:this.name,number:this.id});if(this.map)t.type=11,t.typeName=i.util.ucFirst(this.name),t.label=3;else{switch(t.type=T(this.type,this.resolve().resolvedType,this.delimited)){case 10:case 11:case 14:t.typeName=this.resolvedType?k(this.parent,this.resolvedType):this.type}"repeated"===this.rule?t.label=3:this.required&&"proto2"===e?t.label=2:t.label=1}if(t.extendee=this.extensionField?this.extensionField.parent.fullName:this.extend,this.partOf&&(t.oneofIndex=this.parent.oneofsArray.indexOf(this.partOf))<0)throw Error("missing oneof");return this.options&&(t.options=R(this.options,r.FieldOptions),null!=this.options.default&&(t.defaultValue=String(this.options.default)),this.options.proto3_optional&&(t.proto3_optional=!0)),"proto3"===e?this.packed||((t.options||(t.options=r.FieldOptions.create())).packed=!1):(!e||"proto2"===e)&&this.packed&&((t.options||(t.options=r.FieldOptions.create())).packed=!0),t};var g=0;a.fromDescriptor=function(e,t,i){"number"==typeof e.length&&(e=r.EnumDescriptorProto.decode(e));var n={};if(e.value)for(var s=0;s<e.value.length;++s){var o=e.value[s].name,l=e.value[s].number||0;n[o&&o.length?o:"NAME"+l]=l}var c=new a(e.name&&e.name.length?e.name:"Enum"+g++,n,_(e.options,r.EnumOptions));return i||(c._edition=t),c},a.prototype.toDescriptor=function(){for(var e=[],t=0,i=Object.keys(this.values);t<i.length;++t)e.push(r.EnumValueDescriptorProto.create({name:i[t],number:this.values[i[t]]}));return r.EnumDescriptorProto.create({name:this.name,value:e,options:R(this.options,r.EnumOptions)})};var y=0;u.fromDescriptor=function(e){return"number"==typeof e.length&&(e=r.OneofDescriptorProto.decode(e)),new u(e.name&&e.name.length?e.name:"oneof"+y++)},u.prototype.toDescriptor=function(){return r.OneofDescriptorProto.create({name:this.name})};var v=0;h.fromDescriptor=function(e,t,i){"number"==typeof e.length&&(e=r.ServiceDescriptorProto.decode(e));var n=new h(e.name&&e.name.length?e.name:"Service"+v++,_(e.options,r.ServiceOptions));if(i||(n._edition=t),e.method)for(var s=0;s<e.method.length;++s)n.add(d.fromDescriptor(e.method[s]));return n},h.prototype.toDescriptor=function(){for(var e=[],t=0;t<this.methodsArray.length;++t)e.push(this._methodsArray[t].toDescriptor());return r.ServiceDescriptorProto.create({name:this.name,method:e,options:R(this.options,r.ServiceOptions)})};var b=0;function S(e){switch(e){case 1:return"double";case 2:return"float";case 3:return"int64";case 4:return"uint64";case 5:return"int32";case 6:return"fixed64";case 7:return"fixed32";case 8:return"bool";case 9:return"string";case 12:return"bytes";case 13:return"uint32";case 15:return"sfixed32";case 16:return"sfixed64";case 17:return"sint32";case 18:return"sint64"}throw Error("illegal type: "+e)}function C(e){switch(e){case 1:case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 13:case 14:case 15:case 16:case 17:case 18:return!0}return!1}function T(e,t,r){switch(e){case"double":return 1;case"float":return 2;case"int64":return 3;case"uint64":return 4;case"int32":return 5;case"fixed64":return 6;case"fixed32":return 7;case"bool":return 8;case"string":return 9;case"bytes":return 12;case"uint32":return 13;case"sfixed32":return 15;case"sfixed64":return 16;case"sint32":return 17;case"sint64":return 18}if(t instanceof a)return 14;if(t instanceof o)return r?10:11;throw Error("illegal type: "+e)}function E(e,t){for(var r,i,n={},s=0;s<t.fieldsArray.length;++s)if("uninterpretedOption"!==(i=(r=t._fieldsArray[s]).name)&&Object.prototype.hasOwnProperty.call(e,i)){var l=A(i);r.resolvedType instanceof o?n[l]=E(e[i],r.resolvedType):r.resolvedType instanceof a?n[l]=r.resolvedType.valuesById[e[i]]:n[l]=e[i]}return n}function _(e,t){if(e)return E(t.toObject(e),t)}function w(e,t){for(var r={},n=Object.keys(e),s=0;s<n.length;++s){var a=n[s],l=i.util.camelCase(a);if(Object.prototype.hasOwnProperty.call(t.fields,l)){var c=t.fields[l];c.resolvedType instanceof o?r[l]=w(e[a],c.resolvedType):r[l]=e[a],c.repeated&&!Array.isArray(r[l])&&(r[l]=[r[l]])}}return r}function R(e,t){if(e)return t.fromObject(w(e,t))}function k(e,t){var r=e.fullName.split("."),i=t.fullName.split("."),a=0,o=0,l=i.length-1;if(!(e instanceof s)&&t instanceof n)for(;a<r.length&&o<l&&r[a]===i[o];){var c=t.lookup(r[a++],!0);if(null!==c&&c!==t)break;++o}else for(;a<r.length&&o<l&&r[a]===i[o];++a,++o);return i.slice(o).join(".")}function A(e){return e.substring(0,1)+e.substring(1).replace(/([A-Z])(?=[a-z]|$)/g,function(e,t){return"_"+t.toLowerCase()})}function I(e){if("editions"===e.syntax)if(e.edition===r.Edition.EDITION_2023)return"2023";else throw Error("Unsupported edition "+e.edition);return"proto3"===e.syntax?"proto3":"proto2"}function O(e,t){if(e)if("proto2"===e||"proto3"===e)t.syntax=e;else if(t.syntax="editions","2023"===e)t.edition=r.Edition.EDITION_2023;else throw Error("Unsupported edition "+e)}d.fromDescriptor=function(e){return"number"==typeof e.length&&(e=r.MethodDescriptorProto.decode(e)),new d(e.name&&e.name.length?e.name:"Method"+b++,"rpc",e.inputType,e.outputType,!!e.clientStreaming,!!e.serverStreaming,_(e.options,r.MethodOptions))},d.prototype.toDescriptor=function(){return r.MethodDescriptorProto.create({name:this.name,inputType:this.resolvedRequestType?this.resolvedRequestType.fullName:this.requestType,outputType:this.resolvedResponseType?this.resolvedResponseType.fullName:this.responseType,clientStreaming:this.requestStream,serverStreaming:this.responseStream,options:R(this.options,r.MethodOptions)})}},13460,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.addCommonProtos=r.loadProtosWithOptionsSync=r.loadProtosWithOptions=void 0;let i=e.r(22734),n=e.r(14747),s=e.r(98872);function a(e,t){let r=e.resolvePath;e.resolvePath=(e,s)=>{if(n.isAbsolute(s))return s;for(let e of t){let t=n.join(e,s);try{return i.accessSync(t,i.constants.R_OK),t}catch(e){continue}}return process.emitWarning(`${s} not found in any of the include paths ${t}`),r(e,s)}}r.loadProtosWithOptions=async function(e,t){let r=new s.Root;if((t=t||{}).includeDirs){if(!Array.isArray(t.includeDirs))return Promise.reject(Error("The includeDirs option must be an array"));a(r,t.includeDirs)}let i=await r.load(e,t);return i.resolveAll(),i},r.loadProtosWithOptionsSync=function(e,t){let r=new s.Root;if((t=t||{}).includeDirs){if(!Array.isArray(t.includeDirs))throw Error("The includeDirs option must be an array");a(r,t.includeDirs)}let i=r.loadSync(e,t);return i.resolveAll(),i},r.addCommonProtos=function(){let t=e.r(88333),r=e.r(35551),i=e.r(88965),n=e.r(60860);s.common("api",t.nested.google.nested.protobuf.nested),s.common("descriptor",r.nested.google.nested.protobuf.nested),s.common("source_context",i.nested.google.nested.protobuf.nested),s.common("type",n.nested.google.nested.protobuf.nested)}},54423,(e,t,r)=>{!function(i,n){function s(e){return e.default||e}if("function"==typeof define&&define.amd){let t;void 0!==(t=function(){var e={};return n(e),s(e)}())&&e.v(t)}else n(r),t.exports=s(r)}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:e.e,function(e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var t=null;try{t=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function r(e,t,r){this.low=0|e,this.high=0|t,this.unsigned=!!r}function i(e){return!0===(e&&e.__isLong__)}function n(e){var t=Math.clz32(e&-e);return e?31-t:t}r.prototype.__isLong__,Object.defineProperty(r.prototype,"__isLong__",{value:!0}),r.isLong=i;var s={},a={};function o(e,t){var r,i,n;if(t)return(e>>>=0,(n=0<=e&&e<256)&&(i=a[e]))?i:(r=c(e,0,!0),n&&(a[e]=r),r);return(e|=0,(n=-128<=e&&e<128)&&(i=s[e]))?i:(r=c(e,e<0?-1:0,!1),n&&(s[e]=r),r)}function l(e,t){if(isNaN(e))return t?v:y;if(t){if(e<0)return v;if(e>=p)return E}else{if(e<=-m)return _;if(e+1>=m)return T}return e<0?l(-e,t).neg():c(e%f|0,e/f|0,t)}function c(e,t,i){return new r(e,t,i)}r.fromInt=o,r.fromNumber=l,r.fromBits=c;var u=Math.pow;function h(e,t,r){if(0===e.length)throw Error("empty string");if("number"==typeof t?(r=t,t=!1):t=!!t,"NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return t?v:y;if((r=r||10)<2||36<r)throw RangeError("radix");if((i=e.indexOf("-"))>0)throw Error("interior hyphen");if(0===i)return h(e.substring(1),t,r).neg();for(var i,n=l(u(r,8)),s=y,a=0;a<e.length;a+=8){var o=Math.min(8,e.length-a),c=parseInt(e.substring(a,a+o),r);if(o<8){var d=l(u(r,o));s=s.mul(d).add(l(c))}else s=(s=s.mul(n)).add(l(c))}return s.unsigned=t,s}function d(e,t){return"number"==typeof e?l(e,t):"string"==typeof e?h(e,t):c(e.low,e.high,"boolean"==typeof t?t:e.unsigned)}r.fromString=h,r.fromValue=d;var f=0x100000000,p=0xffffffffffffffff,m=0x8000000000000000,g=o(0x1000000),y=o(0);r.ZERO=y;var v=o(0,!0);r.UZERO=v;var b=o(1);r.ONE=b;var S=o(1,!0);r.UONE=S;var C=o(-1);r.NEG_ONE=C;var T=c(-1,0x7fffffff,!1);r.MAX_VALUE=T;var E=c(-1,-1,!0);r.MAX_UNSIGNED_VALUE=E;var _=c(0,-0x80000000,!1);r.MIN_VALUE=_;var w=r.prototype;w.toInt=function(){return this.unsigned?this.low>>>0:this.low},w.toNumber=function(){return this.unsigned?(this.high>>>0)*f+(this.low>>>0):this.high*f+(this.low>>>0)},w.toString=function(e){if((e=e||10)<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(!this.eq(_))return"-"+this.neg().toString(e);else{var t=l(e),r=this.div(t),i=r.mul(t).sub(this);return r.toString(e)+i.toInt().toString(e)}for(var n=l(u(e,6),this.unsigned),s=this,a="";;){var o=s.div(n),c=(s.sub(o.mul(n)).toInt()>>>0).toString(e);if((s=o).isZero())return c+a;for(;c.length<6;)c="0"+c;a=""+c+a}},w.getHighBits=function(){return this.high},w.getHighBitsUnsigned=function(){return this.high>>>0},w.getLowBits=function(){return this.low},w.getLowBitsUnsigned=function(){return this.low>>>0},w.getNumBitsAbs=function(){if(this.isNegative())return this.eq(_)?64:this.neg().getNumBitsAbs();for(var e=0!=this.high?this.high:this.low,t=31;t>0&&(e&1<<t)==0;t--);return 0!=this.high?t+33:t+1},w.isSafeInteger=function(){var e=this.high>>21;return!e||!this.unsigned&&-1===e&&(0!==this.low||-2097152!==this.high)},w.isZero=function(){return 0===this.high&&0===this.low},w.eqz=w.isZero,w.isNegative=function(){return!this.unsigned&&this.high<0},w.isPositive=function(){return this.unsigned||this.high>=0},w.isOdd=function(){return(1&this.low)==1},w.isEven=function(){return(1&this.low)==0},w.equals=function(e){return i(e)||(e=d(e)),(this.unsigned===e.unsigned||this.high>>>31!=1||e.high>>>31!=1)&&this.high===e.high&&this.low===e.low},w.eq=w.equals,w.notEquals=function(e){return!this.eq(e)},w.neq=w.notEquals,w.ne=w.notEquals,w.lessThan=function(e){return 0>this.comp(e)},w.lt=w.lessThan,w.lessThanOrEqual=function(e){return 0>=this.comp(e)},w.lte=w.lessThanOrEqual,w.le=w.lessThanOrEqual,w.greaterThan=function(e){return this.comp(e)>0},w.gt=w.greaterThan,w.greaterThanOrEqual=function(e){return this.comp(e)>=0},w.gte=w.greaterThanOrEqual,w.ge=w.greaterThanOrEqual,w.compare=function(e){if(i(e)||(e=d(e)),this.eq(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1},w.comp=w.compare,w.negate=function(){return!this.unsigned&&this.eq(_)?_:this.not().add(b)},w.neg=w.negate,w.add=function(e){i(e)||(e=d(e));var t,r,n=this.high>>>16,s=65535&this.high,a=this.low>>>16,o=65535&this.low,l=e.high>>>16,u=65535&e.high,h=e.low>>>16,f=65535&e.low,p=0,m=0;return t=0+((r=0+(o+f))>>>16),r&=65535,t+=a+h,m+=t>>>16,t&=65535,m+=s+u,p+=m>>>16,m&=65535,p+=n+l,c(t<<16|r,(p&=65535)<<16|m,this.unsigned)},w.subtract=function(e){return i(e)||(e=d(e)),this.add(e.neg())},w.sub=w.subtract,w.multiply=function(e){if(this.isZero())return this;if(i(e)||(e=d(e)),t)return c(t.mul(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned);if(e.isZero())return this.unsigned?v:y;if(this.eq(_))return e.isOdd()?_:y;if(e.eq(_))return this.isOdd()?_:y;if(this.isNegative())if(e.isNegative())return this.neg().mul(e.neg());else return this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(g)&&e.lt(g))return l(this.toNumber()*e.toNumber(),this.unsigned);var r,n,s=this.high>>>16,a=65535&this.high,o=this.low>>>16,u=65535&this.low,h=e.high>>>16,f=65535&e.high,p=e.low>>>16,m=65535&e.low,b=0,S=0;return r=0+((n=0+u*m)>>>16),n&=65535,r+=o*m,S+=r>>>16,r&=65535,r+=u*p,S+=r>>>16,r&=65535,S+=a*m,b+=S>>>16,S&=65535,S+=o*p,b+=S>>>16,S&=65535,S+=u*f,b+=S>>>16,S&=65535,b+=s*m+a*p+o*f+u*h,c(r<<16|n,(b&=65535)<<16|S,this.unsigned)},w.mul=w.multiply,w.divide=function(e){if(i(e)||(e=d(e)),e.isZero())throw Error("division by zero");if(t){var r,n,s;return this.unsigned||-0x80000000!==this.high||-1!==e.low||-1!==e.high?c((this.unsigned?t.div_u:t.div_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this}if(this.isZero())return this.unsigned?v:y;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return v;if(e.gt(this.shru(1)))return S;s=v}else{if(this.eq(_))if(e.eq(b)||e.eq(C))return _;else return e.eq(_)?b:(r=this.shr(1).div(e).shl(1)).eq(y)?e.isNegative()?b:C:(n=this.sub(e.mul(r)),s=r.add(n.div(e)));if(e.eq(_))return this.unsigned?v:y;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();s=y}for(n=this;n.gte(e);){for(var a=Math.ceil(Math.log(r=Math.max(1,Math.floor(n.toNumber()/e.toNumber())))/Math.LN2),o=a<=48?1:u(2,a-48),h=l(r),f=h.mul(e);f.isNegative()||f.gt(n);)r-=o,f=(h=l(r,this.unsigned)).mul(e);h.isZero()&&(h=b),s=s.add(h),n=n.sub(f)}return s},w.div=w.divide,w.modulo=function(e){return(i(e)||(e=d(e)),t)?c((this.unsigned?t.rem_u:t.rem_s)(this.low,this.high,e.low,e.high),t.get_high(),this.unsigned):this.sub(this.div(e).mul(e))},w.mod=w.modulo,w.rem=w.modulo,w.not=function(){return c(~this.low,~this.high,this.unsigned)},w.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},w.clz=w.countLeadingZeros,w.countTrailingZeros=function(){return this.low?n(this.low):n(this.high)+32},w.ctz=w.countTrailingZeros,w.and=function(e){return i(e)||(e=d(e)),c(this.low&e.low,this.high&e.high,this.unsigned)},w.or=function(e){return i(e)||(e=d(e)),c(this.low|e.low,this.high|e.high,this.unsigned)},w.xor=function(e){return i(e)||(e=d(e)),c(this.low^e.low,this.high^e.high,this.unsigned)},w.shiftLeft=function(e){return(i(e)&&(e=e.toInt()),0==(e&=63))?this:e<32?c(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):c(0,this.low<<e-32,this.unsigned)},w.shl=w.shiftLeft,w.shiftRight=function(e){return(i(e)&&(e=e.toInt()),0==(e&=63))?this:e<32?c(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):c(this.high>>e-32,this.high>=0?0:-1,this.unsigned)},w.shr=w.shiftRight,w.shiftRightUnsigned=function(e){return(i(e)&&(e=e.toInt()),0==(e&=63))?this:e<32?c(this.low>>>e|this.high<<32-e,this.high>>>e,this.unsigned):32===e?c(this.high,0,this.unsigned):c(this.high>>>e-32,0,this.unsigned)},w.shru=w.shiftRightUnsigned,w.shr_u=w.shiftRightUnsigned,w.rotateLeft=function(e){var t;return(i(e)&&(e=e.toInt()),0==(e&=63))?this:32===e?c(this.high,this.low,this.unsigned):e<32?(t=32-e,c(this.low<<e|this.high>>>t,this.high<<e|this.low>>>t,this.unsigned)):(e-=32,t=32-e,c(this.high<<e|this.low>>>t,this.low<<e|this.high>>>t,this.unsigned))},w.rotl=w.rotateLeft,w.rotateRight=function(e){var t;return(i(e)&&(e=e.toInt()),0==(e&=63))?this:32===e?c(this.high,this.low,this.unsigned):e<32?(t=32-e,c(this.high<<t|this.low>>>e,this.low<<t|this.high>>>e,this.unsigned)):(e-=32,t=32-e,c(this.low<<t|this.high>>>e,this.high<<t|this.low>>>e,this.unsigned))},w.rotr=w.rotateRight,w.toSigned=function(){return this.unsigned?c(this.low,this.high,!1):this},w.toUnsigned=function(){return this.unsigned?this:c(this.low,this.high,!0)},w.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()},w.toBytesLE=function(){var e=this.high,t=this.low;return[255&t,t>>>8&255,t>>>16&255,t>>>24,255&e,e>>>8&255,e>>>16&255,e>>>24]},w.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,255&e,t>>>24,t>>>16&255,t>>>8&255,255&t]},r.fromBytes=function(e,t,i){return i?r.fromBytesLE(e,t):r.fromBytesBE(e,t)},r.fromBytesLE=function(e,t){return new r(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)},r.fromBytesBE=function(e,t){return new r(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)},"function"==typeof BigInt&&(r.fromBigInt=function(e,t){return c(Number(BigInt.asIntN(32,e)),Number(BigInt.asIntN(32,e>>BigInt(32))),t)},r.fromValue=function(e,t){return"bigint"==typeof e?r.fromBigInt(e,t):d(e,t)},w.toBigInt=function(){var e=BigInt(this.low>>>0);return BigInt(this.unsigned?this.high>>>0:this.high)<<BigInt(32)|e}),e.default=r})},36458,(e,t,r)=>{"use strict";var i;Object.defineProperty(r,"__esModule",{value:!0}),r.loadFileDescriptorSetFromObject=r.loadFileDescriptorSetFromBuffer=r.fromJSON=r.loadSync=r.load=r.IdempotencyLevel=r.isAnyExtension=r.Long=void 0;let n=e.r(26904),s=e.r(98872),a=e.r(17641),o=e.r(13460);r.Long=e.r(54423),r.isAnyExtension=function(e){return"@type"in e&&"string"==typeof e["@type"]},function(e){e.IDEMPOTENCY_UNKNOWN="IDEMPOTENCY_UNKNOWN",e.NO_SIDE_EFFECTS="NO_SIDE_EFFECTS",e.IDEMPOTENT="IDEMPOTENT"}(i=r.IdempotencyLevel||(r.IdempotencyLevel={}));let l={longs:String,enums:String,bytes:String,defaults:!0,oneofs:!0,json:!0};function c(e,t){return""===e?t:e+"."+t}function u(e){return e instanceof s.Service||e instanceof s.Type||e instanceof s.Enum}function h(e){return e instanceof s.Namespace||e instanceof s.Root}function d(e,t){let r=c(t,e.name);return u(e)?[[r,e]]:h(e)&&void 0!==e.nested?Object.keys(e.nested).map(t=>d(e.nested[t],r)).reduce((e,t)=>e.concat(t),[]):[]}function f(e,t){return function(r){return e.toObject(e.decode(r),t)}}function p(e){return function(t){if(Array.isArray(t))throw Error(`Failed to serialize message: expected object with ${e.name} structure, got array instead`);let r=e.fromObject(t);return e.encode(r).finish()}}function m(e){return(e||[]).reduce((e,t)=>{for(let[r,i]of Object.entries(t))"uninterpreted_option"===r?e.uninterpreted_option.push(t.uninterpreted_option):e[r]=i;return e},{deprecated:!1,idempotency_level:i.IDEMPOTENCY_UNKNOWN,uninterpreted_option:[]})}function g(e,t,r,i){let s=e.resolvedRequestType,a=e.resolvedResponseType;return{path:"/"+t+"/"+e.name,requestStream:!!e.requestStream,responseStream:!!e.responseStream,requestSerialize:p(s),requestDeserialize:f(s,r),responseSerialize:p(a),responseDeserialize:f(a,r),originalName:n(e.name),requestType:v(s,i),responseType:v(a,i),options:m(e.parsedOptions)}}function y(e,t,r,i){let n={};for(let s of e.methodsArray)n[s.name]=g(s,t,r,i);return n}function v(e,t){let r=e.toDescriptor("proto3");return{format:"Protocol Buffer 3 DescriptorProto",type:r.$type.toObject(r,l),fileDescriptorProtos:t}}function b(e,t){let r=e.toDescriptor("proto3");return{format:"Protocol Buffer 3 EnumDescriptorProto",type:r.$type.toObject(r,l),fileDescriptorProtos:t}}function S(e,t,r,i){if(e instanceof s.Service)return y(e,t,r,i);if(e instanceof s.Type)return v(e,i);if(e instanceof s.Enum)return b(e,i);throw Error("Type mismatch in reflection object handling")}function C(e,t){let r={};e.resolveAll();let i=e.toDescriptor("proto3").file.map(e=>Buffer.from(a.FileDescriptorProto.encode(e).finish()));for(let[n,s]of d(e,""))r[n]=S(s,n,t,i);return r}function T(e,t){t=t||{};let r=s.Root.fromDescriptor(e);return r.resolveAll(),C(r,t)}r.load=function(e,t){return(0,o.loadProtosWithOptions)(e,t).then(e=>C(e,t))},r.loadSync=function(e,t){return C((0,o.loadProtosWithOptionsSync)(e,t),t)},r.fromJSON=function(e,t){t=t||{};let r=s.Root.fromJSON(e);return r.resolveAll(),C(r,t)},r.loadFileDescriptorSetFromBuffer=function(e,t){return T(a.FileDescriptorSet.decode(e),t)},r.loadFileDescriptorSetFromObject=function(e,t){return T(a.FileDescriptorSet.fromObject(e),t)},(0,o.addCommonProtos)()},23023,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.setup=r.getChannelzServiceDefinition=r.getChannelzHandlers=r.unregisterChannelzRef=r.registerChannelzSocket=r.registerChannelzServer=r.registerChannelzSubchannel=r.registerChannelzChannel=r.ChannelzCallTracker=r.ChannelzChildrenTracker=r.ChannelzTrace=void 0;let i=e.r(4446),n=e.r(35967),s=e.r(7782),a=e.r(76054),o=e.r(15831),l=e.r(33859);function c(e){return{channel_id:e.id,name:e.name}}function u(e){return{subchannel_id:e.id,name:e.name}}function h(e){return{server_id:e.id}}function d(e){return{socket_id:e.id,name:e.name}}let f=32;class p{constructor(){this.events=[],this.eventsLogged=0,this.creationTimestamp=new Date}addTrace(e,t,r){let i=new Date;this.events.push({description:t,severity:e,timestamp:i,childChannel:(null==r?void 0:r.kind)==="channel"?r:void 0,childSubchannel:(null==r?void 0:r.kind)==="subchannel"?r:void 0}),this.events.length>=2*f&&(this.events=this.events.slice(f)),this.eventsLogged+=1}getTraceMessage(){return{creation_timestamp:k(this.creationTimestamp),num_events_logged:this.eventsLogged,events:this.events.map(e=>({description:e.description,severity:e.severity,timestamp:k(e.timestamp),channel_ref:e.childChannel?c(e.childChannel):null,subchannel_ref:e.childSubchannel?u(e.childSubchannel):null}))}}}r.ChannelzTrace=p;class m{constructor(){this.channelChildren=new Map,this.subchannelChildren=new Map,this.socketChildren=new Map}refChild(e){var t,r,i;switch(e.kind){case"channel":{let r=null!=(t=this.channelChildren.get(e.id))?t:{ref:e,count:0};r.count+=1,this.channelChildren.set(e.id,r);break}case"subchannel":{let t=null!=(r=this.subchannelChildren.get(e.id))?r:{ref:e,count:0};t.count+=1,this.subchannelChildren.set(e.id,t);break}case"socket":{let t=null!=(i=this.socketChildren.get(e.id))?i:{ref:e,count:0};t.count+=1,this.socketChildren.set(e.id,t)}}}unrefChild(e){switch(e.kind){case"channel":{let t=this.channelChildren.get(e.id);void 0!==t&&(t.count-=1,0===t.count?this.channelChildren.delete(e.id):this.channelChildren.set(e.id,t));break}case"subchannel":{let t=this.subchannelChildren.get(e.id);void 0!==t&&(t.count-=1,0===t.count?this.subchannelChildren.delete(e.id):this.subchannelChildren.set(e.id,t));break}case"socket":{let t=this.socketChildren.get(e.id);void 0!==t&&(t.count-=1,0===t.count?this.socketChildren.delete(e.id):this.socketChildren.set(e.id,t))}}}getChildLists(){let e=[];for(let{ref:t}of this.channelChildren.values())e.push(t);let t=[];for(let{ref:e}of this.subchannelChildren.values())t.push(e);let r=[];for(let{ref:e}of this.socketChildren.values())r.push(e);return{channels:e,subchannels:t,sockets:r}}}r.ChannelzChildrenTracker=m;class g{constructor(){this.callsStarted=0,this.callsSucceeded=0,this.callsFailed=0,this.lastCallStartedTimestamp=null}addCallStarted(){this.callsStarted+=1,this.lastCallStartedTimestamp=new Date}addCallSucceeded(){this.callsSucceeded+=1}addCallFailed(){this.callsFailed+=1}}r.ChannelzCallTracker=g;let y=1;function v(){return y++}let b=[],S=[],C=[],T=[];function E(e){let t=Number.parseInt(e,16);return[t/256|0,t%256]}function _(e){return""===e?[]:[].concat(...e.split(":").map(e=>E(e)))}function w(e){if((0,i.isIPv4)(e))return Buffer.from(Uint8Array.from(e.split(".").map(e=>Number.parseInt(e))));if(!(0,i.isIPv6)(e))return null;{let t,r,i=e.indexOf("::");-1===i?(t=e,r=""):(t=e.substring(0,i),r=e.substring(i+2));let n=Buffer.from(_(t)),s=Buffer.from(_(r)),a=Buffer.alloc(16-n.length-s.length,0);return Buffer.concat([n,a,s])}}function R(e){switch(e){case n.ConnectivityState.CONNECTING:return{state:"CONNECTING"};case n.ConnectivityState.IDLE:return{state:"IDLE"};case n.ConnectivityState.READY:return{state:"READY"};case n.ConnectivityState.SHUTDOWN:return{state:"SHUTDOWN"};case n.ConnectivityState.TRANSIENT_FAILURE:return{state:"TRANSIENT_FAILURE"};default:return{state:"UNKNOWN"}}}function k(e){if(!e)return null;let t=e.getTime();return{seconds:t/1e3|0,nanos:t%1e3*1e6}}function A(e){let t=e.getInfo();return{ref:c(e.ref),data:{target:t.target,state:R(t.state),calls_started:t.callTracker.callsStarted,calls_succeeded:t.callTracker.callsSucceeded,calls_failed:t.callTracker.callsFailed,last_call_started_timestamp:k(t.callTracker.lastCallStartedTimestamp),trace:t.trace.getTraceMessage()},channel_ref:t.children.channels.map(e=>c(e)),subchannel_ref:t.children.subchannels.map(e=>u(e))}}function I(e,t){let r=Number.parseInt(e.request.channel_id),i=b[r];void 0===i?t({code:s.Status.NOT_FOUND,details:"No channel data found for id "+r}):t(null,{channel:A(i)})}function O(e,t){let r=Number.parseInt(e.request.max_results),i=[],n=Number.parseInt(e.request.start_channel_id);for(;n<b.length;n++){let e=b[n];if(void 0!==e&&(i.push(A(e)),i.length>=r))break}t(null,{channel:i,end:n>=C.length})}function N(e){let t=e.getInfo();return{ref:h(e.ref),data:{calls_started:t.callTracker.callsStarted,calls_succeeded:t.callTracker.callsSucceeded,calls_failed:t.callTracker.callsFailed,last_call_started_timestamp:k(t.callTracker.lastCallStartedTimestamp),trace:t.trace.getTraceMessage()},listen_socket:t.listenerChildren.sockets.map(e=>d(e))}}function x(e,t){let r=Number.parseInt(e.request.server_id),i=C[r];void 0===i?t({code:s.Status.NOT_FOUND,details:"No server data found for id "+r}):t(null,{server:N(i)})}function D(e,t){let r=Number.parseInt(e.request.max_results),i=[],n=Number.parseInt(e.request.start_server_id);for(;n<C.length;n++){let e=C[n];if(void 0!==e&&(i.push(N(e)),i.length>=r))break}t(null,{server:i,end:n>=C.length})}function P(e,t){let r=Number.parseInt(e.request.subchannel_id),i=S[r];if(void 0===i)return void t({code:s.Status.NOT_FOUND,details:"No subchannel data found for id "+r});let n=i.getInfo();t(null,{subchannel:{ref:u(i.ref),data:{target:n.target,state:R(n.state),calls_started:n.callTracker.callsStarted,calls_succeeded:n.callTracker.callsSucceeded,calls_failed:n.callTracker.callsFailed,last_call_started_timestamp:k(n.callTracker.lastCallStartedTimestamp),trace:n.trace.getTraceMessage()},socket_ref:n.children.sockets.map(e=>d(e))}})}function M(e){var t;return(0,a.isTcpSubchannelAddress)(e)?{address:"tcpip_address",tcpip_address:{ip_address:null!=(t=w(e.host))?t:void 0,port:e.port}}:{address:"uds_address",uds_address:{filename:e.path}}}function L(e,t){var r,i,n,a,o;let l=Number.parseInt(e.request.socket_id),c=T[l];if(void 0===c)return void t({code:s.Status.NOT_FOUND,details:"No socket data found for id "+l});let u=c.getInfo(),h=u.security?{model:"tls",tls:{cipher_suite:u.security.cipherSuiteStandardName?"standard_name":"other_name",standard_name:null!=(r=u.security.cipherSuiteStandardName)?r:void 0,other_name:null!=(i=u.security.cipherSuiteOtherName)?i:void 0,local_certificate:null!=(n=u.security.localCertificate)?n:void 0,remote_certificate:null!=(a=u.security.remoteCertificate)?a:void 0}}:null;t(null,{socket:{ref:d(c.ref),local:u.localAddress?M(u.localAddress):null,remote:u.remoteAddress?M(u.remoteAddress):null,remote_name:null!=(o=u.remoteName)?o:void 0,security:h,data:{keep_alives_sent:u.keepAlivesSent,streams_started:u.streamsStarted,streams_succeeded:u.streamsSucceeded,streams_failed:u.streamsFailed,last_local_stream_created_timestamp:k(u.lastLocalStreamCreatedTimestamp),last_remote_stream_created_timestamp:k(u.lastRemoteStreamCreatedTimestamp),messages_received:u.messagesReceived,messages_sent:u.messagesSent,last_message_received_timestamp:k(u.lastMessageReceivedTimestamp),last_message_sent_timestamp:k(u.lastMessageSentTimestamp),local_flow_control_window:u.localFlowControlWindow?{value:u.localFlowControlWindow}:null,remote_flow_control_window:u.remoteFlowControlWindow?{value:u.remoteFlowControlWindow}:null}}})}function F(e,t){let r=Number.parseInt(e.request.server_id),i=C[r];if(void 0===i)return void t({code:s.Status.NOT_FOUND,details:"No server data found for id "+r});let n=Number.parseInt(e.request.start_socket_id),a=Number.parseInt(e.request.max_results),o=i.getInfo().sessionChildren.sockets.sort((e,t)=>e.id-t.id),l=[],c=0;for(;c<o.length&&(!(o[c].id>=n)||(l.push(d(o[c])),!(l.length>=a)));c++);t(null,{socket_ref:l,end:c>=o.length})}function B(){return{GetChannel:I,GetTopChannels:O,GetServer:x,GetServers:D,GetSubchannel:P,GetSocket:L,GetServerSockets:F}}r.registerChannelzChannel=function(e,t,r){let i=v(),n={id:i,name:e,kind:"channel"};return r&&(b[i]={ref:n,getInfo:t}),n},r.registerChannelzSubchannel=function(e,t,r){let i=v(),n={id:i,name:e,kind:"subchannel"};return r&&(S[i]={ref:n,getInfo:t}),n},r.registerChannelzServer=function(e,t){let r=v(),i={id:r,kind:"server"};return t&&(C[r]={ref:i,getInfo:e}),i},r.registerChannelzSocket=function(e,t,r){let i=v(),n={id:i,name:e,kind:"socket"};return r&&(T[i]={ref:n,getInfo:t}),n},r.unregisterChannelzRef=function(e){switch(e.kind){case"channel":delete b[e.id];return;case"subchannel":delete S[e.id];return;case"server":delete C[e.id];return;case"socket":delete T[e.id];return}},r.getChannelzHandlers=B;let j=null;function U(){if(j)return j;let t=(0,e.r(36458).loadSync)("channelz.proto",{keepCase:!0,longs:String,enums:String,defaults:!0,oneofs:!0,includeDirs:["/ROOT/pro/wine/node_modules/@grpc/grpc-js/build/src/../../proto"]});return j=(0,l.loadPackageDefinition)(t).grpc.channelz.v1.Channelz.service}r.getChannelzServiceDefinition=U,r.setup=function(){(0,o.registerAdminService)(U,B)}},7605,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Subchannel=void 0;let i=e.r(35967),n=e.r(29319),s=e.r(33137),a=e.r(7782),o=e.r(177),l=e.r(76054),c=e.r(23023),u="subchannel",h=0x7fffffff;class d{constructor(e,t,r,s,a){var o;this.channelTarget=e,this.subchannelAddress=t,this.options=r,this.credentials=s,this.connector=a,this.connectivityState=i.ConnectivityState.IDLE,this.transport=null,this.continueConnecting=!1,this.stateListeners=new Set,this.refcount=0,this.channelzEnabled=!0,this.callTracker=new c.ChannelzCallTracker,this.childrenTracker=new c.ChannelzChildrenTracker,this.streamTracker=new c.ChannelzCallTracker;const u={initialDelay:r["grpc.initial_reconnect_backoff_ms"],maxDelay:r["grpc.max_reconnect_backoff_ms"]};this.backoffTimeout=new n.BackoffTimeout(()=>{this.handleBackoffTimer()},u),this.backoffTimeout.unref(),this.subchannelAddressString=(0,l.subchannelAddressToString)(t),this.keepaliveTime=null!=(o=r["grpc.keepalive_time_ms"])?o:-1,0===r["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzTrace=new c.ChannelzTrace,this.channelzRef=(0,c.registerChannelzSubchannel)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Subchannel created"),this.trace("Subchannel constructed with options "+JSON.stringify(r,void 0,2))}getChannelzInfo(){return{state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists(),target:this.subchannelAddressString}}trace(e){s.trace(a.LogVerbosity.DEBUG,u,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}refTrace(e){s.trace(a.LogVerbosity.DEBUG,"subchannel_refcount","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}handleBackoffTimer(){this.continueConnecting?this.transitionToState([i.ConnectivityState.TRANSIENT_FAILURE],i.ConnectivityState.CONNECTING):this.transitionToState([i.ConnectivityState.TRANSIENT_FAILURE],i.ConnectivityState.IDLE)}startBackoff(){this.backoffTimeout.runOnce()}stopBackoff(){this.backoffTimeout.stop(),this.backoffTimeout.reset()}startConnectingInternal(){let e=this.options;if(e["grpc.keepalive_time_ms"]){let t=Math.min(this.keepaliveTime,h);e=Object.assign(Object.assign({},e),{"grpc.keepalive_time_ms":t})}this.connector.connect(this.subchannelAddress,this.credentials,e).then(e=>{this.transitionToState([i.ConnectivityState.CONNECTING],i.ConnectivityState.READY)?(this.transport=e,this.channelzEnabled&&this.childrenTracker.refChild(e.getChannelzRef()),e.addDisconnectListener(e=>{this.transitionToState([i.ConnectivityState.READY],i.ConnectivityState.IDLE),e&&this.keepaliveTime>0&&(this.keepaliveTime*=2,s.log(a.LogVerbosity.ERROR,`Connection to ${(0,o.uriToString)(this.channelTarget)} at ${this.subchannelAddressString} rejected by server because of excess pings. Increasing ping interval to ${this.keepaliveTime} ms`))})):e.shutdown()},e=>{this.transitionToState([i.ConnectivityState.CONNECTING],i.ConnectivityState.TRANSIENT_FAILURE,`${e}`)})}transitionToState(e,t,r){var n,s;if(-1===e.indexOf(this.connectivityState))return!1;this.trace(i.ConnectivityState[this.connectivityState]+" -> "+i.ConnectivityState[t]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+i.ConnectivityState[t]);let a=this.connectivityState;switch(this.connectivityState=t,t){case i.ConnectivityState.READY:this.stopBackoff();break;case i.ConnectivityState.CONNECTING:this.startBackoff(),this.startConnectingInternal(),this.continueConnecting=!1;break;case i.ConnectivityState.TRANSIENT_FAILURE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),null==(n=this.transport)||n.shutdown(),this.transport=null,this.backoffTimeout.isRunning()||process.nextTick(()=>{this.handleBackoffTimer()});break;case i.ConnectivityState.IDLE:this.channelzEnabled&&this.transport&&this.childrenTracker.unrefChild(this.transport.getChannelzRef()),null==(s=this.transport)||s.shutdown(),this.transport=null;break;default:throw Error(`Invalid state: unknown ConnectivityState ${t}`)}for(let e of this.stateListeners)e(this,a,t,this.keepaliveTime,r);return!0}ref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount+1)),this.refcount+=1}unref(){this.refTrace("refcount "+this.refcount+" -> "+(this.refcount-1)),this.refcount-=1,0===this.refcount&&(this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Shutting down"),this.channelzEnabled&&(0,c.unregisterChannelzRef)(this.channelzRef),process.nextTick(()=>{this.transitionToState([i.ConnectivityState.CONNECTING,i.ConnectivityState.READY],i.ConnectivityState.IDLE)}))}unrefIfOneRef(){return 1===this.refcount&&(this.unref(),!0)}createCall(e,t,r,i){let n;if(!this.transport)throw Error("Cannot create call, subchannel not READY");return this.channelzEnabled?(this.callTracker.addCallStarted(),this.streamTracker.addCallStarted(),n={onCallEnd:e=>{e.code===a.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}}):n={},this.transport.createCall(e,t,r,i,n)}startConnecting(){process.nextTick(()=>{this.transitionToState([i.ConnectivityState.IDLE],i.ConnectivityState.CONNECTING)||this.connectivityState!==i.ConnectivityState.TRANSIENT_FAILURE||(this.continueConnecting=!0)})}getConnectivityState(){return this.connectivityState}addConnectivityStateListener(e){this.stateListeners.add(e)}removeConnectivityStateListener(e){this.stateListeners.delete(e)}resetBackoff(){process.nextTick(()=>{this.backoffTimeout.reset(),this.transitionToState([i.ConnectivityState.TRANSIENT_FAILURE],i.ConnectivityState.CONNECTING)})}getAddress(){return this.subchannelAddressString}getChannelzRef(){return this.channelzRef}getRealSubchannel(){return this}realSubchannelEquals(e){return e.getRealSubchannel()===this}throttleKeepalive(e){e>this.keepaliveTime&&(this.keepaliveTime=e)}}r.Subchannel=d},27476,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.setup=r.DEFAULT_PORT=void 0;let i=e.r(54718),n=e.r(79594),s=e.r(24361),a=e.r(63361),o=e.r(7782),l=e.r(10409),c=e.r(33137),u=e.r(7782),h=e.r(177),d=e.r(4446),f=e.r(29319),p="dns_resolver";function m(e){c.trace(u.LogVerbosity.DEBUG,p,e)}r.DEFAULT_PORT=443;let g=3e4,y=s.promisify(n.resolveTxt),v=s.promisify(n.lookup);function b(...e){let t=[];for(let r=0;r<Math.max.apply(null,e.map(e=>e.length));r++)for(let i of e)r<i.length&&t.push(i[r]);return t}class S{constructor(e,t,i){var n,s,a;this.target=e,this.listener=t,this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.continueResolving=!1,this.isNextResolutionTimerRunning=!1,this.isServiceConfigEnabled=!0,this.returnedIpResult=!1,m("Resolver constructed for target "+(0,h.uriToString)(e));const c=(0,h.splitHostPort)(e.path);null===c?(this.ipResult=null,this.dnsHostname=null,this.port=null):(0,d.isIPv4)(c.host)||(0,d.isIPv6)(c.host)?(this.ipResult=[{host:c.host,port:null!=(n=c.port)?n:r.DEFAULT_PORT}],this.dnsHostname=null,this.port=null):(this.ipResult=null,this.dnsHostname=c.host,this.port=null!=(s=c.port)?s:r.DEFAULT_PORT),this.percentage=100*Math.random(),1===i["grpc.service_config_disable_resolution"]&&(this.isServiceConfigEnabled=!1),this.defaultResolutionError={code:o.Status.UNAVAILABLE,details:`Name resolution failed for target ${(0,h.uriToString)(this.target)}`,metadata:new l.Metadata};const u={initialDelay:i["grpc.initial_reconnect_backoff_ms"],maxDelay:i["grpc.max_reconnect_backoff_ms"]};this.backoff=new f.BackoffTimeout(()=>{this.continueResolving&&this.startResolutionWithBackoff()},u),this.backoff.unref(),this.minTimeBetweenResolutionsMs=null!=(a=i["grpc.dns_min_time_between_resolutions_ms"])?a:g,this.nextResolutionTimer=setTimeout(()=>{},0),clearTimeout(this.nextResolutionTimer)}startResolution(){if(null!==this.ipResult){this.returnedIpResult||(m("Returning IP address for target "+(0,h.uriToString)(this.target)),setImmediate(()=>{this.listener.onSuccessfulResolution(this.ipResult,null,null,null,{})}),this.returnedIpResult=!0),this.backoff.stop(),this.backoff.reset(),this.stopNextResolutionTimer();return}if(null===this.dnsHostname)m("Failed to parse DNS address "+(0,h.uriToString)(this.target)),setImmediate(()=>{this.listener.onError({code:o.Status.UNAVAILABLE,details:`Failed to parse DNS address ${(0,h.uriToString)(this.target)}`,metadata:new l.Metadata})}),this.stopNextResolutionTimer();else{if(null!==this.pendingLookupPromise)return;m("Looking up DNS hostname "+this.dnsHostname),this.latestLookupResult=null;let e=this.dnsHostname;this.pendingLookupPromise=v(e,{all:!0}),this.pendingLookupPromise.then(e=>{if(null===this.pendingLookupPromise)return;this.pendingLookupPromise=null,this.backoff.reset(),this.backoff.stop();let t=e.filter(e=>4===e.family),r=e.filter(e=>6===e.family);this.latestLookupResult=b(r,t).map(e=>({host:e.address,port:+this.port}));let i="["+this.latestLookupResult.map(e=>e.host+":"+e.port).join(",")+"]";(m("Resolved addresses for target "+(0,h.uriToString)(this.target)+": "+i),0===this.latestLookupResult.length)?this.listener.onError(this.defaultResolutionError):this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})},e=>{null!==this.pendingLookupPromise&&(m("Resolution error for target "+(0,h.uriToString)(this.target)+": "+e.message),this.pendingLookupPromise=null,this.stopNextResolutionTimer(),this.listener.onError(this.defaultResolutionError))}),this.isServiceConfigEnabled&&null===this.pendingTxtPromise&&(this.pendingTxtPromise=y(e),this.pendingTxtPromise.then(e=>{if(null!==this.pendingTxtPromise){this.pendingTxtPromise=null;try{this.latestServiceConfig=(0,a.extractAndSelectServiceConfig)(e,this.percentage)}catch(e){this.latestServiceConfigError={code:o.Status.UNAVAILABLE,details:`Parsing service config failed with error ${e.message}`,metadata:new l.Metadata}}null!==this.latestLookupResult&&this.listener.onSuccessfulResolution(this.latestLookupResult,this.latestServiceConfig,this.latestServiceConfigError,null,{})}},e=>{}))}}startNextResolutionTimer(){var e,t;clearTimeout(this.nextResolutionTimer),this.nextResolutionTimer=null==(t=(e=setTimeout(()=>{this.stopNextResolutionTimer(),this.continueResolving&&this.startResolutionWithBackoff()},this.minTimeBetweenResolutionsMs)).unref)?void 0:t.call(e),this.isNextResolutionTimerRunning=!0}stopNextResolutionTimer(){clearTimeout(this.nextResolutionTimer),this.isNextResolutionTimerRunning=!1}startResolutionWithBackoff(){null===this.pendingLookupPromise&&(this.continueResolving=!1,this.backoff.runOnce(),this.startNextResolutionTimer(),this.startResolution())}updateResolution(){null===this.pendingLookupPromise&&(this.isNextResolutionTimerRunning||this.backoff.isRunning()?(this.isNextResolutionTimerRunning?m('resolution update delayed by "min time between resolutions" rate limit'):m("resolution update delayed by backoff timer until "+this.backoff.getEndTime().toISOString()),this.continueResolving=!0):this.startResolutionWithBackoff())}destroy(){this.continueResolving=!1,this.backoff.reset(),this.backoff.stop(),this.stopNextResolutionTimer(),this.pendingLookupPromise=null,this.pendingTxtPromise=null,this.latestLookupResult=null,this.latestServiceConfig=null,this.latestServiceConfigError=null,this.returnedIpResult=!1}static getDefaultAuthority(e){return e.path}}r.setup=function(){(0,i.registerResolver)("dns",S),(0,i.registerDefaultScheme)("dns")}},36913,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getProxiedConnection=r.mapProxyName=void 0;let i=e.r(33137),n=e.r(7782),s=e.r(54718),a=e.r(21517),o=e.r(55004),l=e.r(33137),c=e.r(76054),u=e.r(177),h=e.r(92509),d=e.r(27476),f="proxy";function p(e){l.trace(n.LogVerbosity.DEBUG,f,e)}function m(){let e,t="",r="";if(process.env.grpc_proxy)r="grpc_proxy",t=process.env.grpc_proxy;else if(process.env.https_proxy)r="https_proxy",t=process.env.https_proxy;else{if(!process.env.http_proxy)return{};r="http_proxy",t=process.env.http_proxy}try{e=new h.URL(t)}catch(e){return(0,i.log)(n.LogVerbosity.ERROR,`cannot parse value of "${r}" env var`),{}}if("http:"!==e.protocol)return(0,i.log)(n.LogVerbosity.ERROR,`"${e.protocol}" scheme not supported in proxy URI`),{};let s=null;e.username&&(e.password?((0,i.log)(n.LogVerbosity.INFO,"userinfo found in proxy URI"),s=`${e.username}:${e.password}`):s=e.username);let a=e.hostname,o=e.port;""===o&&(o="80");let l={address:`${a}:${o}`};return s&&(l.creds=s),p("Proxy server "+l.address+" set by environment variable "+r),l}function g(){let e=process.env.no_grpc_proxy,t="no_grpc_proxy";return(e||(e=process.env.no_proxy,t="no_proxy"),e)?(p("No proxy server list set by environment variable "+t),e.split(",")):[]}r.mapProxyName=function(e,t){var r;let i={target:e,extraOptions:{}};if((null!=(r=t["grpc.enable_http_proxy"])?r:1)===0||"unix"===e.scheme)return i;let n=m();if(!n.address)return i;let s=(0,u.splitHostPort)(e.path);if(!s)return i;let a=s.host;for(let t of g())if(t===a)return p("Not using proxy for target in no_proxy list: "+(0,u.uriToString)(e)),i;let o={"grpc.http_connect_target":(0,u.uriToString)(e)};return n.creds&&(o["grpc.http_connect_creds"]=n.creds),{target:{scheme:"dns",path:n.address},extraOptions:o}},r.getProxiedConnection=function(e,t,r){var l;if(!("grpc.http_connect_target"in t))return Promise.resolve({});let h=t["grpc.http_connect_target"],f=(0,u.parseUri)(h);if(null===f)return Promise.resolve({});let m=(0,u.splitHostPort)(f.path);if(null===m)return Promise.resolve({});let g=`${m.host}:${null!=(l=m.port)?l:d.DEFAULT_PORT}`,y={method:"CONNECT",path:g},v={Host:g};(0,c.isTcpSubchannelAddress)(e)?(y.host=e.host,y.port=e.port):y.socketPath=e.path,"grpc.http_connect_creds"in t&&(v["Proxy-Authorization"]="Basic "+Buffer.from(t["grpc.http_connect_creds"]).toString("base64")),y.headers=v;let b=(0,c.subchannelAddressToString)(e);return p("Using proxy "+b+" to connect to "+y.path),new Promise((e,t)=>{let l=a.request(y);l.once("connect",(a,c,h)=>{var d;if(l.removeAllListeners(),c.removeAllListeners(),200===a.statusCode)if(p("Successfully connected to "+y.path+" through proxy "+b),"secureContext"in r){let i=(0,s.getDefaultAuthority)(f),n=(0,u.splitHostPort)(i),a=null!=(d=null==n?void 0:n.host)?d:i,l=o.connect(Object.assign({host:a,servername:a,socket:c},r),()=>{p("Successfully established a TLS connection to "+y.path+" through proxy "+b),e({socket:l,realTarget:f})});l.on("error",e=>{p("Failed to establish a TLS connection to "+y.path+" through proxy "+b+" with error "+e.message),t()})}else p("Successfully established a plaintext connection to "+y.path+" through proxy "+b),e({socket:c,realTarget:f});else(0,i.log)(n.LogVerbosity.ERROR,"Failed to connect to "+y.path+" through proxy "+b+" with status "+a.statusCode),t()}),l.once("error",e=>{l.removeAllListeners(),(0,i.log)(n.LogVerbosity.ERROR,"Failed to connect to proxy "+b+" with error "+e.message),t()}),l.end()})}},80983,(e,t,r)=>{"use strict";var i;Object.defineProperty(r,"__esModule",{value:!0}),r.StreamDecoder=void 0,function(e){e[e.NO_DATA=0]="NO_DATA",e[e.READING_SIZE=1]="READING_SIZE",e[e.READING_MESSAGE=2]="READING_MESSAGE"}(i||(i={}));class n{constructor(e){this.maxReadMessageLength=e,this.readState=i.NO_DATA,this.readCompressFlag=Buffer.alloc(1),this.readPartialSize=Buffer.alloc(4),this.readSizeRemaining=4,this.readMessageSize=0,this.readPartialMessage=[],this.readMessageRemaining=0}write(e){let t,r=0,n=[];for(;r<e.length;)switch(this.readState){case i.NO_DATA:this.readCompressFlag=e.slice(r,r+1),r+=1,this.readState=i.READING_SIZE,this.readPartialSize.fill(0),this.readSizeRemaining=4,this.readMessageSize=0,this.readMessageRemaining=0,this.readPartialMessage=[];break;case i.READING_SIZE:if(t=Math.min(e.length-r,this.readSizeRemaining),e.copy(this.readPartialSize,4-this.readSizeRemaining,r,r+t),this.readSizeRemaining-=t,r+=t,0===this.readSizeRemaining){if(this.readMessageSize=this.readPartialSize.readUInt32BE(0),-1!==this.maxReadMessageLength&&this.readMessageSize>this.maxReadMessageLength)throw Error(`Received message larger than max (${this.readMessageSize} vs ${this.maxReadMessageLength})`);if(this.readMessageRemaining=this.readMessageSize,this.readMessageRemaining>0)this.readState=i.READING_MESSAGE;else{let e=Buffer.concat([this.readCompressFlag,this.readPartialSize],5);this.readState=i.NO_DATA,n.push(e)}}break;case i.READING_MESSAGE:if(t=Math.min(e.length-r,this.readMessageRemaining),this.readPartialMessage.push(e.slice(r,r+t)),this.readMessageRemaining-=t,r+=t,0===this.readMessageRemaining){let e=[this.readCompressFlag,this.readPartialSize].concat(this.readPartialMessage),t=Buffer.concat(e,this.readMessageSize+5);this.readState=i.NO_DATA,n.push(t)}break;default:throw Error("Unexpected read state")}return n}}r.StreamDecoder=n},20395,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Http2SubchannelCall=void 0;let i=e.r(25328),n=e.r(46786),s=e.r(7782),a=e.r(10409),o=e.r(80983),l=e.r(33137),c=e.r(7782),u="subchannel_call";function h(e){for(let[t,r]of Object.entries(n.constants.errno))if(r===e)return t;return"Unknown system error "+e}class d{constructor(e,t,r,n,l){var c;this.http2Stream=e,this.callEventTracker=t,this.listener=r,this.transport=n,this.callId=l,this.isReadFilterPending=!1,this.isPushPending=!1,this.canPush=!1,this.readsClosed=!1,this.statusOutput=!1,this.unpushedReadMessages=[],this.mappedStatusCode=s.Status.UNKNOWN,this.finalStatus=null,this.internalError=null;const u=null!=(c=n.getOptions()["grpc.max_receive_message_length"])?c:s.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH;this.decoder=new o.StreamDecoder(u),e.on("response",(e,t)=>{let r="";for(let t of Object.keys(e))r+="		"+t+": "+e[t]+"\n";switch(this.trace("Received server headers:\n"+r),e[":status"]){case 400:this.mappedStatusCode=s.Status.INTERNAL;break;case 401:this.mappedStatusCode=s.Status.UNAUTHENTICATED;break;case 403:this.mappedStatusCode=s.Status.PERMISSION_DENIED;break;case 404:this.mappedStatusCode=s.Status.UNIMPLEMENTED;break;case 429:case 502:case 503:case 504:this.mappedStatusCode=s.Status.UNAVAILABLE;break;default:this.mappedStatusCode=s.Status.UNKNOWN}if(t&i.constants.NGHTTP2_FLAG_END_STREAM)this.handleTrailers(e);else{let t;try{t=a.Metadata.fromHttp2Headers(e)}catch(e){this.endCall({code:s.Status.UNKNOWN,details:e.message,metadata:new a.Metadata});return}this.listener.onReceiveMetadata(t)}}),e.on("trailers",e=>{this.handleTrailers(e)}),e.on("data",e=>{let t;if(!this.statusOutput){this.trace("receive HTTP/2 data frame of length "+e.length);try{t=this.decoder.write(e)}catch(e){this.cancelWithStatus(s.Status.RESOURCE_EXHAUSTED,e.message);return}for(let e of t)this.trace("parsed message of length "+e.length),this.callEventTracker.addMessageReceived(),this.tryPush(e)}}),e.on("end",()=>{this.readsClosed=!0,this.maybeOutputStatus()}),e.on("close",()=>{process.nextTick(()=>{var t;let r;if(this.trace("HTTP/2 stream closed with code "+e.rstCode),(null==(t=this.finalStatus)?void 0:t.code)===s.Status.OK)return;let n="";switch(e.rstCode){case i.constants.NGHTTP2_NO_ERROR:if(null!==this.finalStatus)return;r=s.Status.INTERNAL,n=`Received RST_STREAM with code ${e.rstCode}`;break;case i.constants.NGHTTP2_REFUSED_STREAM:r=s.Status.UNAVAILABLE,n="Stream refused by server";break;case i.constants.NGHTTP2_CANCEL:r=s.Status.CANCELLED,n="Call cancelled";break;case i.constants.NGHTTP2_ENHANCE_YOUR_CALM:r=s.Status.RESOURCE_EXHAUSTED,n="Bandwidth exhausted or memory limit exceeded";break;case i.constants.NGHTTP2_INADEQUATE_SECURITY:r=s.Status.PERMISSION_DENIED,n="Protocol not secure enough";break;case i.constants.NGHTTP2_INTERNAL_ERROR:r=s.Status.INTERNAL,null===this.internalError?n=`Received RST_STREAM with code ${e.rstCode} (Internal server error)`:"ECONNRESET"===this.internalError.code||"ETIMEDOUT"===this.internalError.code?(r=s.Status.UNAVAILABLE,n=this.internalError.message):n=`Received RST_STREAM with code ${e.rstCode} triggered by internal client error: ${this.internalError.message}`;break;default:r=s.Status.INTERNAL,n=`Received RST_STREAM with code ${e.rstCode}`}this.endCall({code:r,details:n,metadata:new a.Metadata,rstCode:e.rstCode})})}),e.on("error",e=>{"ERR_HTTP2_STREAM_ERROR"!==e.code&&(this.trace("Node error event: message="+e.message+" code="+e.code+" errno="+h(e.errno)+" syscall="+e.syscall),this.internalError=e),this.callEventTracker.onStreamEnd(!1)})}onDisconnect(){this.endCall({code:s.Status.UNAVAILABLE,details:"Connection dropped",metadata:new a.Metadata})}outputStatus(){this.statusOutput||(this.statusOutput=!0,this.trace("ended with status: code="+this.finalStatus.code+' details="'+this.finalStatus.details+'"'),this.callEventTracker.onCallEnd(this.finalStatus),process.nextTick(()=>{this.listener.onReceiveStatus(this.finalStatus)}),this.http2Stream.resume())}trace(e){l.trace(c.LogVerbosity.DEBUG,u,"["+this.callId+"] "+e)}endCall(e){(null===this.finalStatus||this.finalStatus.code===s.Status.OK)&&(this.finalStatus=e,this.maybeOutputStatus()),this.destroyHttp2Stream()}maybeOutputStatus(){null===this.finalStatus||this.finalStatus.code===s.Status.OK&&(!this.readsClosed||0!==this.unpushedReadMessages.length||this.isReadFilterPending||this.isPushPending)||this.outputStatus()}push(e){this.trace("pushing to reader message of length "+(e instanceof Buffer?e.length:null)),this.canPush=!1,this.isPushPending=!0,process.nextTick(()=>{this.isPushPending=!1,this.statusOutput||(this.listener.onReceiveMessage(e),this.maybeOutputStatus())})}tryPush(e){this.canPush?(this.http2Stream.pause(),this.push(e)):(this.trace("unpushedReadMessages.push message of length "+e.length),this.unpushedReadMessages.push(e))}handleTrailers(e){let t;this.callEventTracker.onStreamEnd(!0);let r="";for(let t of Object.keys(e))r+="		"+t+": "+e[t]+"\n";this.trace("Received server trailers:\n"+r);try{t=a.Metadata.fromHttp2Headers(e)}catch(e){t=new a.Metadata}let i=t.getMap(),n=this.mappedStatusCode;if(n===s.Status.UNKNOWN&&"string"==typeof i["grpc-status"]){let e=Number(i["grpc-status"]);e in s.Status&&(n=e,this.trace("received status code "+e+" from server")),t.remove("grpc-status")}let o="";if("string"==typeof i["grpc-message"]){try{o=decodeURI(i["grpc-message"])}catch(e){o=i["grpc-message"]}t.remove("grpc-message"),this.trace('received status details string "'+o+'" from server')}let l={code:n,details:o,metadata:t};this.endCall(l)}destroyHttp2Stream(){var e;if(!this.http2Stream.destroyed){let t;t=(null==(e=this.finalStatus)?void 0:e.code)===s.Status.OK?i.constants.NGHTTP2_NO_ERROR:i.constants.NGHTTP2_CANCEL,this.trace("close http2 stream with code "+t),this.http2Stream.close(t)}}cancelWithStatus(e,t){this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),this.endCall({code:e,details:t,metadata:new a.Metadata})}getStatus(){return this.finalStatus}getPeer(){return this.transport.getPeerName()}getCallNumber(){return this.callId}startRead(){if(null!==this.finalStatus&&this.finalStatus.code!==s.Status.OK){this.readsClosed=!0,this.maybeOutputStatus();return}if(this.canPush=!0,this.unpushedReadMessages.length>0){let e=this.unpushedReadMessages.shift();this.push(e);return}this.http2Stream.resume()}sendMessageWithContext(e,t){this.trace("write() called with message of length "+t.length);let r=t=>{process.nextTick(()=>{var r;let i=s.Status.UNAVAILABLE;(null==t?void 0:t.code)==="ERR_STREAM_WRITE_AFTER_END"&&(i=s.Status.INTERNAL),t&&this.cancelWithStatus(i,`Write error: ${t.message}`),null==(r=e.callback)||r.call(e)})};this.trace("sending data chunk of length "+t.length),this.callEventTracker.addMessageSent();try{this.http2Stream.write(t,r)}catch(e){this.endCall({code:s.Status.UNAVAILABLE,details:`Write failed with error ${e.message}`,metadata:new a.Metadata})}}halfClose(){this.trace("end() called"),this.trace("calling end() on HTTP/2 stream"),this.http2Stream.end()}}r.Http2SubchannelCall=d},13038,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getNextCallNumber=void 0;let i=0;r.getNextCallNumber=function(){return i++}},59581,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Http2SubchannelConnector=void 0;let i=e.r(25328),n=e.r(55004),s=e.r(23023),a=e.r(7782),o=e.r(36913),l=e.r(33137),c=e.r(54718),u=e.r(76054),h=e.r(177),d=e.r(4446),f=e.r(20395),p=e.r(13038),m="transport",g="transport_flowctrl",y=e.r(65748).version,{HTTP2_HEADER_AUTHORITY:v,HTTP2_HEADER_CONTENT_TYPE:b,HTTP2_HEADER_METHOD:S,HTTP2_HEADER_PATH:C,HTTP2_HEADER_TE:T,HTTP2_HEADER_USER_AGENT:E}=i.constants,_=2e4,w=Buffer.from("too_many_pings","ascii");class R{constructor(e,t,r,n){this.session=e,this.options=r,this.remoteName=n,this.keepaliveTimeMs=-1,this.keepaliveTimeoutMs=_,this.keepaliveTimerId=null,this.pendingSendKeepalivePing=!1,this.keepaliveTimeoutId=null,this.keepaliveWithoutCalls=!1,this.activeCalls=new Set,this.disconnectListeners=[],this.disconnectHandled=!1,this.channelzEnabled=!0,this.streamTracker=new s.ChannelzCallTracker,this.keepalivesSent=0,this.messagesSent=0,this.messagesReceived=0,this.lastMessageSentTimestamp=null,this.lastMessageReceivedTimestamp=null,this.subchannelAddressString=(0,u.subchannelAddressToString)(t),0===r["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzRef=(0,s.registerChannelzSocket)(this.subchannelAddressString,()=>this.getChannelzInfo(),this.channelzEnabled),this.userAgent=[r["grpc.primary_user_agent"],`grpc-node-js/${y}`,r["grpc.secondary_user_agent"]].filter(e=>e).join(" "),"grpc.keepalive_time_ms"in r&&(this.keepaliveTimeMs=r["grpc.keepalive_time_ms"]),"grpc.keepalive_timeout_ms"in r&&(this.keepaliveTimeoutMs=r["grpc.keepalive_timeout_ms"]),"grpc.keepalive_permit_without_calls"in r?this.keepaliveWithoutCalls=1===r["grpc.keepalive_permit_without_calls"]:this.keepaliveWithoutCalls=!1,e.once("close",()=>{this.trace("session closed"),this.stopKeepalivePings(),this.handleDisconnect()}),e.once("goaway",(e,t,r)=>{let n=!1;e===i.constants.NGHTTP2_ENHANCE_YOUR_CALM&&r&&r.equals(w)&&(n=!0),this.trace("connection closed by GOAWAY with code "+e+" and data "+(null==r?void 0:r.toString())),this.reportDisconnectToOwner(n)}),e.once("error",e=>{this.trace("connection closed with error "+e.message)}),l.isTracerEnabled(m)&&(e.on("remoteSettings",t=>{this.trace("new settings received"+(this.session!==e?" on the old connection":"")+": "+JSON.stringify(t))}),e.on("localSettings",t=>{this.trace("local settings acknowledged by remote"+(this.session!==e?" on the old connection":"")+": "+JSON.stringify(t))})),this.keepaliveWithoutCalls&&this.maybeStartKeepalivePingTimer()}getChannelzInfo(){var e,t,r;let i,n=this.session.socket,s=n.remoteAddress?(0,u.stringToSubchannelAddress)(n.remoteAddress,n.remotePort):null,a=n.localAddress?(0,u.stringToSubchannelAddress)(n.localAddress,n.localPort):null;if(this.session.encrypted){let t=n,r=t.getCipher(),s=t.getCertificate(),a=t.getPeerCertificate();i={cipherSuiteStandardName:null!=(e=r.standardName)?e:null,cipherSuiteOtherName:r.standardName?null:r.name,localCertificate:s&&"raw"in s?s.raw:null,remoteCertificate:a&&"raw"in a?a.raw:null}}else i=null;return{remoteAddress:s,localAddress:a,security:i,remoteName:this.remoteName,streamsStarted:this.streamTracker.callsStarted,streamsSucceeded:this.streamTracker.callsSucceeded,streamsFailed:this.streamTracker.callsFailed,messagesSent:this.messagesSent,messagesReceived:this.messagesReceived,keepAlivesSent:this.keepalivesSent,lastLocalStreamCreatedTimestamp:this.streamTracker.lastCallStartedTimestamp,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:this.lastMessageSentTimestamp,lastMessageReceivedTimestamp:this.lastMessageReceivedTimestamp,localFlowControlWindow:null!=(t=this.session.state.localWindowSize)?t:null,remoteFlowControlWindow:null!=(r=this.session.state.remoteWindowSize)?r:null}}trace(e){l.trace(a.LogVerbosity.DEBUG,m,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}keepaliveTrace(e){l.trace(a.LogVerbosity.DEBUG,"keepalive","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}flowControlTrace(e){l.trace(a.LogVerbosity.DEBUG,g,"("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}internalsTrace(e){l.trace(a.LogVerbosity.DEBUG,"transport_internals","("+this.channelzRef.id+") "+this.subchannelAddressString+" "+e)}reportDisconnectToOwner(e){this.disconnectHandled||(this.disconnectHandled=!0,this.disconnectListeners.forEach(t=>t(e)))}handleDisconnect(){this.reportDisconnectToOwner(!1),setImmediate(()=>{for(let e of this.activeCalls)e.onDisconnect()})}addDisconnectListener(e){this.disconnectListeners.push(e)}clearKeepaliveTimer(){this.keepaliveTimerId&&(clearTimeout(this.keepaliveTimerId),this.keepaliveTimerId=null)}clearKeepaliveTimeout(){this.keepaliveTimeoutId&&(clearTimeout(this.keepaliveTimeoutId),this.keepaliveTimeoutId=null)}canSendPing(){return this.keepaliveTimeMs>0&&(this.keepaliveWithoutCalls||this.activeCalls.size>0)}maybeSendPing(){var e,t;if(this.clearKeepaliveTimer(),!this.canSendPing()){this.pendingSendKeepalivePing=!0;return}this.channelzEnabled&&(this.keepalivesSent+=1),this.keepaliveTrace("Sending ping with timeout "+this.keepaliveTimeoutMs+"ms"),this.keepaliveTimeoutId||(this.keepaliveTimeoutId=setTimeout(()=>{this.keepaliveTrace("Ping timeout passed without response"),this.handleDisconnect()},this.keepaliveTimeoutMs),null==(t=(e=this.keepaliveTimeoutId).unref)||t.call(e));try{this.session.ping((e,t,r)=>{e&&(this.keepaliveTrace("Ping failed with error "+e.message),this.handleDisconnect()),this.keepaliveTrace("Received ping response"),this.clearKeepaliveTimeout(),this.maybeStartKeepalivePingTimer()})}catch(e){this.handleDisconnect()}}maybeStartKeepalivePingTimer(){var e,t;this.canSendPing()&&(this.pendingSendKeepalivePing?(this.pendingSendKeepalivePing=!1,this.maybeSendPing()):this.keepaliveTimerId||this.keepaliveTimeoutId||(this.keepaliveTrace("Starting keepalive timer for "+this.keepaliveTimeMs+"ms"),this.keepaliveTimerId=null==(t=(e=setTimeout(()=>{this.maybeSendPing()},this.keepaliveTimeMs)).unref)?void 0:t.call(e)))}stopKeepalivePings(){this.keepaliveTimerId&&(clearTimeout(this.keepaliveTimerId),this.keepaliveTimerId=null),this.clearKeepaliveTimeout()}removeActiveCall(e){this.activeCalls.delete(e),0===this.activeCalls.size&&this.session.unref()}addActiveCall(e){this.activeCalls.add(e),1===this.activeCalls.size&&(this.session.ref(),this.keepaliveWithoutCalls||this.maybeStartKeepalivePingTimer())}createCall(e,t,r,i,n){let s,a,o,l=e.toHttp2Headers();l[v]=t,l[E]=this.userAgent,l[b]="application/grpc",l[S]="POST",l[C]=r,l[T]="trailers";try{s=this.session.request(l)}catch(e){throw this.handleDisconnect(),e}return this.flowControlTrace("local window size: "+this.session.state.localWindowSize+" remote window size: "+this.session.state.remoteWindowSize),this.internalsTrace("session.closed="+this.session.closed+" session.destroyed="+this.session.destroyed+" session.socket.destroyed="+this.session.socket.destroyed),this.channelzEnabled?(this.streamTracker.addCallStarted(),a={addMessageSent:()=>{var e;this.messagesSent+=1,this.lastMessageSentTimestamp=new Date,null==(e=n.addMessageSent)||e.call(n)},addMessageReceived:()=>{var e;this.messagesReceived+=1,this.lastMessageReceivedTimestamp=new Date,null==(e=n.addMessageReceived)||e.call(n)},onCallEnd:e=>{var t;null==(t=n.onCallEnd)||t.call(n,e),this.removeActiveCall(o)},onStreamEnd:e=>{var t;e?this.streamTracker.addCallSucceeded():this.streamTracker.addCallFailed(),null==(t=n.onStreamEnd)||t.call(n,e)}}):a={addMessageSent:()=>{var e;null==(e=n.addMessageSent)||e.call(n)},addMessageReceived:()=>{var e;null==(e=n.addMessageReceived)||e.call(n)},onCallEnd:e=>{var t;null==(t=n.onCallEnd)||t.call(n,e),this.removeActiveCall(o)},onStreamEnd:e=>{var t;null==(t=n.onStreamEnd)||t.call(n,e)}},o=new f.Http2SubchannelCall(s,a,i,this,(0,p.getNextCallNumber)()),this.addActiveCall(o),o}getChannelzRef(){return this.channelzRef}getPeerName(){return this.subchannelAddressString}getOptions(){return this.options}shutdown(){this.session.close(),(0,s.unregisterChannelzRef)(this.channelzRef)}}class k{constructor(e){this.channelTarget=e,this.session=null,this.isShutdown=!1}trace(e){l.trace(a.LogVerbosity.DEBUG,m,(0,h.uriToString)(this.channelTarget)+" "+e)}createSession(e,t,r,s){return this.isShutdown?Promise.reject():new Promise((a,o)=>{var l,f,p;let m;s.realTarget?(m=(0,h.uriToString)(s.realTarget),this.trace("creating HTTP/2 session through proxy to "+(0,h.uriToString)(s.realTarget))):(m=null,this.trace("creating HTTP/2 session to "+(0,u.subchannelAddressToString)(e)));let g=(0,c.getDefaultAuthority)(null!=(l=s.realTarget)?l:this.channelTarget),y=t._getConnectionOptions()||{};y.maxSendHeaderBlockLength=Number.MAX_SAFE_INTEGER,"grpc-node.max_session_memory"in r?y.maxSessionMemory=r["grpc-node.max_session_memory"]:y.maxSessionMemory=Number.MAX_SAFE_INTEGER;let v="http://";if("secureContext"in y){if(v="https://",r["grpc.ssl_target_name_override"]){let e=r["grpc.ssl_target_name_override"];y.checkServerIdentity=(t,r)=>(0,n.checkServerIdentity)(e,r),y.servername=e}else{let e=null!=(p=null==(f=(0,h.splitHostPort)(g))?void 0:f.host)?p:"localhost";y.servername=e}s.socket&&(y.createConnection=(e,t)=>s.socket)}else y.createConnection=(t,r)=>s.socket?s.socket:d.connect(e);y=Object.assign(Object.assign(Object.assign({},y),e),{enableTrace:1===r["grpc-node.tls_enable_trace"]});let b=i.connect(v+g,y);this.session=b;let S="Failed to connect";b.unref(),b.once("connect",()=>{b.removeAllListeners(),a(new R(b,e,r,m)),this.session=null}),b.once("close",()=>{this.session=null,setImmediate(()=>{o(`${S} (${new Date().toISOString()})`)})}),b.once("error",e=>{S=e.message,this.trace("connection failed with error "+S)})})}connect(e,t,r){var i,s;if(this.isShutdown)return Promise.reject();let a=t._getConnectionOptions()||{};if("secureContext"in a){if(a.ALPNProtocols=["h2"],r["grpc.ssl_target_name_override"]){let e=r["grpc.ssl_target_name_override"];a.checkServerIdentity=(t,r)=>(0,n.checkServerIdentity)(e,r),a.servername=e}else if("grpc.http_connect_target"in r){let e=(0,c.getDefaultAuthority)(null!=(i=(0,h.parseUri)(r["grpc.http_connect_target"]))?i:{path:"localhost"}),t=(0,h.splitHostPort)(e);a.servername=null!=(s=null==t?void 0:t.host)?s:e}r["grpc-node.tls_enable_trace"]&&(a.enableTrace=!0)}return(0,o.getProxiedConnection)(e,r,a).then(i=>this.createSession(e,t,r,i))}shutdown(){var e;this.isShutdown=!0,null==(e=this.session)||e.close(),this.session=null}}r.Http2SubchannelConnector=k},4214,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.getSubchannelPool=r.SubchannelPool=void 0;let i=e.r(65101),n=e.r(7605),s=e.r(76054),a=e.r(177),o=e.r(59581),l=1e4;class c{constructor(){this.pool=Object.create(null),this.cleanupTimer=null}unrefUnusedSubchannels(){let e=!0;for(let t in this.pool){let r=this.pool[t].filter(e=>!e.subchannel.unrefIfOneRef());r.length>0&&(e=!1),this.pool[t]=r}e&&null!==this.cleanupTimer&&(clearInterval(this.cleanupTimer),this.cleanupTimer=null)}ensureCleanupTask(){var e,t;null===this.cleanupTimer&&(this.cleanupTimer=setInterval(()=>{this.unrefUnusedSubchannels()},l),null==(t=(e=this.cleanupTimer).unref)||t.call(e))}getOrCreateSubchannel(e,t,r,l){this.ensureCleanupTask();let c=(0,a.uriToString)(e);if(c in this.pool){for(let e of this.pool[c])if((0,s.subchannelAddressEqual)(t,e.subchannelAddress)&&(0,i.channelOptionsEqual)(r,e.channelArguments)&&l._equals(e.channelCredentials))return e.subchannel}let u=new n.Subchannel(e,t,r,l,new o.Http2SubchannelConnector(e));return c in this.pool||(this.pool[c]=[]),this.pool[c].push({subchannelAddress:t,channelArguments:r,channelCredentials:l,subchannel:u}),u.ref(),u}}r.SubchannelPool=c;let u=new c;r.getSubchannelPool=function(e){return e?u:new c}},60807,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.FilterStackFactory=r.FilterStack=void 0;class i{constructor(e){this.filters=e}sendMetadata(e){let t=e;for(let e=0;e<this.filters.length;e++)t=this.filters[e].sendMetadata(t);return t}receiveMetadata(e){let t=e;for(let e=this.filters.length-1;e>=0;e--)t=this.filters[e].receiveMetadata(t);return t}sendMessage(e){let t=e;for(let e=0;e<this.filters.length;e++)t=this.filters[e].sendMessage(t);return t}receiveMessage(e){let t=e;for(let e=this.filters.length-1;e>=0;e--)t=this.filters[e].receiveMessage(t);return t}receiveTrailers(e){let t=e;for(let e=this.filters.length-1;e>=0;e--)t=this.filters[e].receiveTrailers(t);return t}push(e){this.filters.unshift(...e)}getFilters(){return this.filters}}r.FilterStack=i;class n{constructor(e){this.factories=e}push(e){this.factories.unshift(...e)}clone(){return new n([...this.factories])}createFilter(){return new i(this.factories.map(e=>e.createFilter()))}}r.FilterStackFactory=n},14873,(e,t,r)=>{"use strict";var i;Object.defineProperty(r,"__esModule",{value:!0}),r.CompressionAlgorithms=void 0,function(e){e[e.identity=0]="identity",e[e.deflate=1]="deflate",e[e.gzip=2]="gzip"}(i||(r.CompressionAlgorithms=i={}))},43704,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.BaseFilter=void 0;class i{async sendMetadata(e){return e}receiveMetadata(e){return e}async sendMessage(e){return e}async receiveMessage(e){return e}receiveTrailers(e){return e}}r.BaseFilter=i},17882,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.CompressionFilterFactory=r.CompressionFilter=void 0;let i=e.r(6461),n=e.r(14873),s=e.r(7782),a=e.r(43704),o=e.r(33137),l=e=>"number"==typeof e&&"string"==typeof n.CompressionAlgorithms[e];class c{async writeMessage(e,t){let r=e;t&&(r=await this.compressMessage(r));let i=Buffer.allocUnsafe(r.length+5);return i.writeUInt8(+!!t,0),i.writeUInt32BE(r.length,1),r.copy(i,5),i}async readMessage(e){let t=1===e.readUInt8(0),r=e.slice(5);return t&&(r=await this.decompressMessage(r)),r}}class u extends c{async compressMessage(e){return e}async writeMessage(e,t){let r=Buffer.allocUnsafe(e.length+5);return r.writeUInt8(0,0),r.writeUInt32BE(e.length,1),e.copy(r,5),r}decompressMessage(e){return Promise.reject(Error('Received compressed message but "grpc-encoding" header was identity'))}}class h extends c{constructor(e){super(),this.maxRecvMessageLength=e}compressMessage(e){return new Promise((t,r)=>{i.deflate(e,(e,i)=>{e?r(e):t(i)})})}decompressMessage(e){return new Promise((t,r)=>{let n=0,a=[],o=i.createInflate();o.on("data",e=>{a.push(e),n+=e.byteLength,-1!==this.maxRecvMessageLength&&n>this.maxRecvMessageLength&&(o.destroy(),r({code:s.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxRecvMessageLength}`}))}),o.on("end",()=>{t(Buffer.concat(a))}),o.write(e),o.end()})}}class d extends c{constructor(e){super(),this.maxRecvMessageLength=e}compressMessage(e){return new Promise((t,r)=>{i.gzip(e,(e,i)=>{e?r(e):t(i)})})}decompressMessage(e){return new Promise((t,r)=>{let n=0,a=[],o=i.createGunzip();o.on("data",e=>{a.push(e),n+=e.byteLength,-1!==this.maxRecvMessageLength&&n>this.maxRecvMessageLength&&(o.destroy(),r({code:s.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxRecvMessageLength}`}))}),o.on("end",()=>{t(Buffer.concat(a))}),o.write(e),o.end()})}}class f extends c{constructor(e){super(),this.compressionName=e}compressMessage(e){return Promise.reject(Error(`Received message compressed with unsupported compression method ${this.compressionName}`))}decompressMessage(e){return Promise.reject(Error(`Compression method not supported: ${this.compressionName}`))}}function p(e,t){switch(e){case"identity":return new u;case"deflate":return new h(t);case"gzip":return new d(t);default:return new f(e)}}class m extends a.BaseFilter{constructor(e,t){var r,i;super(),this.sharedFilterConfig=t,this.sendCompression=new u,this.receiveCompression=new u,this.currentCompressionAlgorithm="identity";const a=e["grpc.default_compression_algorithm"];if(this.maxReceiveMessageLength=null!=(r=e["grpc.max_receive_message_length"])?r:s.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,void 0!==a)if(l(a)){const e=n.CompressionAlgorithms[a],r=null==(i=t.serverSupportedEncodingHeader)?void 0:i.split(",");(!r||r.includes(e))&&(this.currentCompressionAlgorithm=e,this.sendCompression=p(this.currentCompressionAlgorithm,-1))}else o.log(s.LogVerbosity.ERROR,`Invalid value provided for grpc.default_compression_algorithm option: ${a}`)}async sendMetadata(e){let t=await e;return t.set("grpc-accept-encoding","identity,deflate,gzip"),t.set("accept-encoding","identity"),"identity"===this.currentCompressionAlgorithm?t.remove("grpc-encoding"):t.set("grpc-encoding",this.currentCompressionAlgorithm),t}receiveMetadata(e){let t=e.get("grpc-encoding");if(t.length>0){let e=t[0];"string"==typeof e&&(this.receiveCompression=p(e,this.maxReceiveMessageLength))}e.remove("grpc-encoding");let r=e.get("grpc-accept-encoding")[0];return r&&(this.sharedFilterConfig.serverSupportedEncodingHeader=r,r.split(",").includes(this.currentCompressionAlgorithm)||(this.sendCompression=new u,this.currentCompressionAlgorithm="identity")),e.remove("grpc-accept-encoding"),e}async sendMessage(e){var t;let r,i=await e;return r=!(this.sendCompression instanceof u)&&((null!=(t=i.flags)?t:0)&2)==0,{message:await this.sendCompression.writeMessage(i.message,r),flags:i.flags}}async receiveMessage(e){return this.receiveCompression.readMessage(await e)}}r.CompressionFilter=m;class g{constructor(e,t){this.options=t,this.sharedFilterConfig={}}createFilter(){return new m(this.options,this.sharedFilterConfig)}}r.CompressionFilterFactory=g},41512,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.deadlineToString=r.getRelativeTimeout=r.getDeadlineTimeoutString=r.minDeadline=void 0,r.minDeadline=function(...e){let t=1/0;for(let r of e){let e=r instanceof Date?r.getTime():r;e<t&&(t=e)}return t};let i=[["m",1],["S",1e3],["M",6e4],["H",36e5]];r.getDeadlineTimeoutString=function(e){let t=new Date().getTime();e instanceof Date&&(e=e.getTime());let r=Math.max(e-t,0);for(let[e,t]of i){let i=r/t;if(i<1e8)return String(Math.ceil(i))+e}throw Error("Deadline is too far in the future")};let n=0x7fffffff;r.getRelativeTimeout=function(e){let t=(e instanceof Date?e.getTime():e)-new Date().getTime();return t<0?0:t>n?1/0:t},r.deadlineToString=function(e){if(e instanceof Date)return e.toISOString();{let t=new Date(e);return Number.isNaN(t.getTime())?""+e:t.toISOString()}}},23356,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.restrictControlPlaneStatusCode=void 0;let i=e.r(7782),n=[i.Status.OK,i.Status.INVALID_ARGUMENT,i.Status.NOT_FOUND,i.Status.ALREADY_EXISTS,i.Status.FAILED_PRECONDITION,i.Status.ABORTED,i.Status.OUT_OF_RANGE,i.Status.DATA_LOSS];r.restrictControlPlaneStatusCode=function(e,t){return n.includes(e)?{code:i.Status.INTERNAL,details:`Invalid status from control plane: ${e} ${i.Status[e]} ${t}`}:{code:e,details:t}}},66988,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.LoadBalancingCall=void 0;let i=e.r(35967),n=e.r(7782),s=e.r(41512),a=e.r(10409),o=e.r(32199),l=e.r(177),c=e.r(33137),u=e.r(23356),h=e.r(25328),d="load_balancing_call";class f{constructor(e,t,r,i,n,s,a){var o,c;this.channel=e,this.callConfig=t,this.methodName=r,this.host=i,this.credentials=n,this.deadline=s,this.callNumber=a,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.metadata=null,this.listener=null,this.onCallEnded=null;const u=this.methodName.split("/");let h="";u.length>=2&&(h=u[1]);const d=null!=(c=null==(o=(0,l.splitHostPort)(this.host))?void 0:o.host)?c:"localhost";this.serviceUrl=`https://${d}/${h}`}trace(e){c.trace(n.LogVerbosity.DEBUG,d,"["+this.callNumber+"] "+e)}outputStatus(e,t){var r,i;if(!this.ended){this.ended=!0,this.trace("ended with status: code="+e.code+' details="'+e.details+'"');let n=Object.assign(Object.assign({},e),{progress:t});null==(r=this.listener)||r.onReceiveStatus(n),null==(i=this.onCallEnded)||i.call(this,n.code)}}doPick(){var e,t;if(this.ended)return;if(!this.metadata)throw Error("doPick called before start");this.trace("Pick called");let r=this.channel.doPick(this.metadata,this.callConfig.pickInformation),l=r.subchannel?"("+r.subchannel.getChannelzRef().id+") "+r.subchannel.getAddress():""+r.subchannel;switch(this.trace("Pick result: "+o.PickResultType[r.pickResultType]+" subchannel: "+l+" status: "+(null==(e=r.status)?void 0:e.code)+" "+(null==(t=r.status)?void 0:t.details)),r.pickResultType){case o.PickResultType.COMPLETE:this.credentials.generateMetadata({service_url:this.serviceUrl}).then(e=>{var t,o,c;if(this.ended)return void this.trace("Credentials metadata generation finished after call ended");let u=this.metadata.clone();if(u.merge(e),u.get("authorization").length>1&&this.outputStatus({code:n.Status.INTERNAL,details:'"authorization" metadata cannot have multiple values',metadata:new a.Metadata},"PROCESSED"),r.subchannel.getConnectivityState()!==i.ConnectivityState.READY){this.trace("Picked subchannel "+l+" has state "+i.ConnectivityState[r.subchannel.getConnectivityState()]+" after getting credentials metadata. Retrying pick"),this.doPick();return}this.deadline!==1/0&&u.set("grpc-timeout",(0,s.getDeadlineTimeoutString)(this.deadline));try{this.child=r.subchannel.getRealSubchannel().createCall(u,this.host,this.methodName,{onReceiveMetadata:e=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(e)},onReceiveMessage:e=>{this.trace("Received message"),this.listener.onReceiveMessage(e)},onReceiveStatus:e=>{this.trace("Received status"),e.rstCode===h.constants.NGHTTP2_REFUSED_STREAM?this.outputStatus(e,"REFUSED"):this.outputStatus(e,"PROCESSED")}})}catch(e){this.trace("Failed to start call on picked subchannel "+l+" with error "+e.message),this.outputStatus({code:n.Status.INTERNAL,details:"Failed to start HTTP/2 stream with error "+e.message,metadata:new a.Metadata},"NOT_STARTED");return}null==(o=(t=this.callConfig).onCommitted)||o.call(t),null==(c=r.onCallStarted)||c.call(r),this.onCallEnded=r.onCallEnded,this.trace("Created child call ["+this.child.getCallNumber()+"]"),this.readPending&&this.child.startRead(),this.pendingMessage&&this.child.sendMessageWithContext(this.pendingMessage.context,this.pendingMessage.message),this.pendingHalfClose&&this.child.halfClose()},e=>{let{code:t,details:r}=(0,u.restrictControlPlaneStatusCode)("number"==typeof e.code?e.code:n.Status.UNKNOWN,`Getting metadata from plugin failed with error: ${e.message}`);this.outputStatus({code:t,details:r,metadata:new a.Metadata},"PROCESSED")});break;case o.PickResultType.DROP:let{code:c,details:d}=(0,u.restrictControlPlaneStatusCode)(r.status.code,r.status.details);setImmediate(()=>{this.outputStatus({code:c,details:d,metadata:r.status.metadata},"DROP")});break;case o.PickResultType.TRANSIENT_FAILURE:if(this.metadata.getOptions().waitForReady)this.channel.queueCallForPick(this);else{let{code:e,details:t}=(0,u.restrictControlPlaneStatusCode)(r.status.code,r.status.details);setImmediate(()=>{this.outputStatus({code:e,details:t,metadata:r.status.metadata},"PROCESSED")})}break;case o.PickResultType.QUEUE:this.channel.queueCallForPick(this)}}cancelWithStatus(e,t){var r;this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),null==(r=this.child)||r.cancelWithStatus(e,t),this.outputStatus({code:e,details:t,metadata:new a.Metadata},"PROCESSED")}getPeer(){var e,t;return null!=(t=null==(e=this.child)?void 0:e.getPeer())?t:this.channel.getTarget()}start(e,t){this.trace("start called"),this.listener=t,this.metadata=e,this.doPick()}sendMessageWithContext(e,t){this.trace("write() called with message of length "+t.length),this.child?this.child.sendMessageWithContext(e,t):this.pendingMessage={context:e,message:t}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(e){throw Error("Method not implemented.")}getCallNumber(){return this.callNumber}}r.LoadBalancingCall=f},44106,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ResolvingCall=void 0;let i=e.r(7782),n=e.r(41512),s=e.r(10409),a=e.r(33137),o=e.r(23356),l="resolving_call";class c{constructor(e,t,r,s,a,o){this.channel=e,this.method=t,this.filterStackFactory=s,this.credentials=a,this.callNumber=o,this.child=null,this.readPending=!1,this.pendingMessage=null,this.pendingHalfClose=!1,this.ended=!1,this.readFilterPending=!1,this.writeFilterPending=!1,this.pendingChildStatus=null,this.metadata=null,this.listener=null,this.statusWatchers=[],this.deadlineTimer=setTimeout(()=>{},0),this.filterStack=null,this.deadline=r.deadline,this.host=r.host,r.parentCall&&(r.flags&i.Propagate.CANCELLATION&&r.parentCall.on("cancelled",()=>{this.cancelWithStatus(i.Status.CANCELLED,"Cancelled by parent call")}),r.flags&i.Propagate.DEADLINE&&(this.trace("Propagating deadline from parent: "+r.parentCall.getDeadline()),this.deadline=(0,n.minDeadline)(this.deadline,r.parentCall.getDeadline()))),this.trace("Created"),this.runDeadlineTimer()}trace(e){a.trace(i.LogVerbosity.DEBUG,l,"["+this.callNumber+"] "+e)}runDeadlineTimer(){clearTimeout(this.deadlineTimer),this.trace("Deadline: "+(0,n.deadlineToString)(this.deadline));let e=(0,n.getRelativeTimeout)(this.deadline);if(e!==1/0){this.trace("Deadline will be reached in "+e+"ms");let t=()=>{this.cancelWithStatus(i.Status.DEADLINE_EXCEEDED,"Deadline exceeded")};e<=0?process.nextTick(t):this.deadlineTimer=setTimeout(t,e)}}outputStatus(e){if(!this.ended){this.ended=!0,this.filterStack||(this.filterStack=this.filterStackFactory.createFilter()),clearTimeout(this.deadlineTimer);let t=this.filterStack.receiveTrailers(e);this.trace("ended with status: code="+t.code+' details="'+t.details+'"'),this.statusWatchers.forEach(e=>e(t)),process.nextTick(()=>{var e;null==(e=this.listener)||e.onReceiveStatus(t)})}}sendMessageOnChild(e,t){if(!this.child)throw Error("sendMessageonChild called with child not populated");let r=this.child;this.writeFilterPending=!0,this.filterStack.sendMessage(Promise.resolve({message:t,flags:e.flags})).then(t=>{this.writeFilterPending=!1,r.sendMessageWithContext(e,t.message),this.pendingHalfClose&&r.halfClose()},e=>{this.cancelWithStatus(e.code,e.details)})}getConfig(){if(this.ended)return;if(!this.metadata||!this.listener)throw Error("getConfig called before start");let e=this.channel.getConfig(this.method,this.metadata);if("NONE"===e.type)return void this.channel.queueCallForConfig(this);if("ERROR"===e.type)return void(this.metadata.getOptions().waitForReady?this.channel.queueCallForConfig(this):this.outputStatus(e.error));let t=e.config;if(t.status!==i.Status.OK){let{code:e,details:r}=(0,o.restrictControlPlaneStatusCode)(t.status,"Failed to route call to method "+this.method);this.outputStatus({code:e,details:r,metadata:new s.Metadata});return}if(t.methodConfig.timeout){let e=new Date;e.setSeconds(e.getSeconds()+t.methodConfig.timeout.seconds),e.setMilliseconds(e.getMilliseconds()+t.methodConfig.timeout.nanos/1e6),this.deadline=(0,n.minDeadline)(this.deadline,e),this.runDeadlineTimer()}this.filterStackFactory.push(t.dynamicFilterFactories),this.filterStack=this.filterStackFactory.createFilter(),this.filterStack.sendMetadata(Promise.resolve(this.metadata)).then(e=>{this.child=this.channel.createInnerCall(t,this.method,this.host,this.credentials,this.deadline),this.trace("Created child ["+this.child.getCallNumber()+"]"),this.child.start(e,{onReceiveMetadata:e=>{this.trace("Received metadata"),this.listener.onReceiveMetadata(this.filterStack.receiveMetadata(e))},onReceiveMessage:e=>{this.trace("Received message"),this.readFilterPending=!0,this.filterStack.receiveMessage(e).then(e=>{this.trace("Finished filtering received message"),this.readFilterPending=!1,this.listener.onReceiveMessage(e),this.pendingChildStatus&&this.outputStatus(this.pendingChildStatus)},e=>{this.cancelWithStatus(e.code,e.details)})},onReceiveStatus:e=>{this.trace("Received status"),this.readFilterPending?this.pendingChildStatus=e:this.outputStatus(e)}}),this.readPending&&this.child.startRead(),this.pendingMessage?this.sendMessageOnChild(this.pendingMessage.context,this.pendingMessage.message):this.pendingHalfClose&&this.child.halfClose()},e=>{this.outputStatus(e)})}reportResolverError(e){var t;(null==(t=this.metadata)?void 0:t.getOptions().waitForReady)?this.channel.queueCallForConfig(this):this.outputStatus(e)}cancelWithStatus(e,t){var r;this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),null==(r=this.child)||r.cancelWithStatus(e,t),this.outputStatus({code:e,details:t,metadata:new s.Metadata})}getPeer(){var e,t;return null!=(t=null==(e=this.child)?void 0:e.getPeer())?t:this.channel.getTarget()}start(e,t){this.trace("start called"),this.metadata=e.clone(),this.listener=t,this.getConfig()}sendMessageWithContext(e,t){this.trace("write() called with message of length "+t.length),this.child?this.sendMessageOnChild(e,t):this.pendingMessage={context:e,message:t}}startRead(){this.trace("startRead called"),this.child?this.child.startRead():this.readPending=!0}halfClose(){this.trace("halfClose called"),this.child&&!this.writeFilterPending?this.child.halfClose():this.pendingHalfClose=!0}setCredentials(e){this.credentials=this.credentials.compose(e)}addStatusWatcher(e){this.statusWatchers.push(e)}getCallNumber(){return this.callNumber}}r.ResolvingCall=c},27734,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.RetryingCall=r.MessageBufferTracker=r.RetryThrottler=void 0;let i=e.r(7782),n=e.r(10409),s=e.r(33137),a="retrying_call";class o{constructor(e,t,r){this.maxTokens=e,this.tokenRatio=t,r?this.tokens=r.tokens*(e/r.maxTokens):this.tokens=e}addCallSucceeded(){this.tokens=Math.max(this.tokens+this.tokenRatio,this.maxTokens)}addCallFailed(){this.tokens=Math.min(this.tokens-1,0)}canRetryCall(){return this.tokens>this.maxTokens/2}}r.RetryThrottler=o;class l{constructor(e,t){this.totalLimit=e,this.limitPerCall=t,this.totalAllocated=0,this.allocatedPerCall=new Map}allocate(e,t){var r;let i=null!=(r=this.allocatedPerCall.get(t))?r:0;return!(this.limitPerCall-i<e)&&!(this.totalLimit-this.totalAllocated<e)&&(this.allocatedPerCall.set(t,i+e),this.totalAllocated+=e,!0)}free(e,t){var r;if(this.totalAllocated<e)throw Error(`Invalid buffer allocation state: call ${t} freed ${e} > total allocated ${this.totalAllocated}`);this.totalAllocated-=e;let i=null!=(r=this.allocatedPerCall.get(t))?r:0;if(i<e)throw Error(`Invalid buffer allocation state: call ${t} freed ${e} > allocated for call ${i}`);this.allocatedPerCall.set(t,i-e)}freeAll(e){var t;let r=null!=(t=this.allocatedPerCall.get(e))?t:0;if(this.totalAllocated<r)throw Error(`Invalid buffer allocation state: call ${e} allocated ${r} > total allocated ${this.totalAllocated}`);this.totalAllocated-=r,this.allocatedPerCall.delete(e)}}r.MessageBufferTracker=l;let c="grpc-previous-rpc-attempts";class u{constructor(e,t,r,i,n,s,a,o,l){if(this.channel=e,this.callConfig=t,this.methodName=r,this.host=i,this.credentials=n,this.deadline=s,this.callNumber=a,this.bufferTracker=o,this.retryThrottler=l,this.listener=null,this.initialMetadata=null,this.underlyingCalls=[],this.writeBuffer=[],this.writeBufferOffset=0,this.readStarted=!1,this.transparentRetryUsed=!1,this.attempts=0,this.hedgingTimer=null,this.committedCallIndex=null,this.initialRetryBackoffSec=0,this.nextRetryBackoffSec=0,t.methodConfig.retryPolicy){this.state="RETRY";const e=t.methodConfig.retryPolicy;this.nextRetryBackoffSec=this.initialRetryBackoffSec=Number(e.initialBackoff.substring(0,e.initialBackoff.length-1))}else t.methodConfig.hedgingPolicy?this.state="HEDGING":this.state="TRANSPARENT_ONLY"}getCallNumber(){return this.callNumber}trace(e){s.trace(i.LogVerbosity.DEBUG,a,"["+this.callNumber+"] "+e)}reportStatus(e){this.trace("ended with status: code="+e.code+' details="'+e.details+'"'),this.bufferTracker.freeAll(this.callNumber),this.writeBufferOffset=this.writeBufferOffset+this.writeBuffer.length,this.writeBuffer=[],process.nextTick(()=>{var t;null==(t=this.listener)||t.onReceiveStatus({code:e.code,details:e.details,metadata:e.metadata})})}cancelWithStatus(e,t){for(let{call:r}of(this.trace("cancelWithStatus code: "+e+' details: "'+t+'"'),this.reportStatus({code:e,details:t,metadata:new n.Metadata}),this.underlyingCalls))r.cancelWithStatus(e,t)}getPeer(){return null!==this.committedCallIndex?this.underlyingCalls[this.committedCallIndex].call.getPeer():"unknown"}getBufferEntry(e){var t;return null!=(t=this.writeBuffer[e-this.writeBufferOffset])?t:{entryType:"FREED",allocated:!1}}getNextBufferIndex(){return this.writeBufferOffset+this.writeBuffer.length}clearSentMessages(){if("COMMITTED"!==this.state)return;let e=this.underlyingCalls[this.committedCallIndex].nextMessageToSend;for(let t=this.writeBufferOffset;t<e;t++){let e=this.getBufferEntry(t);e.allocated&&this.bufferTracker.free(e.message.message.length,this.callNumber)}this.writeBuffer=this.writeBuffer.slice(e-this.writeBufferOffset),this.writeBufferOffset=e}commitCall(e){if("COMMITTED"!==this.state&&"COMPLETED"!==this.underlyingCalls[e].state){this.trace("Committing call ["+this.underlyingCalls[e].call.getCallNumber()+"] at index "+e),this.state="COMMITTED",this.committedCallIndex=e;for(let t=0;t<this.underlyingCalls.length;t++)t!==e&&"COMPLETED"!==this.underlyingCalls[t].state&&(this.underlyingCalls[t].state="COMPLETED",this.underlyingCalls[t].call.cancelWithStatus(i.Status.CANCELLED,"Discarded in favor of other hedged attempt"));this.clearSentMessages()}}commitCallWithMostMessages(){if("COMMITTED"===this.state)return;let e=-1,t=-1;for(let[r,i]of this.underlyingCalls.entries())"ACTIVE"===i.state&&i.nextMessageToSend>e&&(e=i.nextMessageToSend,t=r);-1===t?this.state="TRANSPARENT_ONLY":this.commitCall(t)}isStatusCodeInList(e,t){return e.some(e=>e===t||e.toString().toLowerCase()===i.Status[t].toLowerCase())}getNextRetryBackoffMs(){var e;let t=null==(e=this.callConfig)?void 0:e.methodConfig.retryPolicy;if(!t)return 0;let r=Math.random()*this.nextRetryBackoffSec*1e3,i=Number(t.maxBackoff.substring(0,t.maxBackoff.length-1));return this.nextRetryBackoffSec=Math.min(this.nextRetryBackoffSec*t.backoffMultiplier,i),r}maybeRetryCall(e,t){let r;if("RETRY"!==this.state)return void t(!1);let i=this.callConfig.methodConfig.retryPolicy;if(this.attempts>=Math.min(i.maxAttempts,5))return void t(!1);if(null===e)r=this.getNextRetryBackoffMs();else if(e<0){this.state="TRANSPARENT_ONLY",t(!1);return}else r=e,this.nextRetryBackoffSec=this.initialRetryBackoffSec;setTimeout(()=>{var e,r;"RETRY"!==this.state?t(!1):(null==(r=null==(e=this.retryThrottler)?void 0:e.canRetryCall())||r)&&(t(!0),this.attempts+=1,this.startNewAttempt())},r)}countActiveCalls(){let e=0;for(let t of this.underlyingCalls)(null==t?void 0:t.state)==="ACTIVE"&&(e+=1);return e}handleProcessedStatus(e,t,r){var i,n,s;switch(this.state){case"COMMITTED":case"TRANSPARENT_ONLY":this.commitCall(t),this.reportStatus(e);break;case"HEDGING":if(this.isStatusCodeInList(null!=(i=this.callConfig.methodConfig.hedgingPolicy.nonFatalStatusCodes)?i:[],e.code)){let i;if(null==(n=this.retryThrottler)||n.addCallFailed(),null===r)i=0;else if(r<0){this.state="TRANSPARENT_ONLY",this.commitCall(t),this.reportStatus(e);return}else i=r;setTimeout(()=>{this.maybeStartHedgingAttempt(),0===this.countActiveCalls()&&(this.commitCall(t),this.reportStatus(e))},i)}else this.commitCall(t),this.reportStatus(e);break;case"RETRY":this.isStatusCodeInList(this.callConfig.methodConfig.retryPolicy.retryableStatusCodes,e.code)?(null==(s=this.retryThrottler)||s.addCallFailed(),this.maybeRetryCall(r,r=>{r||(this.commitCall(t),this.reportStatus(e))})):(this.commitCall(t),this.reportStatus(e))}}getPushback(e){let t=e.get("grpc-retry-pushback-ms");if(0===t.length)return null;try{return parseInt(t[0])}catch(e){return -1}}handleChildStatus(e,t){var r;if("COMPLETED"===this.underlyingCalls[t].state)return;if(this.trace("state="+this.state+" handling status with progress "+e.progress+" from child ["+this.underlyingCalls[t].call.getCallNumber()+"] in state "+this.underlyingCalls[t].state),this.underlyingCalls[t].state="COMPLETED",e.code===i.Status.OK){null==(r=this.retryThrottler)||r.addCallSucceeded(),this.commitCall(t),this.reportStatus(e);return}if("COMMITTED"===this.state)return void this.reportStatus(e);let n=this.getPushback(e.metadata);switch(e.progress){case"NOT_STARTED":this.startNewAttempt();break;case"REFUSED":this.transparentRetryUsed?this.handleProcessedStatus(e,t,n):(this.transparentRetryUsed=!0,this.startNewAttempt());break;case"DROP":this.commitCall(t),this.reportStatus(e);break;case"PROCESSED":this.handleProcessedStatus(e,t,n)}}maybeStartHedgingAttempt(){if("HEDGING"!==this.state||!this.callConfig.methodConfig.hedgingPolicy)return;let e=this.callConfig.methodConfig.hedgingPolicy;this.attempts>=Math.min(e.maxAttempts,5)||(this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer())}maybeStartHedgingTimer(){var e,t,r;if(this.hedgingTimer&&clearTimeout(this.hedgingTimer),"HEDGING"!==this.state||!this.callConfig.methodConfig.hedgingPolicy)return;let i=this.callConfig.methodConfig.hedgingPolicy;if(this.attempts>=Math.min(i.maxAttempts,5))return;let n=null!=(e=i.hedgingDelay)?e:"0s",s=Number(n.substring(0,n.length-1));this.hedgingTimer=setTimeout(()=>{this.maybeStartHedgingAttempt()},1e3*s),null==(r=(t=this.hedgingTimer).unref)||r.call(t)}startNewAttempt(){let e=this.channel.createLoadBalancingCall(this.callConfig,this.methodName,this.host,this.credentials,this.deadline);this.trace("Created child call ["+e.getCallNumber()+"] for attempt "+this.attempts);let t=this.underlyingCalls.length;this.underlyingCalls.push({state:"ACTIVE",call:e,nextMessageToSend:0});let r=this.attempts-1,i=this.initialMetadata.clone();r>0&&i.set(c,`${r}`);let n=!1;e.start(i,{onReceiveMetadata:i=>{this.trace("Received metadata from child ["+e.getCallNumber()+"]"),this.commitCall(t),n=!0,r>0&&i.set(c,`${r}`),"ACTIVE"===this.underlyingCalls[t].state&&this.listener.onReceiveMetadata(i)},onReceiveMessage:r=>{this.trace("Received message from child ["+e.getCallNumber()+"]"),this.commitCall(t),"ACTIVE"===this.underlyingCalls[t].state&&this.listener.onReceiveMessage(r)},onReceiveStatus:i=>{this.trace("Received status from child ["+e.getCallNumber()+"]"),!n&&r>0&&i.metadata.set(c,`${r}`),this.handleChildStatus(i,t)}}),this.sendNextChildMessage(t),this.readStarted&&e.startRead()}start(e,t){this.trace("start called"),this.listener=t,this.initialMetadata=e,this.attempts+=1,this.startNewAttempt(),this.maybeStartHedgingTimer()}handleChildWriteCompleted(e){var t,r;let i=this.underlyingCalls[e],n=i.nextMessageToSend;null==(r=(t=this.getBufferEntry(n)).callback)||r.call(t),this.clearSentMessages(),i.nextMessageToSend+=1,this.sendNextChildMessage(e)}sendNextChildMessage(e){let t=this.underlyingCalls[e];if("COMPLETED"!==t.state&&this.getBufferEntry(t.nextMessageToSend)){let r=this.getBufferEntry(t.nextMessageToSend);switch(r.entryType){case"MESSAGE":t.call.sendMessageWithContext({callback:t=>{this.handleChildWriteCompleted(e)}},r.message.message);break;case"HALF_CLOSE":t.nextMessageToSend+=1,t.call.halfClose()}}}sendMessageWithContext(e,t){var r;this.trace("write() called with message of length "+t.length);let i={message:t,flags:e.flags},n=this.getNextBufferIndex(),s={entryType:"MESSAGE",message:i,allocated:this.bufferTracker.allocate(t.length,this.callNumber)};if(this.writeBuffer.push(s),s.allocated)for(let[i,s]of(null==(r=e.callback)||r.call(e),this.underlyingCalls.entries()))"ACTIVE"===s.state&&s.nextMessageToSend===n&&s.call.sendMessageWithContext({callback:e=>{this.handleChildWriteCompleted(i)}},t);else{if(this.commitCallWithMostMessages(),null===this.committedCallIndex)return;let r=this.underlyingCalls[this.committedCallIndex];s.callback=e.callback,"ACTIVE"===r.state&&r.nextMessageToSend===n&&r.call.sendMessageWithContext({callback:e=>{this.handleChildWriteCompleted(this.committedCallIndex)}},t)}}startRead(){for(let e of(this.trace("startRead called"),this.readStarted=!0,this.underlyingCalls))(null==e?void 0:e.state)==="ACTIVE"&&e.call.startRead()}halfClose(){this.trace("halfClose called");let e=this.getNextBufferIndex();for(let t of(this.writeBuffer.push({entryType:"HALF_CLOSE",allocated:!1}),this.underlyingCalls))(null==t?void 0:t.state)==="ACTIVE"&&t.nextMessageToSend===e&&(t.nextMessageToSend+=1,t.call.halfClose())}setCredentials(e){throw Error("Method not implemented.")}getMethod(){return this.methodName}getHost(){return this.host}}r.RetryingCall=u},22664,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.BaseSubchannelWrapper=void 0;class i{constructor(e){this.child=e}getConnectivityState(){return this.child.getConnectivityState()}addConnectivityStateListener(e){this.child.addConnectivityStateListener(e)}removeConnectivityStateListener(e){this.child.removeConnectivityStateListener(e)}startConnecting(){this.child.startConnecting()}getAddress(){return this.child.getAddress()}throttleKeepalive(e){this.child.throttleKeepalive(e)}ref(){this.child.ref()}unref(){this.child.unref()}getChannelzRef(){return this.child.getChannelzRef()}getRealSubchannel(){return this.child.getRealSubchannel()}realSubchannelEquals(e){return this.getRealSubchannel()===e.getRealSubchannel()}}r.BaseSubchannelWrapper=i},34028,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.InternalChannel=void 0;let i=e.r(11877),n=e.r(67668),s=e.r(4214),a=e.r(32199),o=e.r(7782),l=e.r(60807),c=e.r(17882),u=e.r(54718),h=e.r(33137),d=e.r(36913),f=e.r(177),p=e.r(35967),m=e.r(23023),g=e.r(66988),y=e.r(41512),v=e.r(44106),b=e.r(13038),S=e.r(23356),C=e.r(27734),T=e.r(22664),E=0x7fffffff,_=1e3,w=18e5,R=new Map,k=0x1000000,A=1048576;class I extends T.BaseSubchannelWrapper{constructor(e,t){super(e),this.channel=t,this.refCount=0,this.subchannelStateListener=(e,r,i,n)=>{t.throttleKeepalive(n)},e.addConnectivityStateListener(this.subchannelStateListener)}ref(){this.child.ref(),this.refCount+=1}unref(){this.child.unref(),this.refCount-=1,this.refCount<=0&&(this.child.removeConnectivityStateListener(this.subchannelStateListener),this.channel.removeWrappedSubchannel(this))}}class O{constructor(e,t,r){var g,y,v,b,T,O,N,x;if(this.credentials=t,this.options=r,this.connectivityState=p.ConnectivityState.IDLE,this.currentPicker=new a.UnavailablePicker,this.configSelectionQueue=[],this.pickQueue=[],this.connectivityStateWatchers=[],this.configSelector=null,this.currentResolutionError=null,this.wrappedSubchannels=new Set,this.callCount=0,this.idleTimer=null,this.channelzEnabled=!0,this.callTracker=new m.ChannelzCallTracker,this.childrenTracker=new m.ChannelzChildrenTracker,"string"!=typeof e)throw TypeError("Channel target must be a string");if(!(t instanceof i.ChannelCredentials))throw TypeError("Channel credentials must be a ChannelCredentials object");if(r&&"object"!=typeof r)throw TypeError("Channel options must be an object");this.originalTarget=e;const D=(0,f.parseUri)(e);if(null===D)throw Error(`Could not parse target name "${e}"`);const P=(0,u.mapUriDefaultScheme)(D);if(null===P)throw Error(`Could not find a default scheme for target name "${e}"`);this.callRefTimer=setInterval(()=>{},E),null==(y=(g=this.callRefTimer).unref)||y.call(g),0===this.options["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzTrace=new m.ChannelzTrace,this.channelzRef=(0,m.registerChannelzChannel)(e,()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Channel created"),this.options["grpc.default_authority"]?this.defaultAuthority=this.options["grpc.default_authority"]:this.defaultAuthority=(0,u.getDefaultAuthority)(P);const M=(0,d.mapProxyName)(P,r);this.target=M.target,this.options=Object.assign({},this.options,M.extraOptions),this.subchannelPool=(0,s.getSubchannelPool)((null!=(v=r["grpc.use_local_subchannel_pool"])?v:0)===0),this.retryBufferTracker=new C.MessageBufferTracker(null!=(b=r["grpc.retry_buffer_size"])?b:k,null!=(T=r["grpc.per_rpc_retry_buffer_size"])?T:A),this.keepaliveTime=null!=(O=r["grpc.keepalive_time_ms"])?O:-1,this.idleTimeoutMs=Math.max(null!=(N=r["grpc.client_idle_timeout_ms"])?N:w,_);const L={createSubchannel:(e,t)=>{let r=this.subchannelPool.getOrCreateSubchannel(this.target,e,Object.assign({},this.options,t),this.credentials);r.throttleKeepalive(this.keepaliveTime),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Created subchannel or used existing subchannel",r.getChannelzRef());let i=new I(r,this);return this.wrappedSubchannels.add(i),i},updateState:(e,t)=>{this.currentPicker=t;let r=this.pickQueue.slice();for(let e of(this.pickQueue=[],r.length>0&&this.callRefTimerUnref(),r))e.doPick();this.updateState(e)},requestReresolution:()=>{throw Error("Resolving load balancer should never call requestReresolution")},addChannelzChild:e=>{this.channelzEnabled&&this.childrenTracker.refChild(e)},removeChannelzChild:e=>{this.channelzEnabled&&this.childrenTracker.unrefChild(e)}};this.resolvingLoadBalancer=new n.ResolvingLoadBalancer(this.target,L,r,(e,t)=>{e.retryThrottling?R.set(this.getTarget(),new C.RetryThrottler(e.retryThrottling.maxTokens,e.retryThrottling.tokenRatio,R.get(this.getTarget()))):R.delete(this.getTarget()),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Address resolution succeeded"),this.configSelector=t,this.currentResolutionError=null,process.nextTick(()=>{let e=this.configSelectionQueue;for(let t of(this.configSelectionQueue=[],e.length>0&&this.callRefTimerUnref(),e))t.getConfig()})},e=>{this.channelzEnabled&&this.channelzTrace.addTrace("CT_WARNING","Address resolution failed with code "+e.code+' and details "'+e.details+'"'),this.configSelectionQueue.length>0&&this.trace("Name resolution failed with calls queued for config selection"),null===this.configSelector&&(this.currentResolutionError=Object.assign(Object.assign({},(0,S.restrictControlPlaneStatusCode)(e.code,e.details)),{metadata:e.metadata}));let t=this.configSelectionQueue;for(let r of(this.configSelectionQueue=[],t.length>0&&this.callRefTimerUnref(),t))r.reportResolverError(e)}),this.filterStackFactory=new l.FilterStackFactory([new c.CompressionFilterFactory(this,this.options)]),this.trace("Channel constructed with options "+JSON.stringify(r,void 0,2));const F=Error();(0,h.trace)(o.LogVerbosity.DEBUG,"channel_stacktrace","("+this.channelzRef.id+") Channel constructed \n"+(null==(x=F.stack)?void 0:x.substring(F.stack.indexOf("\n")+1))),this.lastActivityTimestamp=new Date}getChannelzInfo(){return{target:this.originalTarget,state:this.connectivityState,trace:this.channelzTrace,callTracker:this.callTracker,children:this.childrenTracker.getChildLists()}}trace(e,t){(0,h.trace)(null!=t?t:o.LogVerbosity.DEBUG,"channel","("+this.channelzRef.id+") "+(0,f.uriToString)(this.target)+" "+e)}callRefTimerRef(){var e,t,r,i;(null==(t=(e=this.callRefTimer).hasRef)?void 0:t.call(e))||(this.trace("callRefTimer.ref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),null==(i=(r=this.callRefTimer).ref)||i.call(r))}callRefTimerUnref(){var e,t;(!this.callRefTimer.hasRef||this.callRefTimer.hasRef())&&(this.trace("callRefTimer.unref | configSelectionQueue.length="+this.configSelectionQueue.length+" pickQueue.length="+this.pickQueue.length),null==(t=(e=this.callRefTimer).unref)||t.call(e))}removeConnectivityStateWatcher(e){let t=this.connectivityStateWatchers.findIndex(t=>t===e);t>=0&&this.connectivityStateWatchers.splice(t,1)}updateState(e){for(let t of((0,h.trace)(o.LogVerbosity.DEBUG,"connectivity_state","("+this.channelzRef.id+") "+(0,f.uriToString)(this.target)+" "+p.ConnectivityState[this.connectivityState]+" -> "+p.ConnectivityState[e]),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connectivity state change to "+p.ConnectivityState[e]),this.connectivityState=e,this.connectivityStateWatchers.slice()))e!==t.currentState&&(t.timer&&clearTimeout(t.timer),this.removeConnectivityStateWatcher(t),t.callback());e!==p.ConnectivityState.TRANSIENT_FAILURE&&(this.currentResolutionError=null)}throttleKeepalive(e){if(e>this.keepaliveTime)for(let t of(this.keepaliveTime=e,this.wrappedSubchannels))t.throttleKeepalive(e)}removeWrappedSubchannel(e){this.wrappedSubchannels.delete(e)}doPick(e,t){return this.currentPicker.pick({metadata:e,extraPickInfo:t})}queueCallForPick(e){this.pickQueue.push(e),this.callRefTimerRef()}getConfig(e,t){return(this.resolvingLoadBalancer.exitIdle(),this.configSelector)?{type:"SUCCESS",config:this.configSelector(e,t)}:this.currentResolutionError?{type:"ERROR",error:this.currentResolutionError}:{type:"NONE"}}queueCallForConfig(e){this.configSelectionQueue.push(e),this.callRefTimerRef()}enterIdle(){this.resolvingLoadBalancer.destroy(),this.updateState(p.ConnectivityState.IDLE),this.currentPicker=new a.QueuePicker(this.resolvingLoadBalancer),this.idleTimer&&(clearTimeout(this.idleTimer),this.idleTimer=null)}startIdleTimeout(e){var t,r;this.idleTimer=setTimeout(()=>{if(this.callCount>0)return void this.startIdleTimeout(this.idleTimeoutMs);let e=new Date().valueOf()-this.lastActivityTimestamp.valueOf();e>=this.idleTimeoutMs?(this.trace("Idle timer triggered after "+this.idleTimeoutMs+"ms of inactivity"),this.enterIdle()):this.startIdleTimeout(this.idleTimeoutMs-e)},e),null==(r=(t=this.idleTimer).unref)||r.call(t)}maybeStartIdleTimer(){this.connectivityState===p.ConnectivityState.SHUTDOWN||this.idleTimer||this.startIdleTimeout(this.idleTimeoutMs)}onCallStart(){this.channelzEnabled&&this.callTracker.addCallStarted(),this.callCount+=1}onCallEnd(e){this.channelzEnabled&&(e.code===o.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()),this.callCount-=1,this.lastActivityTimestamp=new Date,this.maybeStartIdleTimer()}createLoadBalancingCall(e,t,r,i,n){let s=(0,b.getNextCallNumber)();return this.trace("createLoadBalancingCall ["+s+'] method="'+t+'"'),new g.LoadBalancingCall(this,e,t,r,i,n,s)}createRetryingCall(e,t,r,i,n){let s=(0,b.getNextCallNumber)();return this.trace("createRetryingCall ["+s+'] method="'+t+'"'),new C.RetryingCall(this,e,t,r,i,n,s,this.retryBufferTracker,R.get(this.getTarget()))}createInnerCall(e,t,r,i,n){return 0===this.options["grpc.enable_retries"]?this.createLoadBalancingCall(e,t,r,i,n):this.createRetryingCall(e,t,r,i,n)}createResolvingCall(e,t,r,i,n){let s=(0,b.getNextCallNumber)();this.trace("createResolvingCall ["+s+'] method="'+e+'", deadline='+(0,y.deadlineToString)(t));let a={deadline:t,flags:null!=n?n:o.Propagate.DEFAULTS,host:null!=r?r:this.defaultAuthority,parentCall:i},l=new v.ResolvingCall(this,e,a,this.filterStackFactory.clone(),this.credentials._getCallCredentials(),s);return this.onCallStart(),l.addStatusWatcher(e=>{this.onCallEnd(e)}),l}close(){this.resolvingLoadBalancer.destroy(),this.updateState(p.ConnectivityState.SHUTDOWN),clearInterval(this.callRefTimer),this.idleTimer&&clearTimeout(this.idleTimer),this.channelzEnabled&&(0,m.unregisterChannelzRef)(this.channelzRef),this.subchannelPool.unrefUnusedSubchannels()}getTarget(){return(0,f.uriToString)(this.target)}getConnectivityState(e){let t=this.connectivityState;return e&&(this.resolvingLoadBalancer.exitIdle(),this.lastActivityTimestamp=new Date,this.maybeStartIdleTimer()),t}watchConnectivityState(e,t,r){if(this.connectivityState===p.ConnectivityState.SHUTDOWN)throw Error("Channel has been shut down");let i=null;if(t!==1/0){let e=t instanceof Date?t:new Date(t),s=new Date;if(t===-1/0||e<=s)return void process.nextTick(r,Error("Deadline passed without connectivity state change"));i=setTimeout(()=>{this.removeConnectivityStateWatcher(n),r(Error("Deadline passed without connectivity state change"))},e.getTime()-s.getTime())}let n={currentState:e,callback:r,timer:i};this.connectivityStateWatchers.push(n)}getChannelzRef(){return this.channelzRef}createCall(e,t,r,i,n){if("string"!=typeof e)throw TypeError("Channel#createCall: method must be a string");if(!("number"==typeof t||t instanceof Date))throw TypeError("Channel#createCall: deadline must be a number or Date");if(this.connectivityState===p.ConnectivityState.SHUTDOWN)throw Error("Channel has been shut down");return this.createResolvingCall(e,t,r,i,n)}}r.InternalChannel=O},12786,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ChannelImplementation=void 0;let i=e.r(11877),n=e.r(34028);class s{constructor(e,t,r){if("string"!=typeof e)throw TypeError("Channel target must be a string");if(!(t instanceof i.ChannelCredentials))throw TypeError("Channel credentials must be a ChannelCredentials object");if(r&&"object"!=typeof r)throw TypeError("Channel options must be an object");this.internalChannel=new n.InternalChannel(e,t,r)}close(){this.internalChannel.close()}getTarget(){return this.internalChannel.getTarget()}getConnectivityState(e){return this.internalChannel.getConnectivityState(e)}watchConnectivityState(e,t,r){this.internalChannel.watchConnectivityState(e,t,r)}getChannelzRef(){return this.internalChannel.getChannelzRef()}createCall(e,t,r,i,n){if("string"!=typeof e)throw TypeError("Channel#createCall: method must be a string");if(!("number"==typeof t||t instanceof Date))throw TypeError("Channel#createCall: deadline must be a number or Date");return this.internalChannel.createCall(e,t,r,i,n)}}r.ChannelImplementation=s},13196,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Http2ServerCallStream=r.ServerDuplexStreamImpl=r.ServerWritableStreamImpl=r.ServerReadableStreamImpl=r.ServerUnaryCallImpl=void 0;let i=e.r(27699),n=e.r(25328),s=e.r(88947),a=e.r(6461),o=e.r(7782),l=e.r(10409),c=e.r(80983),u=e.r(33137),h=e.r(44162),d="server_call";function f(e){u.trace(o.LogVerbosity.DEBUG,d,e)}let p="grpc-message",m="grpc-status",g="grpc-timeout",y=/(\d{1,8})\s*([HMSmun])/,v={H:36e5,M:6e4,S:1e3,m:1,u:.001,n:1e-6},b={"grpc-accept-encoding":"identity,deflate,gzip","grpc-encoding":"identity"},S={[n.constants.HTTP2_HEADER_STATUS]:n.constants.HTTP_STATUS_OK,[n.constants.HTTP2_HEADER_CONTENT_TYPE]:"application/grpc+proto"},C={waitForTrailers:!0};class T extends i.EventEmitter{constructor(e,t,r){super(),this.call=e,this.metadata=t,this.request=r,this.cancelled=!1,this.call.setupSurfaceCall(this)}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}}r.ServerUnaryCallImpl=T;class E extends s.Readable{constructor(e,t,r,i){super({objectMode:!0}),this.call=e,this.metadata=t,this.deserialize=r,this.cancelled=!1,this.call.setupSurfaceCall(this),this.call.setupReadable(this,i)}_read(e){this.call.consumeUnpushedMessages(this)&&this.call.resume()}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}}r.ServerReadableStreamImpl=E;class _ extends s.Writable{constructor(e,t,r,i){super({objectMode:!0}),this.call=e,this.metadata=t,this.serialize=r,this.request=i,this.cancelled=!1,this.trailingMetadata=new l.Metadata,this.call.setupSurfaceCall(this),this.on("error",e=>{this.call.sendError(e),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}_write(e,t,r){try{let t=this.call.serializeMessage(e);if(!this.call.write(t))return void this.call.once("drain",r)}catch(e){this.emit("error",{details:(0,h.getErrorMessage)(e),code:o.Status.INTERNAL})}r()}_final(e){this.call.sendStatus({code:o.Status.OK,details:"OK",metadata:this.trailingMetadata}),e(null)}end(e){return e&&(this.trailingMetadata=e),super.end()}}r.ServerWritableStreamImpl=_;class w extends s.Duplex{constructor(e,t,r,i,n){super({objectMode:!0}),this.call=e,this.metadata=t,this.serialize=r,this.deserialize=i,this.cancelled=!1,this.trailingMetadata=new l.Metadata,this.call.setupSurfaceCall(this),this.call.setupReadable(this,n),this.on("error",e=>{this.call.sendError(e),this.end()})}getPeer(){return this.call.getPeer()}sendMetadata(e){this.call.sendMetadata(e)}getDeadline(){return this.call.getDeadline()}getPath(){return this.call.getPath()}end(e){return e&&(this.trailingMetadata=e),super.end()}}r.ServerDuplexStreamImpl=w,w.prototype._read=E.prototype._read,w.prototype._write=_.prototype._write,w.prototype._final=_.prototype._final;class R extends i.EventEmitter{constructor(e,t,r){super(),this.stream=e,this.handler=t,this.cancelled=!1,this.deadlineTimer=null,this.statusSent=!1,this.deadline=1/0,this.wantTrailers=!1,this.metadataSent=!1,this.canPush=!1,this.isPushPending=!1,this.bufferedMessages=[],this.messagesToPush=[],this.maxSendMessageSize=o.DEFAULT_MAX_SEND_MESSAGE_LENGTH,this.maxReceiveMessageSize=o.DEFAULT_MAX_RECEIVE_MESSAGE_LENGTH,this.stream.once("error",e=>{}),this.stream.once("close",()=>{var e;f("Request to method "+(null==(e=this.handler)?void 0:e.path)+" stream closed with rstCode "+this.stream.rstCode),!this.statusSent&&(this.cancelled=!0,this.emit("cancelled","cancelled"),this.emit("streamEnd",!1),this.sendStatus({code:o.Status.CANCELLED,details:"Cancelled by client",metadata:null}),this.deadlineTimer&&clearTimeout(this.deadlineTimer))}),this.stream.on("drain",()=>{this.emit("drain")}),"grpc.max_send_message_length"in r&&(this.maxSendMessageSize=r["grpc.max_send_message_length"]),"grpc.max_receive_message_length"in r&&(this.maxReceiveMessageSize=r["grpc.max_receive_message_length"])}checkCancelled(){return(this.stream.destroyed||this.stream.closed)&&(this.cancelled=!0),this.cancelled}getDecompressedMessage(e,t){let r=e.subarray(5);if("identity"===t)return r;if("deflate"!==t&&"gzip"!==t)return Promise.reject({code:o.Status.UNIMPLEMENTED,details:`Received message compressed with unsupported encoding "${t}"`});{let e;return e="deflate"===t?a.createInflate():a.createGunzip(),new Promise((t,i)=>{let n=0,s=[];e.on("data",t=>{s.push(t),n+=t.byteLength,-1!==this.maxReceiveMessageSize&&n>this.maxReceiveMessageSize&&(e.destroy(),i({code:o.Status.RESOURCE_EXHAUSTED,details:`Received message that decompresses to a size larger than ${this.maxReceiveMessageSize}`}))}),e.on("end",()=>{t(Buffer.concat(s))}),e.write(r),e.end()})}}sendMetadata(e){if(this.checkCancelled()||this.metadataSent)return;this.metadataSent=!0;let t=e?e.toHttp2Headers():null,r=Object.assign(Object.assign(Object.assign({},S),b),t);this.stream.respond(r,C)}receiveMetadata(e){let t=l.Metadata.fromHttp2Headers(e);u.isTracerEnabled(d)&&f("Request to "+this.handler.path+" received headers "+JSON.stringify(t.toJSON()));let r=t.get(g);if(r.length>0){let e=r[0].toString().match(y);if(null===e){let e=Error("Invalid deadline");return e.code=o.Status.OUT_OF_RANGE,this.sendError(e),t}let i=e[1]*v[e[2]]|0,n=new Date;this.deadline=n.setMilliseconds(n.getMilliseconds()+i),this.deadlineTimer=setTimeout(k,i,this),t.remove(g)}return t.remove(n.constants.HTTP2_HEADER_ACCEPT_ENCODING),t.remove(n.constants.HTTP2_HEADER_TE),t.remove(n.constants.HTTP2_HEADER_CONTENT_TYPE),t.remove("grpc-accept-encoding"),t}receiveUnaryMessage(e){return new Promise((t,r)=>{let{stream:i}=this,n=0,s=this,a=[],l=this.maxReceiveMessageSize;function c(e){if(n+=e.byteLength,-1!==l&&n>l){i.removeListener("data",c),i.removeListener("end",u),i.removeListener("error",u),r({code:o.Status.RESOURCE_EXHAUSTED,details:`Received message larger than max (${n} vs. ${l})`});return}a.push(e)}function u(l){if(i.removeListener("data",c),i.removeListener("end",u),i.removeListener("error",u),void 0!==l)return void r({code:o.Status.INTERNAL,details:l.message});if(0===n)return void r({code:o.Status.INTERNAL,details:"received empty unary message"});s.emit("receiveMessage");let h=Buffer.concat(a,n),d=1===h.readUInt8(0)?e:"identity",f=s.getDecompressedMessage(h,d);Buffer.isBuffer(f)?t(s.deserializeMessageWithInternalError(f)):f.then(e=>t(s.deserializeMessageWithInternalError(e)),t=>r(t.code?t:{code:o.Status.INTERNAL,details:`Received "grpc-encoding" header "${e}" but ${e} decompression failed`}))}this.stream.on("data",c),this.stream.on("end",u),this.stream.on("error",u)})}async deserializeMessageWithInternalError(e){try{return this.deserializeMessage(e)}catch(e){throw{details:(0,h.getErrorMessage)(e),code:o.Status.INTERNAL}}}serializeMessage(e){let t=this.handler.serialize(e),r=t.byteLength,i=Buffer.allocUnsafe(r+5);return i.writeUInt8(0,0),i.writeUInt32BE(r,1),t.copy(i,5),i}deserializeMessage(e){return this.handler.deserialize(e)}async sendUnaryMessage(e,t,r,i){if(!this.checkCancelled()){if(void 0===r&&(r=null),e){!Object.prototype.hasOwnProperty.call(e,"metadata")&&r&&(e.metadata=r),this.sendError(e);return}try{let e=this.serializeMessage(t);this.write(e),this.sendStatus({code:o.Status.OK,details:"OK",metadata:r})}catch(e){this.sendError({details:(0,h.getErrorMessage)(e),code:o.Status.INTERNAL})}}}sendStatus(e){var t,r;if(this.emit("callEnd",e.code),this.emit("streamEnd",e.code===o.Status.OK),!this.checkCancelled())if(f("Request to method "+(null==(t=this.handler)?void 0:t.path)+" ended with status code: "+o.Status[e.code]+" details: "+e.details),this.deadlineTimer&&clearTimeout(this.deadlineTimer),this.stream.headersSent)this.wantTrailers||(this.wantTrailers=!0,this.stream.once("wantTrailers",()=>{var t;let r=Object.assign({[m]:e.code,[p]:encodeURI(e.details)},null==(t=e.metadata)?void 0:t.toHttp2Headers());this.stream.sendTrailers(r),this.statusSent=!0}),this.stream.end());else{let t=Object.assign(Object.assign({[m]:e.code,[p]:encodeURI(e.details)},S),null==(r=e.metadata)?void 0:r.toHttp2Headers());this.stream.respond(t,{endStream:!0}),this.statusSent=!0}}sendError(e){let t={code:o.Status.UNKNOWN,details:"message"in e?e.message:"Unknown Error",metadata:"metadata"in e&&void 0!==e.metadata?e.metadata:null};"code"in e&&"number"==typeof e.code&&Number.isInteger(e.code)&&(t.code=e.code,"details"in e&&"string"==typeof e.details&&(t.details=e.details)),this.sendStatus(t)}write(e){if(!this.checkCancelled())return -1!==this.maxSendMessageSize&&e.length>this.maxSendMessageSize?void this.sendError({code:o.Status.RESOURCE_EXHAUSTED,details:`Sent message larger than max (${e.length} vs. ${this.maxSendMessageSize})`}):(this.sendMetadata(),this.emit("sendMessage"),this.stream.write(e))}resume(){this.stream.resume()}setupSurfaceCall(e){this.once("cancelled",t=>{e.cancelled=!0,e.emit("cancelled",t)}),this.once("callEnd",t=>e.emit("callEnd",t))}setupReadable(e,t){let r=new c.StreamDecoder(this.maxReceiveMessageSize),i=!1,n=!1,s=!1,a=async()=>{s||!i||n||(s=!0,await this.pushOrBufferMessage(e,null))};this.stream.on("data",async i=>{let s;try{s=r.write(i)}catch(e){this.sendError({code:o.Status.RESOURCE_EXHAUSTED,details:e.message});return}for(let r of(n=!0,this.stream.pause(),s)){let i;this.emit("receiveMessage");let n=1===r.readUInt8(0)?t:"identity";try{i=await this.getDecompressedMessage(r,n)}catch(e){this.sendError(e);return}if(!i)return;await this.pushOrBufferMessage(e,i)}n=!1,this.stream.resume(),await a()}),this.stream.once("end",async()=>{i=!0,await a()})}consumeUnpushedMessages(e){for(this.canPush=!0;this.messagesToPush.length>0;){let t=this.messagesToPush.shift(),r=e.push(t);if(null===t||!1===r){this.canPush=!1;break}}return this.canPush}async pushOrBufferMessage(e,t){this.isPushPending?this.bufferedMessages.push(t):await this.pushMessage(e,t)}async pushMessage(e,t){if(null===t){f("Received end of stream"),this.canPush?e.push(null):this.messagesToPush.push(null);return}f("Received message of length "+t.length),this.isPushPending=!0;try{let r=await this.deserializeMessage(t);this.canPush?e.push(r)||(this.canPush=!1,this.stream.pause()):this.messagesToPush.push(r)}catch(r){this.bufferedMessages.length=0;let t=(0,h.getErrorCode)(r);(null===t||t<o.Status.OK||t>o.Status.UNAUTHENTICATED)&&(t=o.Status.INTERNAL),e.emit("error",{details:(0,h.getErrorMessage)(r),code:t})}this.isPushPending=!1,this.bufferedMessages.length>0&&await this.pushMessage(e,this.bufferedMessages.shift())}getPeer(){var e;let t=null==(e=this.stream.session)?void 0:e.socket;return null!=t&&t.remoteAddress?t.remotePort?`${t.remoteAddress}:${t.remotePort}`:t.remoteAddress:"unknown"}getDeadline(){return this.deadline}getPath(){return this.handler.path}}function k(e){let t=Error("Deadline exceeded");t.code=o.Status.DEADLINE_EXCEEDED,e.sendError(t),e.cancelled=!0,e.emit("cancelled","deadline")}r.Http2ServerCallStream=R},41727,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.ServerCredentials=void 0;let i=e.r(19335);class n{static createInsecure(){return new s}static createSsl(e,t,r=!1){if(null!==e&&!Buffer.isBuffer(e))throw TypeError("rootCerts must be null or a Buffer");if(!Array.isArray(t))throw TypeError("keyCertPairs must be an array");if("boolean"!=typeof r)throw TypeError("checkClientCertificate must be a boolean");let n=[],s=[];for(let e=0;e<t.length;e++){let r=t[e];if(null===r||"object"!=typeof r)throw TypeError(`keyCertPair[${e}] must be an object`);if(!Buffer.isBuffer(r.private_key))throw TypeError(`keyCertPair[${e}].private_key must be a Buffer`);if(!Buffer.isBuffer(r.cert_chain))throw TypeError(`keyCertPair[${e}].cert_chain must be a Buffer`);n.push(r.cert_chain),s.push(r.private_key)}return new a({ca:e||(0,i.getDefaultRootsData)()||void 0,cert:n,key:s,requestCert:r,ciphers:i.CIPHER_SUITES})}}r.ServerCredentials=n;class s extends n{_isSecure(){return!1}_getSettings(){return null}}class a extends n{constructor(e){super(),this.options=e}_isSecure(){return!0}_getSettings(){return this.options}}},88324,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.Server=void 0;let i=e.r(25328),n=e.r(7782),s=e.r(13196),a=e.r(41727),o=e.r(54718),l=e.r(33137),c=e.r(76054),u=e.r(177),h=e.r(23023),d=0x7fffffff,f=0x7fffffff,p=2e4,{HTTP2_HEADER_PATH:m}=i.constants,g="server";function y(){}function v(e){return{code:n.Status.UNIMPLEMENTED,details:`The server does not implement the method ${e}`}}function b(e,t){let r=v(t);switch(e){case"unary":return(e,t)=>{t(r,null)};case"clientStream":return(e,t)=>{t(r,null)};case"serverStream":return e=>{e.emit("error",r)};case"bidi":return e=>{e.emit("error",r)};default:throw Error(`Invalid handlerType ${e}`)}}class S{constructor(e){var t,r,i,n;this.http2ServerList=[],this.handlers=new Map,this.sessions=new Map,this.started=!1,this.shutdown=!1,this.serverAddressString="null",this.channelzEnabled=!0,this.channelzTrace=new h.ChannelzTrace,this.callTracker=new h.ChannelzCallTracker,this.listenerChildrenTracker=new h.ChannelzChildrenTracker,this.sessionChildrenTracker=new h.ChannelzChildrenTracker,this.options=null!=e?e:{},0===this.options["grpc.enable_channelz"]&&(this.channelzEnabled=!1),this.channelzRef=(0,h.registerChannelzServer)(()=>this.getChannelzInfo(),this.channelzEnabled),this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Server created"),this.maxConnectionAgeMs=null!=(t=this.options["grpc.max_connection_age_ms"])?t:d,this.maxConnectionAgeGraceMs=null!=(r=this.options["grpc.max_connection_age_grace_ms"])?r:d,this.keepaliveTimeMs=null!=(i=this.options["grpc.keepalive_time_ms"])?i:f,this.keepaliveTimeoutMs=null!=(n=this.options["grpc.keepalive_timeout_ms"])?n:p,this.trace("Server constructed")}getChannelzInfo(){return{trace:this.channelzTrace,callTracker:this.callTracker,listenerChildren:this.listenerChildrenTracker.getChildLists(),sessionChildren:this.sessionChildrenTracker.getChildLists()}}getChannelzSessionInfoGetter(e){return()=>{var t,r,i;let n,s=this.sessions.get(e),a=e.socket,o=a.remoteAddress?(0,c.stringToSubchannelAddress)(a.remoteAddress,a.remotePort):null,l=a.localAddress?(0,c.stringToSubchannelAddress)(a.localAddress,a.localPort):null;if(e.encrypted){let e=a,r=e.getCipher(),i=e.getCertificate(),s=e.getPeerCertificate();n={cipherSuiteStandardName:null!=(t=r.standardName)?t:null,cipherSuiteOtherName:r.standardName?null:r.name,localCertificate:i&&"raw"in i?i.raw:null,remoteCertificate:s&&"raw"in s?s.raw:null}}else n=null;return{remoteAddress:o,localAddress:l,security:n,remoteName:null,streamsStarted:s.streamTracker.callsStarted,streamsSucceeded:s.streamTracker.callsSucceeded,streamsFailed:s.streamTracker.callsFailed,messagesSent:s.messagesSent,messagesReceived:s.messagesReceived,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:s.streamTracker.lastCallStartedTimestamp,lastMessageSentTimestamp:s.lastMessageSentTimestamp,lastMessageReceivedTimestamp:s.lastMessageReceivedTimestamp,localFlowControlWindow:null!=(r=e.state.localWindowSize)?r:null,remoteFlowControlWindow:null!=(i=e.state.remoteWindowSize)?i:null}}}trace(e){l.trace(n.LogVerbosity.DEBUG,g,"("+this.channelzRef.id+") "+e)}addProtoService(){throw Error("Not implemented. Use addService() instead")}addService(e,t){if(null===e||"object"!=typeof e||null===t||"object"!=typeof t)throw Error("addService() requires two objects as arguments");let r=Object.keys(e);if(0===r.length)throw Error("Cannot add an empty service to a server");r.forEach(r=>{let i,n,s=e[r];i=s.requestStream?s.responseStream?"bidi":"clientStream":s.responseStream?"serverStream":"unary";let a=t[r];if(void 0===a&&"string"==typeof s.originalName&&(a=t[s.originalName]),n=void 0!==a?a.bind(t):b(i,r),!1===this.register(s.path,n,s.responseSerialize,s.requestDeserialize,i))throw Error(`Method handler for ${s.path} already provided.`)})}removeService(e){if(null===e||"object"!=typeof e)throw Error("removeService() requires object as argument");Object.keys(e).forEach(t=>{let r=e[t];this.unregister(r.path)})}bind(e,t){throw Error("Not implemented. Use bindAsync() instead")}bindAsync(e,t,r){if(!0===this.started)throw Error("server is already started");if(this.shutdown)throw Error("bindAsync called after shutdown");if("string"!=typeof e)throw TypeError("port must be a string");if(null===t||!(t instanceof a.ServerCredentials))throw TypeError("creds must be a ServerCredentials object");if("function"!=typeof r)throw TypeError("callback must be a function");let s=(0,u.parseUri)(e);if(null===s)throw Error(`Could not parse port "${e}"`);let d=(0,o.mapUriDefaultScheme)(s);if(null===d)throw Error(`Could not get a default scheme for port "${e}"`);let f={maxSendHeaderBlockLength:Number.MAX_SAFE_INTEGER};"grpc-node.max_session_memory"in this.options?f.maxSessionMemory=this.options["grpc-node.max_session_memory"]:f.maxSessionMemory=Number.MAX_SAFE_INTEGER,"grpc.max_concurrent_streams"in this.options&&(f.settings={maxConcurrentStreams:this.options["grpc.max_concurrent_streams"]});let p=(e,t)=>{process.nextTick(()=>r(e,t))},m=()=>{let e;if(t._isSecure()){let r=Object.assign(f,t._getSettings());r.enableTrace=1===this.options["grpc-node.tls_enable_trace"],(e=i.createSecureServer(r)).on("secureConnection",e=>{e.on("error",e=>{this.trace("An incoming TLS connection closed with error: "+e.message)})})}else e=i.createServer(f);return e.setTimeout(0,y),this._setupHandlers(e),e},g=(e,t,r)=>0===e.length?Promise.resolve({port:t,count:r}):Promise.all(e.map(e=>{let r;this.trace("Attempting to bind "+(0,c.subchannelAddressToString)(e)),r=(0,c.isTcpSubchannelAddress)(e)?{host:e.host,port:t}:e;let i=m();return new Promise((n,s)=>{let a=t=>{this.trace("Failed to bind "+(0,c.subchannelAddressToString)(e)+" with error "+t.message),n(t)};i.once("error",a),i.listen(r,()=>{let e;if(this.shutdown){i.close(),n(Error("bindAsync failed because server is shutdown"));return}let r=i.address();e="string"==typeof r?{path:r}:{host:r.address,port:r.port};let s=(0,h.registerChannelzSocket)((0,c.subchannelAddressToString)(e),()=>({localAddress:e,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled);this.channelzEnabled&&this.listenerChildrenTracker.refChild(s),this.http2ServerList.push({server:i,channelzRef:s}),this.trace("Successfully bound "+(0,c.subchannelAddressToString)(e)),n("port"in e?e.port:t),i.removeListener("error",a)})})})).then(e=>{let i=0;for(let r of e)if("number"==typeof r&&(i+=1,r!==t))throw Error("Invalid state: multiple port numbers added from single address");return{port:t,count:i+r}}),v=e=>{if(0===e.length)return Promise.resolve({port:0,count:0});let t=e[0],r=m();return new Promise((i,n)=>{let s=r=>{this.trace("Failed to bind "+(0,c.subchannelAddressToString)(t)+" with error "+r.message),i(v(e.slice(1)))};r.once("error",s),r.listen(t,()=>{if(this.shutdown){r.close(),i({port:0,count:0});return}let t=r.address(),n={host:t.address,port:t.port},a=(0,h.registerChannelzSocket)((0,c.subchannelAddressToString)(n),()=>({localAddress:n,remoteAddress:null,security:null,remoteName:null,streamsStarted:0,streamsSucceeded:0,streamsFailed:0,messagesSent:0,messagesReceived:0,keepAlivesSent:0,lastLocalStreamCreatedTimestamp:null,lastRemoteStreamCreatedTimestamp:null,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null,localFlowControlWindow:null,remoteFlowControlWindow:null}),this.channelzEnabled);this.channelzEnabled&&this.listenerChildrenTracker.refChild(a),this.http2ServerList.push({server:r,channelzRef:a}),this.trace("Successfully bound "+(0,c.subchannelAddressToString)(n)),i(g(e.slice(1),t.port,1)),r.removeListener("error",s)})})},b={onSuccessfulResolution:(t,r,i)=>{let s;(b.onSuccessfulResolution=()=>{},this.shutdown&&p(Error("bindAsync failed because server is shutdown"),0),0===t.length)?p(Error(`No addresses resolved for port ${e}`),0):(s=(0,c.isTcpSubchannelAddress)(t[0])?0===t[0].port?v(t):g(t,t[0].port,0):g(t,1,0)).then(e=>{if(0===e.count){let e=`No address added out of total ${t.length} resolved`;l.log(n.LogVerbosity.ERROR,e),p(Error(e),0)}else e.count<t.length&&l.log(n.LogVerbosity.INFO,`WARNING Only ${e.count} addresses added out of total ${t.length} resolved`),p(null,e.port)},e=>{let r=`No address added out of total ${t.length} resolved`;l.log(n.LogVerbosity.ERROR,r),p(Error(r),0)})},onError:e=>{p(Error(e.details),0)}};(0,o.createResolver)(d,b,this.options).updateResolution()}forceShutdown(){for(let{server:e,channelzRef:t}of this.http2ServerList)e.listening&&e.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(t),(0,h.unregisterChannelzRef)(t))});this.started=!1,this.shutdown=!0,this.sessions.forEach((e,t)=>{t.destroy(i.constants.NGHTTP2_CANCEL)}),this.sessions.clear(),this.channelzEnabled&&(0,h.unregisterChannelzRef)(this.channelzRef)}register(e,t,r,i,n){return!this.handlers.has(e)&&(this.handlers.set(e,{func:t,serialize:r,deserialize:i,type:n,path:e}),!0)}unregister(e){return this.handlers.delete(e)}start(){if(0===this.http2ServerList.length||this.http2ServerList.every(({server:e})=>!0!==e.listening))throw Error("server must be bound in order to start");if(!0===this.started)throw Error("server is already started");this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Starting"),this.started=!0}tryShutdown(e){let t=t=>{this.channelzEnabled&&(0,h.unregisterChannelzRef)(this.channelzRef),e(t)},r=0;function i(){0==--r&&t()}for(let{server:e,channelzRef:t}of(this.started=!1,this.shutdown=!0,this.http2ServerList))e.listening&&(r++,e.close(()=>{this.channelzEnabled&&(this.listenerChildrenTracker.unrefChild(t),(0,h.unregisterChannelzRef)(t)),i()}));this.sessions.forEach((e,t)=>{t.closed||(r+=1,t.close(i))}),0===r&&t()}addHttp2Port(){throw Error("Not yet implemented")}getChannelzRef(){return this.channelzRef}_verifyContentType(e,t){let r=t[i.constants.HTTP2_HEADER_CONTENT_TYPE];return"string"==typeof r&&!!r.startsWith("application/grpc")||(e.respond({[i.constants.HTTP2_HEADER_STATUS]:i.constants.HTTP_STATUS_UNSUPPORTED_MEDIA_TYPE},{endStream:!0}),!1)}_retrieveHandler(e){this.trace("Received call to method "+e+" at address "+this.serverAddressString);let t=this.handlers.get(e);return void 0===t?(this.trace("No handler registered for method "+e+". Sending UNIMPLEMENTED status."),null):t}_respondWithError(e,t,r=null){let i=new s.Http2ServerCallStream(t,null,this.options);void 0===e.code&&(e.code=n.Status.INTERNAL),this.channelzEnabled&&(this.callTracker.addCallFailed(),null==r||r.streamTracker.addCallFailed()),i.sendError(e)}_channelzHandler(e,t){let r=this.sessions.get(e.session);if(this.callTracker.addCallStarted(),null==r||r.streamTracker.addCallStarted(),!this._verifyContentType(e,t)){this.callTracker.addCallFailed(),null==r||r.streamTracker.addCallFailed();return}let i=t[m],a=this._retrieveHandler(i);if(!a)return void this._respondWithError(v(i),e,r);let o=new s.Http2ServerCallStream(e,a,this.options);o.once("callEnd",e=>{e===n.Status.OK?this.callTracker.addCallSucceeded():this.callTracker.addCallFailed()}),r&&(o.once("streamEnd",e=>{e?r.streamTracker.addCallSucceeded():r.streamTracker.addCallFailed()}),o.on("sendMessage",()=>{r.messagesSent+=1,r.lastMessageSentTimestamp=new Date}),o.on("receiveMessage",()=>{r.messagesReceived+=1,r.lastMessageReceivedTimestamp=new Date})),this._runHandlerForCall(o,a,t)||(this.callTracker.addCallFailed(),null==r||r.streamTracker.addCallFailed(),o.sendError({code:n.Status.INTERNAL,details:`Unknown handler type: ${a.type}`}))}_streamHandler(e,t){if(!0!==this._verifyContentType(e,t))return;let r=t[m],i=this._retrieveHandler(r);if(!i)return void this._respondWithError(v(r),e,null);let a=new s.Http2ServerCallStream(e,i,this.options);this._runHandlerForCall(a,i,t)||a.sendError({code:n.Status.INTERNAL,details:`Unknown handler type: ${i.type}`})}_runHandlerForCall(e,t,r){var i;let n=e.receiveMetadata(r),s=null!=(i=n.get("grpc-encoding")[0])?i:"identity";n.remove("grpc-encoding");let{type:a}=t;if("unary"===a)C(e,t,n,s);else if("clientStream"===a)T(e,t,n,s);else if("serverStream"===a)E(e,t,n,s);else{if("bidi"!==a)return!1;_(e,t,n,s)}return!0}_setupHandlers(e){if(null===e)return;let t=e.address(),r="null";t&&(r="string"==typeof t?t:t.address+":"+t.port),this.serverAddressString=r;let n=this.channelzEnabled?this._channelzHandler:this._streamHandler;e.on("stream",n.bind(this)),e.on("session",e=>{var t,r,n,s,a;if(!this.started)return void e.destroy();let o=(0,h.registerChannelzSocket)(null!=(t=e.socket.remoteAddress)?t:"unknown",this.getChannelzSessionInfoGetter(e),this.channelzEnabled),l={ref:o,streamTracker:new h.ChannelzCallTracker,messagesSent:0,messagesReceived:0,lastMessageSentTimestamp:null,lastMessageReceivedTimestamp:null};this.sessions.set(e,l);let c=e.socket.remoteAddress;this.channelzEnabled&&(this.channelzTrace.addTrace("CT_INFO","Connection established by client "+c),this.sessionChildrenTracker.refChild(o));let u=null,f=null,p=!1;if(this.maxConnectionAgeMs!==d){let t=this.maxConnectionAgeMs/10,s=Math.random()*t*2-t;u=null==(n=(r=setTimeout(()=>{var t,r;p=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by max connection age from "+c);try{e.goaway(i.constants.NGHTTP2_NO_ERROR,0x7fffffff,Buffer.from("max_age"))}catch(t){e.destroy();return}e.close(),this.maxConnectionAgeGraceMs!==d&&(f=null==(r=(t=setTimeout(()=>{e.destroy()},this.maxConnectionAgeGraceMs)).unref)?void 0:r.call(t))},this.maxConnectionAgeMs+s)).unref)?void 0:n.call(r)}let m=null==(a=(s=setInterval(()=>{var t,r;let i=null==(r=(t=setTimeout(()=>{p=!0,this.channelzEnabled&&this.channelzTrace.addTrace("CT_INFO","Connection dropped by keepalive timeout from "+c),e.close()},this.keepaliveTimeoutMs)).unref)?void 0:r.call(t);try{e.ping((e,t,r)=>{clearTimeout(i)})}catch(t){e.destroy()}},this.keepaliveTimeMs)).unref)?void 0:a.call(s);e.on("close",()=>{this.channelzEnabled&&(p||this.channelzTrace.addTrace("CT_INFO","Connection dropped by client "+c),this.sessionChildrenTracker.unrefChild(o),(0,h.unregisterChannelzRef)(o)),u&&clearTimeout(u),f&&clearTimeout(f),m&&clearTimeout(m),this.sessions.delete(e)})})}}async function C(e,t,r,i){try{let n=await e.receiveUnaryMessage(i);if(void 0===n||e.cancelled)return;let a=new s.ServerUnaryCallImpl(e,r,n);t.func(a,(t,r,i,n)=>{e.sendUnaryMessage(t,r,i,n)})}catch(t){e.sendError(t)}}function T(e,t,r,i){let n=new s.ServerReadableStreamImpl(e,r,t.deserialize,i);function a(t,r,i,s){n.destroy(),e.sendUnaryMessage(t,r,i,s)}e.cancelled||(n.on("error",a),t.func(n,a))}async function E(e,t,r,i){try{let n=await e.receiveUnaryMessage(i);if(void 0===n||e.cancelled)return;let a=new s.ServerWritableStreamImpl(e,r,t.serialize,n);t.func(a)}catch(t){e.sendError(t)}}function _(e,t,r,i){let n=new s.ServerDuplexStreamImpl(e,r,t.serialize,t.deserialize,i);e.cancelled||t.func(n)}r.Server=S},54489,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.StatusBuilder=void 0;class i{constructor(){this.code=null,this.details=null,this.metadata=null}withCode(e){return this.code=e,this}withDetails(e){return this.details=e,this}withMetadata(e){return this.metadata=e,this}build(){let e={};return null!==this.code&&(e.code=this.code),null!==this.details&&(e.details=this.details),null!==this.metadata&&(e.metadata=this.metadata),e}}r.StatusBuilder=i},52703,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.isDuration=r.durationToMs=r.msToDuration=void 0,r.msToDuration=function(e){return{seconds:e/1e3|0,nanos:e%1e3*1e6|0}},r.durationToMs=function(e){return 1e3*e.seconds+e.nanos/1e6|0},r.isDuration=function(e){return"number"==typeof e.seconds&&"number"==typeof e.nanos}},53432,(e,t,r)=>{"use strict";var i;Object.defineProperty(r,"__esModule",{value:!0}),r.setup=r.OutlierDetectionLoadBalancer=r.OutlierDetectionLoadBalancingConfig=void 0;let n=e.r(35967),s=e.r(7782),a=e.r(52703),o=e.r(49549),l=e.r(29068),c=e.r(52387),u=e.r(32199),h=e.r(76054),d=e.r(22664),f=e.r(33137),p="outlier_detection";function m(e){f.trace(s.LogVerbosity.DEBUG,p,e)}let g="outlier_detection",y=(null!=(i=process.env.GRPC_EXPERIMENTAL_ENABLE_OUTLIER_DETECTION)?i:"true")==="true",v={stdev_factor:1900,enforcement_percentage:100,minimum_hosts:5,request_volume:100},b={threshold:85,enforcement_percentage:100,minimum_hosts:5,request_volume:50};function S(e,t,r,i){if(t in e&&typeof e[t]!==r){let n=i?`${i}.${t}`:t;throw Error(`outlier detection config ${n} parse error: expected ${r}, got ${typeof e[t]}`)}}function C(e,t,r){let i=r?`${r}.${t}`:t;if(t in e){if(!(0,a.isDuration)(e[t]))throw Error(`outlier detection config ${i} parse error: expected Duration, got ${typeof e[t]}`);if(!(e[t].seconds>=0&&e[t].seconds<=315576e6&&e[t].nanos>=0&&e[t].nanos<=0x3b9ac9ff))throw Error(`outlier detection config ${i} parse error: values out of range for non-negative Duaration`)}}function T(e,t,r){let i=r?`${r}.${t}`:t;if(S(e,t,"number",r),t in e&&!(e[t]>=0&&e[t]<=100))throw Error(`outlier detection config ${i} parse error: value out of range for percentage (0-100)`)}class E{constructor(e,t,r,i,n,s,a){if(this.childPolicy=a,a.length>0&&"pick_first"===a[0].getLoadBalancerName())throw Error("outlier_detection LB policy cannot have a pick_first child policy");this.intervalMs=null!=e?e:1e4,this.baseEjectionTimeMs=null!=t?t:3e4,this.maxEjectionTimeMs=null!=r?r:3e5,this.maxEjectionPercent=null!=i?i:10,this.successRateEjection=n?Object.assign(Object.assign({},v),n):null,this.failurePercentageEjection=s?Object.assign(Object.assign({},b),s):null}getLoadBalancerName(){return g}toJsonObject(){return{interval:(0,a.msToDuration)(this.intervalMs),base_ejection_time:(0,a.msToDuration)(this.baseEjectionTimeMs),max_ejection_time:(0,a.msToDuration)(this.maxEjectionTimeMs),max_ejection_percent:this.maxEjectionPercent,success_rate_ejection:this.successRateEjection,failure_percentage_ejection:this.failurePercentageEjection,child_policy:this.childPolicy.map(e=>e.toJsonObject())}}getIntervalMs(){return this.intervalMs}getBaseEjectionTimeMs(){return this.baseEjectionTimeMs}getMaxEjectionTimeMs(){return this.maxEjectionTimeMs}getMaxEjectionPercent(){return this.maxEjectionPercent}getSuccessRateEjectionConfig(){return this.successRateEjection}getFailurePercentageEjectionConfig(){return this.failurePercentageEjection}getChildPolicy(){return this.childPolicy}copyWithChildPolicy(e){return new E(this.intervalMs,this.baseEjectionTimeMs,this.maxEjectionTimeMs,this.maxEjectionPercent,this.successRateEjection,this.failurePercentageEjection,e)}static createFromJson(e){var t;if(C(e,"interval"),C(e,"base_ejection_time"),C(e,"max_ejection_time"),T(e,"max_ejection_percent"),"success_rate_ejection"in e){if("object"!=typeof e.success_rate_ejection)throw Error("outlier detection config success_rate_ejection must be an object");S(e.success_rate_ejection,"stdev_factor","number","success_rate_ejection"),T(e.success_rate_ejection,"enforcement_percentage","success_rate_ejection"),S(e.success_rate_ejection,"minimum_hosts","number","success_rate_ejection"),S(e.success_rate_ejection,"request_volume","number","success_rate_ejection")}if("failure_percentage_ejection"in e){if("object"!=typeof e.failure_percentage_ejection)throw Error("outlier detection config failure_percentage_ejection must be an object");T(e.failure_percentage_ejection,"threshold","failure_percentage_ejection"),T(e.failure_percentage_ejection,"enforcement_percentage","failure_percentage_ejection"),S(e.failure_percentage_ejection,"minimum_hosts","number","failure_percentage_ejection"),S(e.failure_percentage_ejection,"request_volume","number","failure_percentage_ejection")}return new E(e.interval?(0,a.durationToMs)(e.interval):null,e.base_ejection_time?(0,a.durationToMs)(e.base_ejection_time):null,e.max_ejection_time?(0,a.durationToMs)(e.max_ejection_time):null,null!=(t=e.max_ejection_percent)?t:null,e.success_rate_ejection,e.failure_percentage_ejection,e.child_policy.map(l.validateLoadBalancingConfig))}}r.OutlierDetectionLoadBalancingConfig=E;class _ extends d.BaseSubchannelWrapper{constructor(e,t){super(e),this.mapEntry=t,this.stateListeners=[],this.ejected=!1,this.refCount=0,this.childSubchannelState=e.getConnectivityState(),e.addConnectivityStateListener((e,t,r,i)=>{if(this.childSubchannelState=r,!this.ejected)for(let e of this.stateListeners)e(this,t,r,i)})}getConnectivityState(){return this.ejected?n.ConnectivityState.TRANSIENT_FAILURE:this.childSubchannelState}addConnectivityStateListener(e){this.stateListeners.push(e)}removeConnectivityStateListener(e){let t=this.stateListeners.indexOf(e);t>-1&&this.stateListeners.splice(t,1)}ref(){this.child.ref(),this.refCount+=1}unref(){if(this.child.unref(),this.refCount-=1,this.refCount<=0&&this.mapEntry){let e=this.mapEntry.subchannelWrappers.indexOf(this);e>=0&&this.mapEntry.subchannelWrappers.splice(e,1)}}eject(){for(let e of(this.ejected=!0,this.stateListeners))e(this,this.childSubchannelState,n.ConnectivityState.TRANSIENT_FAILURE,-1)}uneject(){for(let e of(this.ejected=!1,this.stateListeners))e(this,n.ConnectivityState.TRANSIENT_FAILURE,this.childSubchannelState,-1)}getMapEntry(){return this.mapEntry}getWrappedSubchannel(){return this.child}}function w(){return{success:0,failure:0}}class R{constructor(){this.activeBucket=w(),this.inactiveBucket=w()}addSuccess(){this.activeBucket.success+=1}addFailure(){this.activeBucket.failure+=1}switchBuckets(){this.inactiveBucket=this.activeBucket,this.activeBucket=w()}getLastSuccesses(){return this.inactiveBucket.success}getLastFailures(){return this.inactiveBucket.failure}}class k{constructor(e,t){this.wrappedPicker=e,this.countCalls=t}pick(e){let t=this.wrappedPicker.pick(e);if(t.pickResultType!==u.PickResultType.COMPLETE)return t;{let e=t.subchannel,r=e.getMapEntry();if(!r)return Object.assign(Object.assign({},t),{subchannel:e.getWrappedSubchannel()});{let i=t.onCallEnded;return this.countCalls&&(i=e=>{var i;e===s.Status.OK?r.counter.addSuccess():r.counter.addFailure(),null==(i=t.onCallEnded)||i.call(t,e)}),Object.assign(Object.assign({},t),{subchannel:e.getWrappedSubchannel(),onCallEnded:i})}}}}class A{constructor(e){this.addressMap=new Map,this.latestConfig=null,this.timerStartTime=null,this.childBalancer=new c.ChildLoadBalancerHandler((0,o.createChildChannelControlHelper)(e,{createSubchannel:(t,r)=>{let i=e.createSubchannel(t,r),n=this.addressMap.get((0,h.subchannelAddressToString)(t)),s=new _(i,n);return(null==n?void 0:n.currentEjectionTimestamp)!==null&&s.eject(),null==n||n.subchannelWrappers.push(s),s},updateState:(t,r)=>{t===n.ConnectivityState.READY?e.updateState(t,new k(r,this.isCountingEnabled())):e.updateState(t,r)}})),this.ejectionTimer=setInterval(()=>{},0),clearInterval(this.ejectionTimer)}isCountingEnabled(){return null!==this.latestConfig&&(null!==this.latestConfig.getSuccessRateEjectionConfig()||null!==this.latestConfig.getFailurePercentageEjectionConfig())}getCurrentEjectionPercent(){let e=0;for(let t of this.addressMap.values())null!==t.currentEjectionTimestamp&&(e+=1);return 100*e/this.addressMap.size}runSuccessRateCheck(e){if(!this.latestConfig)return;let t=this.latestConfig.getSuccessRateEjectionConfig();if(!t)return;m("Running success rate check");let r=t.request_volume,i=0,n=[];for(let[e,t]of this.addressMap){let s=t.counter.getLastSuccesses(),a=t.counter.getLastFailures();m("Stats for "+e+": successes="+s+" failures="+a+" targetRequestVolume="+r),s+a>=r&&(i+=1,n.push(s/(s+a)))}if(m("Found "+i+" success rate candidates; currentEjectionPercent="+this.getCurrentEjectionPercent()+" successRates=["+n+"]"),i<t.minimum_hosts)return;let s=n.reduce((e,t)=>e+t)/n.length,a=0;for(let e of n){let t=e-s;a+=t*t}let o=Math.sqrt(a/n.length),l=s-o*(t.stdev_factor/1e3);for(let[i,n]of(m("stdev="+o+" ejectionThreshold="+l),this.addressMap.entries())){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let s=n.counter.getLastSuccesses(),a=n.counter.getLastFailures();if(s+a<r)continue;let o=s/(s+a);if(m("Checking candidate "+i+" successRate="+o),o<l){let r=100*Math.random();m("Candidate "+i+" randomNumber="+r+" enforcement_percentage="+t.enforcement_percentage),r<t.enforcement_percentage&&(m("Ejecting candidate "+i),this.eject(n,e))}}}runFailurePercentageCheck(e){if(!this.latestConfig)return;let t=this.latestConfig.getFailurePercentageEjectionConfig();if(!t)return;m("Running failure percentage check. threshold="+t.threshold+" request volume threshold="+t.request_volume);let r=0;for(let e of this.addressMap.values())e.counter.getLastSuccesses()+e.counter.getLastFailures()>=t.request_volume&&(r+=1);if(!(r<t.minimum_hosts))for(let[r,i]of this.addressMap.entries()){if(this.getCurrentEjectionPercent()>=this.latestConfig.getMaxEjectionPercent())break;let n=i.counter.getLastSuccesses(),s=i.counter.getLastFailures();if((m("Candidate successes="+n+" failures="+s),!(n+s<t.request_volume))&&100*s/(s+n)>t.threshold){let n=100*Math.random();m("Candidate "+r+" randomNumber="+n+" enforcement_percentage="+t.enforcement_percentage),n<t.enforcement_percentage&&(m("Ejecting candidate "+r),this.eject(i,e))}}}eject(e,t){for(let t of(e.currentEjectionTimestamp=new Date,e.ejectionTimeMultiplier+=1,e.subchannelWrappers))t.eject()}uneject(e){for(let t of(e.currentEjectionTimestamp=null,e.subchannelWrappers))t.uneject()}switchAllBuckets(){for(let e of this.addressMap.values())e.counter.switchBuckets()}startTimer(e){var t,r;this.ejectionTimer=setTimeout(()=>this.runChecks(),e),null==(r=(t=this.ejectionTimer).unref)||r.call(t)}runChecks(){let e=new Date;if(m("Ejection timer running"),this.switchAllBuckets(),this.latestConfig)for(let[t,r]of(this.timerStartTime=e,this.startTimer(this.latestConfig.getIntervalMs()),this.runSuccessRateCheck(e),this.runFailurePercentageCheck(e),this.addressMap.entries()))if(null===r.currentEjectionTimestamp)r.ejectionTimeMultiplier>0&&(r.ejectionTimeMultiplier-=1);else{let e=this.latestConfig.getBaseEjectionTimeMs(),i=this.latestConfig.getMaxEjectionTimeMs(),n=new Date(r.currentEjectionTimestamp.getTime());n.setMilliseconds(n.getMilliseconds()+Math.min(e*r.ejectionTimeMultiplier,Math.max(e,i))),n<new Date&&(m("Unejecting "+t),this.uneject(r))}}updateAddressList(e,t,r){if(!(t instanceof E))return;let i=new Set;for(let t of e)i.add((0,h.subchannelAddressToString)(t));for(let e of i)this.addressMap.has(e)||(m("Adding map entry for "+e),this.addressMap.set(e,{counter:new R,currentEjectionTimestamp:null,ejectionTimeMultiplier:0,subchannelWrappers:[]}));for(let e of this.addressMap.keys())i.has(e)||(m("Removing map entry for "+e),this.addressMap.delete(e));let n=(0,l.getFirstUsableConfig)(t.getChildPolicy(),!0);if(this.childBalancer.updateAddressList(e,n,r),t.getSuccessRateEjectionConfig()||t.getFailurePercentageEjectionConfig())if(this.timerStartTime){m("Previous timer existed. Replacing timer"),clearTimeout(this.ejectionTimer);let e=t.getIntervalMs()-(new Date().getTime()-this.timerStartTime.getTime());this.startTimer(e)}else m("Starting new timer"),this.timerStartTime=new Date,this.startTimer(t.getIntervalMs()),this.switchAllBuckets();else for(let e of(m("Counting disabled. Cancelling timer."),this.timerStartTime=null,clearTimeout(this.ejectionTimer),this.addressMap.values()))this.uneject(e),e.ejectionTimeMultiplier=0;this.latestConfig=t}exitIdle(){this.childBalancer.exitIdle()}resetBackoff(){this.childBalancer.resetBackoff()}destroy(){clearTimeout(this.ejectionTimer),this.childBalancer.destroy()}getTypeName(){return g}}r.OutlierDetectionLoadBalancer=A,r.setup=function(){y&&(0,o.registerLoadBalancerType)(g,A,E)}},49549,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.OutlierDetectionLoadBalancingConfig=r.BaseSubchannelWrapper=r.registerAdminService=r.FilterStackFactory=r.BaseFilter=r.PickResultType=r.QueuePicker=r.UnavailablePicker=r.ChildLoadBalancerHandler=r.subchannelAddressToString=r.validateLoadBalancingConfig=r.getFirstUsableConfig=r.registerLoadBalancerType=r.createChildChannelControlHelper=r.BackoffTimeout=r.durationToMs=r.uriToString=r.createResolver=r.registerResolver=r.log=r.trace=void 0;var i=e.r(33137);Object.defineProperty(r,"trace",{enumerable:!0,get:function(){return i.trace}}),Object.defineProperty(r,"log",{enumerable:!0,get:function(){return i.log}});var n=e.r(54718);Object.defineProperty(r,"registerResolver",{enumerable:!0,get:function(){return n.registerResolver}}),Object.defineProperty(r,"createResolver",{enumerable:!0,get:function(){return n.createResolver}});var s=e.r(177);Object.defineProperty(r,"uriToString",{enumerable:!0,get:function(){return s.uriToString}});var a=e.r(52703);Object.defineProperty(r,"durationToMs",{enumerable:!0,get:function(){return a.durationToMs}});var o=e.r(29319);Object.defineProperty(r,"BackoffTimeout",{enumerable:!0,get:function(){return o.BackoffTimeout}});var l=e.r(29068);Object.defineProperty(r,"createChildChannelControlHelper",{enumerable:!0,get:function(){return l.createChildChannelControlHelper}}),Object.defineProperty(r,"registerLoadBalancerType",{enumerable:!0,get:function(){return l.registerLoadBalancerType}}),Object.defineProperty(r,"getFirstUsableConfig",{enumerable:!0,get:function(){return l.getFirstUsableConfig}}),Object.defineProperty(r,"validateLoadBalancingConfig",{enumerable:!0,get:function(){return l.validateLoadBalancingConfig}});var c=e.r(76054);Object.defineProperty(r,"subchannelAddressToString",{enumerable:!0,get:function(){return c.subchannelAddressToString}});var u=e.r(52387);Object.defineProperty(r,"ChildLoadBalancerHandler",{enumerable:!0,get:function(){return u.ChildLoadBalancerHandler}});var h=e.r(32199);Object.defineProperty(r,"UnavailablePicker",{enumerable:!0,get:function(){return h.UnavailablePicker}}),Object.defineProperty(r,"QueuePicker",{enumerable:!0,get:function(){return h.QueuePicker}}),Object.defineProperty(r,"PickResultType",{enumerable:!0,get:function(){return h.PickResultType}});var d=e.r(43704);Object.defineProperty(r,"BaseFilter",{enumerable:!0,get:function(){return d.BaseFilter}});var f=e.r(60807);Object.defineProperty(r,"FilterStackFactory",{enumerable:!0,get:function(){return f.FilterStackFactory}});var p=e.r(15831);Object.defineProperty(r,"registerAdminService",{enumerable:!0,get:function(){return p.registerAdminService}});var m=e.r(22664);Object.defineProperty(r,"BaseSubchannelWrapper",{enumerable:!0,get:function(){return m.BaseSubchannelWrapper}});var g=e.r(53432);Object.defineProperty(r,"OutlierDetectionLoadBalancingConfig",{enumerable:!0,get:function(){return g.OutlierDetectionLoadBalancingConfig}})},96448,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.setup=void 0;let i=e.r(54718);class n{constructor(e,t,r){let i;this.listener=t,this.addresses=[],this.hasReturnedResult=!1,i=""===e.authority?"/"+e.path:e.path,this.addresses=[{path:i}]}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(this.listener.onSuccessfulResolution,this.addresses,null,null,null,{}))}destroy(){}static getDefaultAuthority(e){return"localhost"}}r.setup=function(){(0,i.registerResolver)("unix",n)}},93701,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.setup=void 0;let i=e.r(4446),n=e.r(7782),s=e.r(10409),a=e.r(54718),o=e.r(177),l=e.r(33137),c="ip_resolver";function u(e){l.trace(n.LogVerbosity.DEBUG,c,e)}let h="ipv4",d="ipv6",f=443;class p{constructor(e,t,r){var a;this.listener=t,this.addresses=[],this.error=null,this.hasReturnedResult=!1,u("Resolver constructed for target "+(0,o.uriToString)(e));const l=[];if(e.scheme!==h&&e.scheme!==d){this.error={code:n.Status.UNAVAILABLE,details:`Unrecognized scheme ${e.scheme} in IP resolver`,metadata:new s.Metadata};return}for(const t of e.path.split(",")){const r=(0,o.splitHostPort)(t);if(null===r||e.scheme===h&&!(0,i.isIPv4)(r.host)||e.scheme===d&&!(0,i.isIPv6)(r.host)){this.error={code:n.Status.UNAVAILABLE,details:`Failed to parse ${e.scheme} address ${t}`,metadata:new s.Metadata};return}l.push({host:r.host,port:null!=(a=r.port)?a:f})}this.addresses=l,u("Parsed "+e.scheme+" address list "+this.addresses)}updateResolution(){this.hasReturnedResult||(this.hasReturnedResult=!0,process.nextTick(()=>{this.error?this.listener.onError(this.error):this.listener.onSuccessfulResolution(this.addresses,null,null,null,{})}))}destroy(){this.hasReturnedResult=!1}static getDefaultAuthority(e){return e.path.split(",")[0]}}r.setup=function(){(0,a.registerResolver)(h,p),(0,a.registerResolver)(d,p)}},30567,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.setup=r.PickFirstLoadBalancer=r.shuffled=r.PickFirstLoadBalancingConfig=void 0;let i=e.r(29068),n=e.r(35967),s=e.r(32199),a=e.r(33137),o=e.r(7782),l="pick_first";function c(e){a.trace(o.LogVerbosity.DEBUG,l,e)}let u="pick_first",h=250;class d{constructor(e){this.shuffleAddressList=e}getLoadBalancerName(){return u}toJsonObject(){return{[u]:{shuffleAddressList:this.shuffleAddressList}}}getShuffleAddressList(){return this.shuffleAddressList}static createFromJson(e){if("shuffleAddressList"in e&&"boolean"!=typeof e.shuffleAddressList)throw Error("pick_first config field shuffleAddressList must be a boolean if provided");return new d(!0===e.shuffleAddressList)}}r.PickFirstLoadBalancingConfig=d;class f{constructor(e){this.subchannel=e}pick(e){return{pickResultType:s.PickResultType.COMPLETE,subchannel:this.subchannel,status:null,onCallStarted:null,onCallEnded:null}}}function p(e){let t=e.slice();for(let e=t.length-1;e>1;e--){let r=Math.floor(Math.random()*(e+1)),i=t[e];t[e]=t[r],t[r]=i}return t}r.shuffled=p;class m{constructor(e){this.channelControlHelper=e,this.children=[],this.currentState=n.ConnectivityState.IDLE,this.currentSubchannelIndex=0,this.currentPick=null,this.subchannelStateListener=(e,t,r,i,n)=>{this.onSubchannelStateUpdate(e,t,r,n)},this.triedAllSubchannels=!1,this.stickyTransientFailureMode=!1,this.requestedResolutionSinceLastUpdate=!1,this.lastError=null,this.latestAddressList=null,this.connectionDelayTimeout=setTimeout(()=>{},0),clearTimeout(this.connectionDelayTimeout)}allChildrenHaveReportedTF(){return this.children.every(e=>e.hasReportedTransientFailure)}calculateAndReportNewState(){this.currentPick?this.updateState(n.ConnectivityState.READY,new f(this.currentPick)):0===this.children.length?this.updateState(n.ConnectivityState.IDLE,new s.QueuePicker(this)):this.stickyTransientFailureMode?this.updateState(n.ConnectivityState.TRANSIENT_FAILURE,new s.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(n.ConnectivityState.CONNECTING,new s.QueuePicker(this))}requestReresolution(){this.requestedResolutionSinceLastUpdate=!0,this.channelControlHelper.requestReresolution()}maybeEnterStickyTransientFailureMode(){if(this.allChildrenHaveReportedTF()&&(this.requestedResolutionSinceLastUpdate||this.requestReresolution(),!this.stickyTransientFailureMode)){for(let{subchannel:e}of(this.stickyTransientFailureMode=!0,this.children))e.startConnecting();this.calculateAndReportNewState()}}removeCurrentPick(){if(null!==this.currentPick){let e=this.currentPick;this.currentPick=null,e.unref(),e.removeConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.removeChannelzChild(e.getChannelzRef())}}onSubchannelStateUpdate(e,t,r,i){var s;if(null==(s=this.currentPick)?void 0:s.realSubchannelEquals(e)){r!==n.ConnectivityState.READY&&(this.removeCurrentPick(),this.calculateAndReportNewState(),this.requestReresolution());return}for(let[t,s]of this.children.entries())if(e.realSubchannelEquals(s.subchannel)){r===n.ConnectivityState.READY&&this.pickSubchannel(s.subchannel),r===n.ConnectivityState.TRANSIENT_FAILURE&&(s.hasReportedTransientFailure=!0,i&&(this.lastError=i),this.maybeEnterStickyTransientFailureMode(),t===this.currentSubchannelIndex&&this.startNextSubchannelConnecting(t+1)),s.subchannel.startConnecting();return}}startNextSubchannelConnecting(e){if(clearTimeout(this.connectionDelayTimeout),!this.triedAllSubchannels){for(let[t,r]of this.children.entries())if(t>=e){let e=r.subchannel.getConnectivityState();if(e===n.ConnectivityState.IDLE||e===n.ConnectivityState.CONNECTING)return void this.startConnecting(t)}this.triedAllSubchannels=!0,this.maybeEnterStickyTransientFailureMode()}}startConnecting(e){var t,r;clearTimeout(this.connectionDelayTimeout),this.currentSubchannelIndex=e,this.children[e].subchannel.getConnectivityState()===n.ConnectivityState.IDLE&&(c("Start connecting to subchannel with address "+this.children[e].subchannel.getAddress()),process.nextTick(()=>{var t;null==(t=this.children[e])||t.subchannel.startConnecting()})),this.connectionDelayTimeout=null==(r=(t=setTimeout(()=>{this.startNextSubchannelConnecting(e+1)},h)).unref)?void 0:r.call(t)}pickSubchannel(e){this.currentPick&&e.realSubchannelEquals(this.currentPick)||(c("Pick subchannel with address "+e.getAddress()),this.stickyTransientFailureMode=!1,null!==this.currentPick&&(this.currentPick.unref(),this.channelControlHelper.removeChannelzChild(this.currentPick.getChannelzRef()),this.currentPick.removeConnectivityStateListener(this.subchannelStateListener)),this.currentPick=e,e.ref(),this.channelControlHelper.addChannelzChild(e.getChannelzRef()),this.resetSubchannelList(),clearTimeout(this.connectionDelayTimeout),this.calculateAndReportNewState())}updateState(e,t){c(n.ConnectivityState[this.currentState]+" -> "+n.ConnectivityState[e]),this.currentState=e,this.channelControlHelper.updateState(e,t)}resetSubchannelList(){for(let e of this.children)this.currentPick&&e.subchannel.realSubchannelEquals(this.currentPick)||e.subchannel.removeConnectivityStateListener(this.subchannelStateListener),e.subchannel.unref(),this.channelControlHelper.removeChannelzChild(e.subchannel.getChannelzRef());this.currentSubchannelIndex=0,this.children=[],this.triedAllSubchannels=!1,this.requestedResolutionSinceLastUpdate=!1}connectToAddressList(e){let t=e.map(e=>({subchannel:this.channelControlHelper.createSubchannel(e,{}),hasReportedTransientFailure:!1}));for(let{subchannel:e}of t)e.ref(),this.channelControlHelper.addChannelzChild(e.getChannelzRef());for(let{subchannel:e}of(this.resetSubchannelList(),this.children=t,this.children))if(e.addConnectivityStateListener(this.subchannelStateListener),e.getConnectivityState()===n.ConnectivityState.READY)return void this.pickSubchannel(e);for(let e of this.children)e.subchannel.getConnectivityState()===n.ConnectivityState.TRANSIENT_FAILURE&&(e.hasReportedTransientFailure=!0);this.startNextSubchannelConnecting(0),this.calculateAndReportNewState()}updateAddressList(e,t){t instanceof d&&(t.getShuffleAddressList()&&(e=p(e)),this.latestAddressList=e,this.connectToAddressList(e))}exitIdle(){this.currentState===n.ConnectivityState.IDLE&&this.latestAddressList&&this.connectToAddressList(this.latestAddressList)}resetBackoff(){}destroy(){this.resetSubchannelList(),this.removeCurrentPick()}getTypeName(){return u}}r.PickFirstLoadBalancer=m,r.setup=function(){(0,i.registerLoadBalancerType)(u,m,d),(0,i.registerDefaultLoadBalancerType)(u)}},87463,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.setup=r.RoundRobinLoadBalancer=void 0;let i=e.r(29068),n=e.r(35967),s=e.r(32199),a=e.r(76054),o=e.r(33137),l=e.r(7782),c="round_robin";function u(e){o.trace(l.LogVerbosity.DEBUG,c,e)}let h="round_robin";class d{getLoadBalancerName(){return h}constructor(){}toJsonObject(){return{[h]:{}}}static createFromJson(e){return new d}}class f{constructor(e,t=0){this.subchannelList=e,this.nextIndex=t}pick(e){let t=this.subchannelList[this.nextIndex];return this.nextIndex=(this.nextIndex+1)%this.subchannelList.length,{pickResultType:s.PickResultType.COMPLETE,subchannel:t,status:null,onCallStarted:null,onCallEnded:null}}peekNextSubchannel(){return this.subchannelList[this.nextIndex]}}class p{constructor(e){this.channelControlHelper=e,this.subchannels=[],this.currentState=n.ConnectivityState.IDLE,this.currentReadyPicker=null,this.lastError=null,this.subchannelStateListener=(e,t,r,i,s)=>{this.calculateAndUpdateState(),(r===n.ConnectivityState.TRANSIENT_FAILURE||r===n.ConnectivityState.IDLE)&&(s&&(this.lastError=s),this.channelControlHelper.requestReresolution(),e.startConnecting())}}countSubchannelsWithState(e){return this.subchannels.filter(t=>t.getConnectivityState()===e).length}calculateAndUpdateState(){if(this.countSubchannelsWithState(n.ConnectivityState.READY)>0){let e=this.subchannels.filter(e=>e.getConnectivityState()===n.ConnectivityState.READY),t=0;null!==this.currentReadyPicker&&(t=e.indexOf(this.currentReadyPicker.peekNextSubchannel()))<0&&(t=0),this.updateState(n.ConnectivityState.READY,new f(e,t))}else this.countSubchannelsWithState(n.ConnectivityState.CONNECTING)>0?this.updateState(n.ConnectivityState.CONNECTING,new s.QueuePicker(this)):this.countSubchannelsWithState(n.ConnectivityState.TRANSIENT_FAILURE)>0?this.updateState(n.ConnectivityState.TRANSIENT_FAILURE,new s.UnavailablePicker({details:`No connection established. Last error: ${this.lastError}`})):this.updateState(n.ConnectivityState.IDLE,new s.QueuePicker(this))}updateState(e,t){u(n.ConnectivityState[this.currentState]+" -> "+n.ConnectivityState[e]),e===n.ConnectivityState.READY?this.currentReadyPicker=t:this.currentReadyPicker=null,this.currentState=e,this.channelControlHelper.updateState(e,t)}resetSubchannelList(){for(let e of this.subchannels)e.removeConnectivityStateListener(this.subchannelStateListener),e.unref(),this.channelControlHelper.removeChannelzChild(e.getChannelzRef());this.subchannels=[]}updateAddressList(e,t){for(let t of(this.resetSubchannelList(),u("Connect to address list "+e.map(e=>(0,a.subchannelAddressToString)(e))),this.subchannels=e.map(e=>this.channelControlHelper.createSubchannel(e,{})),this.subchannels)){t.ref(),t.addConnectivityStateListener(this.subchannelStateListener),this.channelControlHelper.addChannelzChild(t.getChannelzRef());let e=t.getConnectivityState();(e===n.ConnectivityState.IDLE||e===n.ConnectivityState.TRANSIENT_FAILURE)&&t.startConnecting()}this.calculateAndUpdateState()}exitIdle(){for(let e of this.subchannels)e.startConnecting()}resetBackoff(){}destroy(){this.resetSubchannelList()}getTypeName(){return h}}r.RoundRobinLoadBalancer=p,r.setup=function(){(0,i.registerLoadBalancerType)(h,p,d)}},70320,(e,t,r)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),r.experimental=r.addAdminServicesToServer=r.getChannelzHandlers=r.getChannelzServiceDefinition=r.InterceptorConfigurationError=r.InterceptingCall=r.RequesterBuilder=r.ListenerBuilder=r.StatusBuilder=r.getClientChannel=r.ServerCredentials=r.Server=r.setLogVerbosity=r.setLogger=r.load=r.loadObject=r.CallCredentials=r.ChannelCredentials=r.waitForClientReady=r.closeClient=r.Channel=r.makeGenericClientConstructor=r.makeClientConstructor=r.loadPackageDefinition=r.Client=r.compressionAlgorithms=r.propagate=r.connectivityState=r.status=r.logVerbosity=r.Metadata=r.credentials=void 0;let i=e.r(30470);Object.defineProperty(r,"CallCredentials",{enumerable:!0,get:function(){return i.CallCredentials}});let n=e.r(12786);Object.defineProperty(r,"Channel",{enumerable:!0,get:function(){return n.ChannelImplementation}});let s=e.r(14873);Object.defineProperty(r,"compressionAlgorithms",{enumerable:!0,get:function(){return s.CompressionAlgorithms}});let a=e.r(35967);Object.defineProperty(r,"connectivityState",{enumerable:!0,get:function(){return a.ConnectivityState}});let o=e.r(11877);Object.defineProperty(r,"ChannelCredentials",{enumerable:!0,get:function(){return o.ChannelCredentials}});let l=e.r(88028);Object.defineProperty(r,"Client",{enumerable:!0,get:function(){return l.Client}});let c=e.r(7782);Object.defineProperty(r,"logVerbosity",{enumerable:!0,get:function(){return c.LogVerbosity}}),Object.defineProperty(r,"status",{enumerable:!0,get:function(){return c.Status}}),Object.defineProperty(r,"propagate",{enumerable:!0,get:function(){return c.Propagate}});let u=e.r(33137),h=e.r(33859);Object.defineProperty(r,"loadPackageDefinition",{enumerable:!0,get:function(){return h.loadPackageDefinition}}),Object.defineProperty(r,"makeClientConstructor",{enumerable:!0,get:function(){return h.makeClientConstructor}}),Object.defineProperty(r,"makeGenericClientConstructor",{enumerable:!0,get:function(){return h.makeClientConstructor}});let d=e.r(10409);Object.defineProperty(r,"Metadata",{enumerable:!0,get:function(){return d.Metadata}});let f=e.r(88324);Object.defineProperty(r,"Server",{enumerable:!0,get:function(){return f.Server}});let p=e.r(41727);Object.defineProperty(r,"ServerCredentials",{enumerable:!0,get:function(){return p.ServerCredentials}});let m=e.r(54489);Object.defineProperty(r,"StatusBuilder",{enumerable:!0,get:function(){return m.StatusBuilder}}),r.credentials={combineChannelCredentials:(e,...t)=>t.reduce((e,t)=>e.compose(t),e),combineCallCredentials:(e,...t)=>t.reduce((e,t)=>e.compose(t),e),createInsecure:o.ChannelCredentials.createInsecure,createSsl:o.ChannelCredentials.createSsl,createFromSecureContext:o.ChannelCredentials.createFromSecureContext,createFromMetadataGenerator:i.CallCredentials.createFromMetadataGenerator,createFromGoogleCredential:i.CallCredentials.createFromGoogleCredential,createEmpty:i.CallCredentials.createEmpty},r.closeClient=e=>e.close(),r.waitForClientReady=(e,t,r)=>e.waitForReady(t,r),r.loadObject=(e,t)=>{throw Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")},r.load=(e,t,r)=>{throw Error("Not available in this library. Use @grpc/proto-loader and loadPackageDefinition instead")},r.setLogger=e=>{u.setLogger(e)},r.setLogVerbosity=e=>{u.setLoggerVerbosity(e)},r.getClientChannel=e=>l.Client.prototype.getChannel.call(e);var g=e.r(53692);Object.defineProperty(r,"ListenerBuilder",{enumerable:!0,get:function(){return g.ListenerBuilder}}),Object.defineProperty(r,"RequesterBuilder",{enumerable:!0,get:function(){return g.RequesterBuilder}}),Object.defineProperty(r,"InterceptingCall",{enumerable:!0,get:function(){return g.InterceptingCall}}),Object.defineProperty(r,"InterceptorConfigurationError",{enumerable:!0,get:function(){return g.InterceptorConfigurationError}});var y=e.r(23023);Object.defineProperty(r,"getChannelzServiceDefinition",{enumerable:!0,get:function(){return y.getChannelzServiceDefinition}}),Object.defineProperty(r,"getChannelzHandlers",{enumerable:!0,get:function(){return y.getChannelzHandlers}});var v=e.r(15831);Object.defineProperty(r,"addAdminServicesToServer",{enumerable:!0,get:function(){return v.addAdminServicesToServer}}),r.experimental=e.r(49549);let b=e.r(27476),S=e.r(96448),C=e.r(93701),T=e.r(30567),E=e.r(87463),_=e.r(53432),w=e.r(23023);(()=>{b.setup(),S.setup(),C.setup(),T.setup(),E.setup(),_.setup(),w.setup()})()},27671,e=>{"use strict";let t,r;var i,n,s,a,o,l=e.i(75521),c=e.i(58059),u=e.i(34522),h=e.i(44773),d=e.i(84482),f=e.i(9744),p=e.i(56907),m=e.i(15853),g=e.i(34950),y=e.i(36084),v=e.i(5237),b=e.i(6834),S=e.i(8282),C=e.i(16897),T=e.i(15081),E=e.i(34387),_=e.i(93695);e.i(55182);var w=e.i(38082),R=e.i(54750);let k=()=>void 0,A={NODE_CLIENT:!1},I=function(e){let t=[],r=0;for(let i=0;i<e.length;i++){let n=e.charCodeAt(i);n<128?t[r++]=n:(n<2048?t[r++]=n>>6|192:((64512&n)==55296&&i+1<e.length&&(64512&e.charCodeAt(i+1))==56320?(n=65536+((1023&n)<<10)+(1023&e.charCodeAt(++i)),t[r++]=n>>18|240,t[r++]=n>>12&63|128):t[r++]=n>>12|224,t[r++]=n>>6&63|128),t[r++]=63&n|128)}return t},O=function(e){let t=[],r=0,i=0;for(;r<e.length;){let n=e[r++];if(n<128)t[i++]=String.fromCharCode(n);else if(n>191&&n<224){let s=e[r++];t[i++]=String.fromCharCode((31&n)<<6|63&s)}else if(n>239&&n<365){let s=((7&n)<<18|(63&e[r++])<<12|(63&e[r++])<<6|63&e[r++])-65536;t[i++]=String.fromCharCode(55296+(s>>10)),t[i++]=String.fromCharCode(56320+(1023&s))}else{let s=e[r++],a=e[r++];t[i++]=String.fromCharCode((15&n)<<12|(63&s)<<6|63&a)}}return t.join("")},N={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();let r=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,i=[];for(let t=0;t<e.length;t+=3){let n=e[t],s=t+1<e.length,a=s?e[t+1]:0,o=t+2<e.length,l=o?e[t+2]:0,c=n>>2,u=(3&n)<<4|a>>4,h=(15&a)<<2|l>>6,d=63&l;!o&&(d=64,s||(h=64)),i.push(r[c],r[u],r[h],r[d])}return i.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(I(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):O(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();let r=t?this.charToByteMapWebSafe_:this.charToByteMap_,i=[];for(let t=0;t<e.length;){let n=r[e.charAt(t++)],s=t<e.length?r[e.charAt(t)]:0,a=++t<e.length?r[e.charAt(t)]:64,o=++t<e.length?r[e.charAt(t)]:64;if(++t,null==n||null==s||null==a||null==o)throw new x;let l=n<<2|s>>4;if(i.push(l),64!==a){let e=s<<4&240|a>>2;if(i.push(e),64!==o){let e=a<<6&192|o;i.push(e)}}}return i},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class x extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}let D=function(e){let t=I(e);return N.encodeByteArray(t,!0)},P=function(e){return D(e).replace(/\./g,"")},M=function(e){try{return N.decodeString(e,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function L(){return"undefined"!=typeof self?self:e.g}let F=()=>L().__FIREBASE_DEFAULTS__,B=()=>{if("undefined"==typeof process||void 0===process.env)return;let e=process.env.__FIREBASE_DEFAULTS__;if(e)return JSON.parse(e)},j=()=>{let e;if("undefined"==typeof document)return;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(e){return}let t=e&&M(e[1]);return t&&JSON.parse(t)},U=()=>{try{return k()||F()||B()||j()}catch(e){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`);return}},V=e=>U()?.emulatorHosts?.[e],z=e=>{let t=V(e);if(!t)return;let r=t.lastIndexOf(":");if(r<=0||r+1===t.length)throw Error(`Invalid host ${t} with no separate hostname and port!`);let i=parseInt(t.substring(r+1),10);return"["===t[0]?[t.substring(1,r-1),i]:[t.substring(0,r),i]},q=()=>U()?.config;class ${constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}wrapCallback(e){return(t,r)=>{t?this.reject(t):this.resolve(r),"function"==typeof e&&(this.promise.catch(()=>{}),1===e.length?e(t):e(t,r))}}}function H(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch{return!1}}async function W(e){return(await fetch(e,{credentials:"include"})).ok}function G(e,t){if(e.uid)throw Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');let r={alg:"none",type:"JWT"},i=t||"demo-project",n=e.iat||0,s=e.sub||e.user_id;if(!s)throw Error("mockUserToken must contain 'sub' or 'user_id' field!");let a={iss:`https://securetoken.google.com/${i}`,aud:i,iat:n,exp:n+3600,auth_time:n,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}},...e},o="";return[P(JSON.stringify(r)),P(JSON.stringify(a)),o].join(".")}function Q(e,t){}function K(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function J(){let t=U()?.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(e.g.process)}catch(e){return!1}}function Y(){return X()}function X(){return"undefined"!=typeof WorkerGlobalScope&&"undefined"!=typeof self&&self instanceof WorkerGlobalScope}function Z(){return!J()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function ee(){try{return"object"==typeof indexedDB}catch(e){return!1}}function et(){return new Promise((e,t)=>{try{let r=!0,i="validate-browser-context-for-indexeddb-analytics-module",n=self.indexedDB.open(i);n.onsuccess=()=>{n.result.close(),r||self.indexedDB.deleteDatabase(i),e(!0)},n.onupgradeneeded=()=>{r=!1},n.onerror=()=>{t(n.error?.message||"")}}catch(e){t(e)}})}let er="FirebaseError";class ei extends Error{constructor(e,t,r){super(t),this.code=e,this.customData=r,this.name=er,Object.setPrototypeOf(this,ei.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,en.prototype.create)}}class en{constructor(e,t,r){this.service=e,this.serviceName=t,this.errors=r}create(e,...t){let r=t[0]||{},i=`${this.service}/${e}`,n=this.errors[e],s=n?es(n,r):"Error",a=`${this.serviceName}: ${s} (${i}).`;return new ei(i,a,r)}}function es(e,t){return e.replace(ea,(e,r)=>{let i=t[r];return null!=i?String(i):`<${r}?>`})}let ea=/\{\$([^}]+)}/g;function eo(e,t){if(e===t)return!0;let r=Object.keys(e),i=Object.keys(t);for(let n of r){if(!i.includes(n))return!1;let r=e[n],s=t[n];if(el(r)&&el(s)){if(!eo(r,s))return!1}else if(r!==s)return!1}for(let e of i)if(!r.includes(e))return!1;return!0}function el(e){return null!==e&&"object"==typeof e}function ec(e){return e&&e._delegate?e._delegate:e}A.NODE_CLIENT=!0;class eu{constructor(e,t,r){this.name=e,this.instanceFactory=t,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}let eh="[DEFAULT]";class ed{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){let t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){let e=new $;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{let r=this.getOrInitializeService({instanceIdentifier:t});r&&e.resolve(r)}catch(e){}}return this.instancesDeferred.get(t).promise}getImmediate(e){let t=this.normalizeInstanceIdentifier(e?.identifier),r=e?.optional??!1;if(this.isInitialized(t)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:t})}catch(e){if(r)return null;throw e}if(r)return null;throw Error(`Service ${this.name} is not available`)}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(ep(e))try{this.getOrInitializeService({instanceIdentifier:eh})}catch(e){}for(let[e,t]of this.instancesDeferred.entries()){let r=this.normalizeInstanceIdentifier(e);try{let e=this.getOrInitializeService({instanceIdentifier:r});t.resolve(e)}catch(e){}}}}clearInstance(e=eh){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){let e=Array.from(this.instances.values());await Promise.all([...e.filter(e=>"INTERNAL"in e).map(e=>e.INTERNAL.delete()),...e.filter(e=>"_delete"in e).map(e=>e._delete())])}isComponentSet(){return null!=this.component}isInitialized(e=eh){return this.instances.has(e)}getOptions(e=eh){return this.instancesOptions.get(e)||{}}initialize(e={}){let{options:t={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);let i=this.getOrInitializeService({instanceIdentifier:r,options:t});for(let[e,t]of this.instancesDeferred.entries())r===this.normalizeInstanceIdentifier(e)&&t.resolve(i);return i}onInit(e,t){let r=this.normalizeInstanceIdentifier(t),i=this.onInitCallbacks.get(r)??new Set;i.add(e),this.onInitCallbacks.set(r,i);let n=this.instances.get(r);return n&&e(n,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){let r=this.onInitCallbacks.get(t);if(r)for(let i of r)try{i(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:ef(e),options:t}),this.instances.set(e,r),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=eh){return this.component?this.component.multipleInstances?e:eh:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}function ef(e){return e===eh?void 0:e}function ep(e){return"EAGER"===e.instantiationMode}class em{constructor(e){this.name=e,this.providers=new Map}addComponent(e){let t=this.getProvider(e.name);if(t.isComponentSet())throw Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);let t=new ed(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}let eg=[];!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(i||(i={}));let ey={debug:i.DEBUG,verbose:i.VERBOSE,info:i.INFO,warn:i.WARN,error:i.ERROR,silent:i.SILENT},ev=i.INFO,eb={[i.DEBUG]:"log",[i.VERBOSE]:"log",[i.INFO]:"info",[i.WARN]:"warn",[i.ERROR]:"error"},eS=(e,t,...r)=>{if(t<e.logLevel)return;let i=new Date().toISOString(),n=eb[t];if(n)console[n](`[${i}]  ${e.name}:`,...r);else throw Error(`Attempted to log a message with an invalid logType (value: ${t})`)};class eC{constructor(e){this.name=e,this._logLevel=ev,this._logHandler=eS,this._userLogHandler=null,eg.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in i))throw TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"==typeof e?ey[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!=typeof e)throw TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,i.DEBUG,...e),this._logHandler(this,i.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,i.VERBOSE,...e),this._logHandler(this,i.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,i.INFO,...e),this._logHandler(this,i.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,i.WARN,...e),this._logHandler(this,i.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,i.ERROR,...e),this._logHandler(this,i.ERROR,...e)}}function eT(e){eg.forEach(t=>{t.setLogLevel(e)})}function eE(e,t){for(let r of eg){let n=null;t&&t.level&&(n=ey[t.level]),null===e?r.userLogHandler=null:r.userLogHandler=(t,r,...s)=>{let a=s.map(e=>{if(null==e)return null;if("string"==typeof e)return e;if("number"==typeof e||"boolean"==typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(e){return null}}).filter(e=>e).join(" ");r>=(n??t.logLevel)&&e({level:i[r].toLowerCase(),message:a,args:s,type:t.name})}}}let e_=(e,t)=>t.some(t=>e instanceof t);function ew(){return t||(t=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function eR(){return r||(r=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}let ek=new WeakMap,eA=new WeakMap,eI=new WeakMap,eO=new WeakMap,eN=new WeakMap;function ex(e){let t=new Promise((t,r)=>{let i=()=>{e.removeEventListener("success",n),e.removeEventListener("error",s)},n=()=>{t(eB(e.result)),i()},s=()=>{r(e.error),i()};e.addEventListener("success",n),e.addEventListener("error",s)});return t.then(t=>{t instanceof IDBCursor&&ek.set(t,e)}).catch(()=>{}),eN.set(t,e),t}function eD(e){if(eA.has(e))return;let t=new Promise((t,r)=>{let i=()=>{e.removeEventListener("complete",n),e.removeEventListener("error",s),e.removeEventListener("abort",s)},n=()=>{t(),i()},s=()=>{r(e.error||new DOMException("AbortError","AbortError")),i()};e.addEventListener("complete",n),e.addEventListener("error",s),e.addEventListener("abort",s)});eA.set(e,t)}let eP={get(e,t,r){if(e instanceof IDBTransaction){if("done"===t)return eA.get(e);if("objectStoreNames"===t)return e.objectStoreNames||eI.get(e);if("store"===t)return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return eB(e[t])},set:(e,t,r)=>(e[t]=r,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function eM(e){eP=e(eP)}function eL(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?eR().includes(e)?function(...t){return e.apply(ej(this),t),eB(ek.get(this))}:function(...t){return eB(e.apply(ej(this),t))}:function(t,...r){let i=e.call(ej(this),t,...r);return eI.set(i,t.sort?t.sort():[t]),eB(i)}}function eF(e){return"function"==typeof e?eL(e):(e instanceof IDBTransaction&&eD(e),e_(e,ew()))?new Proxy(e,eP):e}function eB(e){if(e instanceof IDBRequest)return ex(e);if(eO.has(e))return eO.get(e);let t=eF(e);return t!==e&&(eO.set(e,t),eN.set(t,e)),t}let ej=e=>eN.get(e);function eU(e,t,{blocked:r,upgrade:i,blocking:n,terminated:s}={}){let a=indexedDB.open(e,t),o=eB(a);return i&&a.addEventListener("upgradeneeded",e=>{i(eB(a.result),e.oldVersion,e.newVersion,eB(a.transaction),e)}),r&&a.addEventListener("blocked",e=>r(e.oldVersion,e.newVersion,e)),o.then(e=>{s&&e.addEventListener("close",()=>s()),n&&e.addEventListener("versionchange",e=>n(e.oldVersion,e.newVersion,e))}).catch(()=>{}),o}let eV=["get","getKey","getAll","getAllKeys","count"],ez=["put","add","delete","clear"],eq=new Map;function e$(e,t){if(!(e instanceof IDBDatabase&&!(t in e)&&"string"==typeof t))return;if(eq.get(t))return eq.get(t);let r=t.replace(/FromIndex$/,""),i=t!==r,n=ez.includes(r);if(!(r in(i?IDBIndex:IDBObjectStore).prototype)||!(n||eV.includes(r)))return;let s=async function(e,...t){let s=this.transaction(e,n?"readwrite":"readonly"),a=s.store;return i&&(a=a.index(t.shift())),(await Promise.all([a[r](...t),n&&s.done]))[0]};return eq.set(t,s),s}eM(e=>({...e,get:(t,r,i)=>e$(t,r)||e.get(t,r,i),has:(t,r)=>!!e$(t,r)||e.has(t,r)}));class eH{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(e=>{if(!eW(e))return null;{let t=e.getImmediate();return`${t.library}/${t.version}`}}).filter(e=>e).join(" ")}}function eW(e){let t=e.getComponent();return t?.type==="VERSION"}let eG="@firebase/app",eQ="0.14.6",eK=new eC("@firebase/app"),eJ="12.6.0",eY="[DEFAULT]",eX={[eG]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/data-connect":"fire-data-connect","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","@firebase/ai":"fire-vertex","fire-js":"fire-js",firebase:"fire-js-all"},eZ=new Map,e0=new Map,e1=new Map;function e2(e,t){try{e.container.addComponent(t)}catch(r){eK.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,r)}}function e3(e,t){e.container.addOrOverwriteComponent(t)}function e6(e){let t=e.name;if(e1.has(t))return eK.debug(`There were multiple attempts to register component ${t}.`),!1;for(let r of(e1.set(t,e),eZ.values()))e2(r,e);for(let t of e0.values())e2(t,e);return!0}function e4(e,t){let r=e.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),e.container.getProvider(t)}function e5(e,t,r=eY){e4(e,t).clearInstance(r)}function e7(e){return void 0!==e.options}function e8(e){return!e7(e)&&("authIdToken"in e||"appCheckToken"in e||"releaseOnDeref"in e||"automaticDataCollectionEnabled"in e)}function e9(e){return null!=e&&void 0!==e.settings}function te(){e1.clear()}let tt=new en("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class tr{constructor(e,t,r){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new eu("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw tt.create("app-deleted",{appName:this._name})}}function ti(e,t){let r=M(e.split(".")[1]);null===r?console.error(`FirebaseServerApp ${t} is invalid: second part could not be parsed.`):void 0===JSON.parse(r).exp?console.error(`FirebaseServerApp ${t} is invalid: expiration claim could not be parsed`):1e3*JSON.parse(r).exp-new Date().getTime()<=0&&console.error(`FirebaseServerApp ${t} is invalid: the token has expired.`)}class tn extends tr{constructor(e,t,r,i){const n=void 0===t.automaticDataCollectionEnabled||t.automaticDataCollectionEnabled,s={name:r,automaticDataCollectionEnabled:n};void 0!==e.apiKey?super(e,s,i):super(e.options,s,i),this._serverConfig={automaticDataCollectionEnabled:n,...t},this._serverConfig.authIdToken&&ti(this._serverConfig.authIdToken,"authIdToken"),this._serverConfig.appCheckToken&&ti(this._serverConfig.appCheckToken,"appCheckToken"),this._finalizationRegistry=null,"undefined"!=typeof FinalizationRegistry&&(this._finalizationRegistry=new FinalizationRegistry(()=>{this.automaticCleanup()})),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,th(eG,eQ,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,void 0!==e&&null!==this._finalizationRegistry&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){tu(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw tt.create("server-app-deleted")}}let ts=eJ;function ta(e,t={}){let r=e;"object"!=typeof t&&(t={name:t});let i={name:eY,automaticDataCollectionEnabled:!0,...t},n=i.name;if("string"!=typeof n||!n)throw tt.create("bad-app-name",{appName:String(n)});if(r||(r=q()),!r)throw tt.create("no-options");let s=eZ.get(n);if(s)if(eo(r,s.options)&&eo(i,s.config))return s;else throw tt.create("duplicate-app",{appName:n});let a=new em(n);for(let e of e1.values())a.addComponent(e);let o=new tr(r,i,a);return eZ.set(n,o),o}function to(e,t={}){let r;if(Y()&&!X())throw tt.create("invalid-server-app-environment");let i=t||{};if(e&&(e7(e)?r=e.options:e8(e)?i=e:r=e),void 0===i.automaticDataCollectionEnabled&&(i.automaticDataCollectionEnabled=!0),r||(r=q()),!r)throw tt.create("no-options");let n={...i,...r};void 0!==n.releaseOnDeref&&delete n.releaseOnDeref;let s=e=>[...e].reduce((e,t)=>Math.imul(31,e)+t.charCodeAt(0)|0,0);if(void 0!==i.releaseOnDeref&&"undefined"==typeof FinalizationRegistry)throw tt.create("finalization-registry-not-supported",{});let a=""+s(JSON.stringify(n)),o=e0.get(a);if(o)return o.incRefCount(i.releaseOnDeref),o;let l=new em(a);for(let e of e1.values())l.addComponent(e);let c=new tn(r,i,a,l);return e0.set(a,c),c}function tl(e=eY){let t=eZ.get(e);if(!t&&e===eY&&q())return ta();if(!t)throw tt.create("no-app",{appName:e});return t}function tc(){return Array.from(eZ.values())}async function tu(e){let t=!1,r=e.name;eZ.has(r)?(t=!0,eZ.delete(r)):e0.has(r)&&0>=e.decRefCount()&&(e0.delete(r),t=!0),t&&(await Promise.all(e.container.getProviders().map(e=>e.delete())),e.isDeleted=!0)}function th(e,t,r){let i=eX[e]??e;r&&(i+=`-${r}`);let n=i.match(/\s|\//),s=t.match(/\s|\//);if(n||s){let e=[`Unable to register library "${i}" with version "${t}":`];n&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),n&&s&&e.push("and"),s&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),eK.warn(e.join(" "));return}e6(new eu(`${i}-version`,()=>({library:i,version:t}),"VERSION"))}function td(e,t){if(null!==e&&"function"!=typeof e)throw tt.create("invalid-log-argument");eE(e,t)}function tf(e){eT(e)}let tp="firebase-heartbeat-database",tm=1,tg="firebase-heartbeat-store",ty=null;function tv(){return ty||(ty=eU(tp,tm,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(tg)}catch(e){console.warn(e)}}}).catch(e=>{throw tt.create("idb-open",{originalErrorMessage:e.message})})),ty}async function tb(e){try{let t=(await tv()).transaction(tg),r=await t.objectStore(tg).get(tC(e));return await t.done,r}catch(e){if(e instanceof ei)eK.warn(e.message);else{let t=tt.create("idb-get",{originalErrorMessage:e?.message});eK.warn(t.message)}}}async function tS(e,t){try{let r=(await tv()).transaction(tg,"readwrite"),i=r.objectStore(tg);await i.put(t,tC(e)),await r.done}catch(e){if(e instanceof ei)eK.warn(e.message);else{let t=tt.create("idb-set",{originalErrorMessage:e?.message});eK.warn(t.message)}}}function tC(e){return`${e.name}!${e.options.appId}`}let tT=1024,tE=30;class t_{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new tk(t),this._heartbeatsCachePromise=this._storage.read().then(e=>(this._heartbeatsCache=e,e))}async triggerHeartbeat(){try{let e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),t=tw();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===t||this._heartbeatsCache.heartbeats.some(e=>e.date===t))return;if(this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats.length>tE){let e=tI(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){eK.warn(e)}}async getHeartbeatsHeader(){try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||0===this._heartbeatsCache.heartbeats.length)return"";let e=tw(),{heartbeatsToSend:t,unsentEntries:r}=tR(this._heartbeatsCache.heartbeats),i=P(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(e){return eK.warn(e),""}}}function tw(){return new Date().toISOString().substring(0,10)}function tR(e,t=tT){let r=[],i=e.slice();for(let n of e){let e=r.find(e=>e.agent===n.agent);if(e){if(e.dates.push(n.date),tA(r)>t){e.dates.pop();break}}else if(r.push({agent:n.agent,dates:[n.date]}),tA(r)>t){r.pop();break}i=i.slice(1)}return{heartbeatsToSend:r,unsentEntries:i}}class tk{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!ee()&&et().then(()=>!0).catch(()=>!1)}async read(){if(!await this._canUseIndexedDBPromise)return{heartbeats:[]};{let e=await tb(this.app);return e?.heartbeats?e:{heartbeats:[]}}}async overwrite(e){if(await this._canUseIndexedDBPromise){let t=await this.read();return tS(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??t.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){if(await this._canUseIndexedDBPromise){let t=await this.read();return tS(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??t.lastSentHeartbeatDate,heartbeats:[...t.heartbeats,...e.heartbeats]})}}}function tA(e){return P(JSON.stringify({version:2,heartbeats:e})).length}function tI(e){if(0===e.length)return -1;let t=0,r=e[0].date;for(let i=1;i<e.length;i++)e[i].date<r&&(r=e[i].date,t=i);return t}(function(e){e6(new eu("platform-logger",e=>new eH(e),"PRIVATE")),e6(new eu("heartbeat",e=>new t_(e),"PRIVATE")),th(eG,eQ,""),th(eG,eQ,"esm2020"),th("fire-js","")})(""),e.s(["SDK_VERSION",()=>ts,"_DEFAULT_ENTRY_NAME",()=>eY,"_addComponent",()=>e2,"_addOrOverwriteComponent",()=>e3,"_apps",()=>eZ,"_clearComponents",()=>te,"_components",()=>e1,"_getProvider",()=>e4,"_isFirebaseApp",()=>e7,"_isFirebaseServerApp",()=>e9,"_isFirebaseServerAppSettings",()=>e8,"_registerComponent",()=>e6,"_removeServiceInstance",()=>e5,"_serverApps",()=>e0,"deleteApp",()=>tu,"getApp",()=>tl,"getApps",()=>tc,"initializeApp",()=>ta,"initializeServerApp",()=>to,"onLog",()=>td,"registerVersion",()=>th,"setLogLevel",()=>tf],81476),th("firebase","12.6.0","app"),e.i(81476);var tO=e.i(24361),tN="undefined"!=typeof globalThis?globalThis:e.g,tx={};(function(){function e(){this.blockSize=-1,this.blockSize=64,this.g=[,,,,],this.C=Array(this.blockSize),this.o=this.h=0,this.u()}function t(e,t,r){r||(r=0);let i=Array(16);if("string"==typeof t)for(var n=0;n<16;++n)i[n]=t.charCodeAt(r++)|t.charCodeAt(r++)<<8|t.charCodeAt(r++)<<16|t.charCodeAt(r++)<<24;else for(n=0;n<16;++n)i[n]=t[r++]|t[r++]<<8|t[r++]<<16|t[r++]<<24;t=e.g[0],r=e.g[1],n=e.g[2];let s=e.g[3],a;a=t+(s^r&(n^s))+i[0]+0xd76aa478|0,a=s+(n^(t=r+(a<<7|a>>>25))&(r^n))+i[1]+0xe8c7b756|0,a=n+(r^(s=t+(a<<12|a>>>20))&(t^r))+i[2]+0x242070db|0,a=r+(t^(n=s+(a<<17|a>>>15))&(s^t))+i[3]+0xc1bdceee|0,a=t+(s^(r=n+(a<<22|a>>>10))&(n^s))+i[4]+0xf57c0faf|0,a=s+(n^(t=r+(a<<7|a>>>25))&(r^n))+i[5]+0x4787c62a|0,a=n+(r^(s=t+(a<<12|a>>>20))&(t^r))+i[6]+0xa8304613|0,a=r+(t^(n=s+(a<<17|a>>>15))&(s^t))+i[7]+0xfd469501|0,a=t+(s^(r=n+(a<<22|a>>>10))&(n^s))+i[8]+0x698098d8|0,a=s+(n^(t=r+(a<<7|a>>>25))&(r^n))+i[9]+0x8b44f7af|0,a=n+(r^(s=t+(a<<12|a>>>20))&(t^r))+i[10]+0xffff5bb1|0,a=r+(t^(n=s+(a<<17|a>>>15))&(s^t))+i[11]+0x895cd7be|0,a=t+(s^(r=n+(a<<22|a>>>10))&(n^s))+i[12]+0x6b901122|0,a=s+(n^(t=r+(a<<7|a>>>25))&(r^n))+i[13]+0xfd987193|0,a=n+(r^(s=t+(a<<12|a>>>20))&(t^r))+i[14]+0xa679438e|0,a=r+(t^(n=s+(a<<17|a>>>15))&(s^t))+i[15]+0x49b40821|0,r=n+(a<<22|a>>>10),a=t+(n^s&(r^n))+i[1]+0xf61e2562|0,t=r+(a<<5|a>>>27),a=s+(r^n&(t^r))+i[6]+0xc040b340|0,s=t+(a<<9|a>>>23),a=n+(t^r&(s^t))+i[11]+0x265e5a51|0,n=s+(a<<14|a>>>18),a=r+(s^t&(n^s))+i[0]+0xe9b6c7aa|0,r=n+(a<<20|a>>>12),a=t+(n^s&(r^n))+i[5]+0xd62f105d|0,t=r+(a<<5|a>>>27),a=s+(r^n&(t^r))+i[10]+0x2441453|0,s=t+(a<<9|a>>>23),a=n+(t^r&(s^t))+i[15]+0xd8a1e681|0,n=s+(a<<14|a>>>18),a=r+(s^t&(n^s))+i[4]+0xe7d3fbc8|0,r=n+(a<<20|a>>>12),a=t+(n^s&(r^n))+i[9]+0x21e1cde6|0,t=r+(a<<5|a>>>27),a=s+(r^n&(t^r))+i[14]+0xc33707d6|0,s=t+(a<<9|a>>>23),a=n+(t^r&(s^t))+i[3]+0xf4d50d87|0,n=s+(a<<14|a>>>18),a=r+(s^t&(n^s))+i[8]+0x455a14ed|0,r=n+(a<<20|a>>>12),a=t+(n^s&(r^n))+i[13]+0xa9e3e905|0,t=r+(a<<5|a>>>27),a=s+(r^n&(t^r))+i[2]+0xfcefa3f8|0,s=t+(a<<9|a>>>23),a=n+(t^r&(s^t))+i[7]+0x676f02d9|0,n=s+(a<<14|a>>>18),a=r+(s^t&(n^s))+i[12]+0x8d2a4c8a|0,a=t+((r=n+(a<<20|a>>>12))^n^s)+i[5]+0xfffa3942|0,a=s+((t=r+(a<<4|a>>>28))^r^n)+i[8]+0x8771f681|0,a=n+((s=t+(a<<11|a>>>21))^t^r)+i[11]+0x6d9d6122|0,a=r+((n=s+(a<<16|a>>>16))^s^t)+i[14]+0xfde5380c|0,a=t+((r=n+(a<<23|a>>>9))^n^s)+i[1]+0xa4beea44|0,a=s+((t=r+(a<<4|a>>>28))^r^n)+i[4]+0x4bdecfa9|0,a=n+((s=t+(a<<11|a>>>21))^t^r)+i[7]+0xf6bb4b60|0,a=r+((n=s+(a<<16|a>>>16))^s^t)+i[10]+0xbebfbc70|0,a=t+((r=n+(a<<23|a>>>9))^n^s)+i[13]+0x289b7ec6|0,a=s+((t=r+(a<<4|a>>>28))^r^n)+i[0]+0xeaa127fa|0,a=n+((s=t+(a<<11|a>>>21))^t^r)+i[3]+0xd4ef3085|0,a=r+((n=s+(a<<16|a>>>16))^s^t)+i[6]+0x4881d05|0,a=t+((r=n+(a<<23|a>>>9))^n^s)+i[9]+0xd9d4d039|0,a=s+((t=r+(a<<4|a>>>28))^r^n)+i[12]+0xe6db99e5|0,a=n+((s=t+(a<<11|a>>>21))^t^r)+i[15]+0x1fa27cf8|0,a=r+((n=s+(a<<16|a>>>16))^s^t)+i[2]+0xc4ac5665|0,r=n+(a<<23|a>>>9),a=t+(n^(r|~s))+i[0]+0xf4292244|0,t=r+(a<<6|a>>>26),a=s+(r^(t|~n))+i[7]+0x432aff97|0,s=t+(a<<10|a>>>22),a=n+(t^(s|~r))+i[14]+0xab9423a7|0,n=s+(a<<15|a>>>17),a=r+(s^(n|~t))+i[5]+0xfc93a039|0,r=n+(a<<21|a>>>11),a=t+(n^(r|~s))+i[12]+0x655b59c3|0,t=r+(a<<6|a>>>26),a=s+(r^(t|~n))+i[3]+0x8f0ccc92|0,s=t+(a<<10|a>>>22),a=n+(t^(s|~r))+i[10]+0xffeff47d|0,n=s+(a<<15|a>>>17),a=r+(s^(n|~t))+i[1]+0x85845dd1|0,r=n+(a<<21|a>>>11),a=t+(n^(r|~s))+i[8]+0x6fa87e4f|0,t=r+(a<<6|a>>>26),a=s+(r^(t|~n))+i[15]+0xfe2ce6e0|0,s=t+(a<<10|a>>>22),a=n+(t^(s|~r))+i[6]+0xa3014314|0,n=s+(a<<15|a>>>17),a=r+(s^(n|~t))+i[13]+0x4e0811a1|0,r=n+(a<<21|a>>>11),a=t+(n^(r|~s))+i[4]+0xf7537e82|0,t=r+(a<<6|a>>>26),a=s+(r^(t|~n))+i[11]+0xbd3af235|0,s=t+(a<<10|a>>>22),a=n+(t^(s|~r))+i[2]+0x2ad7d2bb|0,n=s+(a<<15|a>>>17),a=r+(s^(n|~t))+i[9]+0xeb86d391|0,e.g[0]=e.g[0]+t|0,e.g[1]=e.g[1]+(n+(a<<21|a>>>11))|0,e.g[2]=e.g[2]+n|0,e.g[3]=e.g[3]+s|0}function r(e,t){var r=o;return Object.prototype.hasOwnProperty.call(r,e)?r[e]:r[e]=t(e)}function i(e,t){this.h=t;let r=[],i=!0;for(let n=e.length-1;n>=0;n--){let s=0|e[n];i&&s==t||(r[n]=s,i=!1)}this.g=r}(function(e,t){function r(){}r.prototype=t.prototype,e.F=t.prototype,e.prototype=new r,e.prototype.constructor=e,e.D=function(e,r,i){for(var n=Array(arguments.length-2),s=2;s<arguments.length;s++)n[s-2]=arguments[s];return t.prototype[r].apply(e,n)}})(e,function(){this.blockSize=-1}),e.prototype.u=function(){this.g[0]=0x67452301,this.g[1]=0xefcdab89,this.g[2]=0x98badcfe,this.g[3]=0x10325476,this.o=this.h=0},e.prototype.v=function(e,r){void 0===r&&(r=e.length);let i=r-this.blockSize,n=this.C,s=this.h,a=0;for(;a<r;){if(0==s)for(;a<=i;)t(this,e,a),a+=this.blockSize;if("string"==typeof e){for(;a<r;)if(n[s++]=e.charCodeAt(a++),s==this.blockSize){t(this,n),s=0;break}}else for(;a<r;)if(n[s++]=e[a++],s==this.blockSize){t(this,n),s=0;break}}this.h=s,this.o+=r},e.prototype.A=function(){var e=Array((this.h<56?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;t=8*this.o;for(var r=e.length-8;r<e.length;++r)e[r]=255&t,t/=256;for(this.v(e),e=Array(16),t=0,r=0;r<4;++r)for(let i=0;i<32;i+=8)e[t++]=this.g[r]>>>i&255;return e};var a,o={};function l(e){return -128<=e&&e<128?r(e,function(e){return new i([0|e],e<0?-1:0)}):new i([0|e],e<0?-1:0)}function c(e){if(isNaN(e)||!isFinite(e))return h;if(e<0)return g(c(-e));let t=[],r=1;for(let i=0;e>=r;i++)t[i]=e/r|0,r*=0x100000000;return new i(t,0)}function u(e,t){if(0==e.length)throw Error("number format error: empty string");if((t=t||10)<2||36<t)throw Error("radix out of range: "+t);if("-"==e.charAt(0))return g(u(e.substring(1),t));if(e.indexOf("-")>=0)throw Error('number format error: interior "-" character');let r=c(Math.pow(t,8)),i=h;for(let s=0;s<e.length;s+=8){var n=Math.min(8,e.length-s);let a=parseInt(e.substring(s,s+n),t);n<8?(n=c(Math.pow(t,n)),i=i.j(n).add(c(a))):i=(i=i.j(r)).add(c(a))}return i}var h=l(0),d=l(1),f=l(0x1000000);function p(e){if(0!=e.h)return!1;for(let t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function m(e){return -1==e.h}function g(e){let t=e.g.length,r=[];for(let i=0;i<t;i++)r[i]=~e.g[i];return new i(r,~e.h).add(d)}function y(e,t){return e.add(g(t))}function v(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function b(e,t){this.g=e,this.h=t}function S(e,t){if(p(t))throw Error("division by zero");if(p(e))return new b(h,h);if(m(e))return t=S(g(e),t),new b(g(t.g),g(t.h));if(m(t))return t=S(e,g(t)),new b(g(t.g),t.h);if(e.g.length>30){if(m(e)||m(t))throw Error("slowDivide_ only works with positive integers.");for(var r=d,i=t;0>=i.l(e);)r=C(r),i=C(i);var n=T(r,1),s=T(i,1);for(i=T(i,2),r=T(r,2);!p(i);){var a=s.add(i);0>=a.l(e)&&(n=n.add(r),s=a),i=T(i,1),r=T(r,1)}return t=y(e,n.j(t)),new b(n,t)}for(n=h;e.l(t)>=0;){for(i=(i=Math.ceil(Math.log(r=Math.max(1,Math.floor(e.m()/t.m())))/Math.LN2))<=48?1:Math.pow(2,i-48),a=(s=c(r)).j(t);m(a)||a.l(e)>0;)r-=i,a=(s=c(r)).j(t);p(s)&&(s=d),n=n.add(s),e=y(e,a)}return new b(n,e)}function C(e){let t=e.g.length+1,r=[];for(let i=0;i<t;i++)r[i]=e.i(i)<<1|e.i(i-1)>>>31;return new i(r,e.h)}function T(e,t){let r=t>>5;t%=32;let n=e.g.length-r,s=[];for(let i=0;i<n;i++)s[i]=t>0?e.i(i+r)>>>t|e.i(i+r+1)<<32-t:e.i(i+r);return new i(s,e.h)}(a=i.prototype).m=function(){if(m(this))return-g(this).m();let e=0,t=1;for(let r=0;r<this.g.length;r++){let i=this.i(r);e+=(i>=0?i:0x100000000+i)*t,t*=0x100000000}return e},a.toString=function(e){if((e=e||10)<2||36<e)throw Error("radix out of range: "+e);if(p(this))return"0";if(m(this))return"-"+g(this).toString(e);let t=c(Math.pow(e,6));var r=this;let i="";for(;;){let n=S(r,t).g,s=(((r=y(r,n.j(t))).g.length>0?r.g[0]:r.h)>>>0).toString(e);if(p(r=n))return s+i;for(;s.length<6;)s="0"+s;i=s+i}},a.i=function(e){return e<0?0:e<this.g.length?this.g[e]:this.h},a.l=function(e){return m(e=y(this,e))?-1:+!p(e)},a.abs=function(){return m(this)?g(this):this},a.add=function(e){let t=Math.max(this.g.length,e.g.length),r=[],n=0;for(let i=0;i<=t;i++){let t=n+(65535&this.i(i))+(65535&e.i(i)),s=(t>>>16)+(this.i(i)>>>16)+(e.i(i)>>>16);n=s>>>16,t&=65535,s&=65535,r[i]=s<<16|t}return new i(r,-0x80000000&r[r.length-1]?-1:0)},a.j=function(e){if(p(this)||p(e))return h;if(m(this))return m(e)?g(this).j(g(e)):g(g(this).j(e));if(m(e))return g(this.j(g(e)));if(0>this.l(f)&&0>e.l(f))return c(this.m()*e.m());let t=this.g.length+e.g.length,r=[];for(var n=0;n<2*t;n++)r[n]=0;for(n=0;n<this.g.length;n++)for(let t=0;t<e.g.length;t++){let i=this.i(n)>>>16,s=65535&this.i(n),a=e.i(t)>>>16,o=65535&e.i(t);r[2*n+2*t]+=s*o,v(r,2*n+2*t),r[2*n+2*t+1]+=i*o,v(r,2*n+2*t+1),r[2*n+2*t+1]+=s*a,v(r,2*n+2*t+1),r[2*n+2*t+2]+=i*a,v(r,2*n+2*t+2)}for(e=0;e<t;e++)r[e]=r[2*e+1]<<16|r[2*e];for(e=t;e<2*t;e++)r[e]=0;return new i(r,0)},a.B=function(e){return S(this,e).h},a.and=function(e){let t=Math.max(this.g.length,e.g.length),r=[];for(let i=0;i<t;i++)r[i]=this.i(i)&e.i(i);return new i(r,this.h&e.h)},a.or=function(e){let t=Math.max(this.g.length,e.g.length),r=[];for(let i=0;i<t;i++)r[i]=this.i(i)|e.i(i);return new i(r,this.h|e.h)},a.xor=function(e){let t=Math.max(this.g.length,e.g.length),r=[];for(let i=0;i<t;i++)r[i]=this.i(i)^e.i(i);return new i(r,this.h^e.h)},e.prototype.digest=e.prototype.A,e.prototype.reset=e.prototype.u,e.prototype.update=e.prototype.v,s=tx.Md5=e,i.prototype.add=i.prototype.add,i.prototype.multiply=i.prototype.j,i.prototype.modulo=i.prototype.B,i.prototype.compare=i.prototype.l,i.prototype.toNumber=i.prototype.m,i.prototype.toString=i.prototype.toString,i.prototype.getBits=i.prototype.i,i.fromNumber=c,i.fromString=u,n=tx.Integer=i}).apply(void 0!==tN?tN:"undefined"!=typeof self?self:{});var tD=e.i(54799),tP=e.i(70320),tM=e.i(36458);let tL="@firebase/firestore",tF="4.9.2";class tB{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}tB.UNAUTHENTICATED=new tB(null),tB.GOOGLE_CREDENTIALS=new tB("google-credentials-uid"),tB.FIRST_PARTY=new tB("first-party-uid"),tB.MOCK_USER=new tB("mock-user");let tj="12.3.0";function tU(e){tj=e}function tV(e){return(0,tO.inspect)(e,{depth:100})}let tz=new eC("@firebase/firestore");function tq(){return tz.logLevel}function t$(e,...t){if(tz.logLevel<=i.DEBUG){let r=t.map(tG);tz.debug(`Firestore (${tj}): ${e}`,...r)}}function tH(e,...t){if(tz.logLevel<=i.ERROR){let r=t.map(tG);tz.error(`Firestore (${tj}): ${e}`,...r)}}function tW(e,...t){if(tz.logLevel<=i.WARN){let r=t.map(tG);tz.warn(`Firestore (${tj}): ${e}`,...r)}}function tG(e){if("string"==typeof e)return e;try{return tV(e)}catch(t){return e}}function tQ(e,t,r){let i="Unexpected state";"string"==typeof t?i=t:r=t,tK(e,i,r)}function tK(e,t,r){let i=`FIRESTORE (${tj}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(void 0!==r)try{let e=JSON.stringify(r);i+=" CONTEXT: "+e}catch(e){i+=" CONTEXT: "+r}throw tH(i),Error(i)}function tJ(e,t,r,i){let n="Unexpected state";"string"==typeof r?n=r:i=r,e||tK(t,n,i)}function tY(e,t){return e}let tX="ok",tZ="cancelled",t0="unknown",t1="invalid-argument",t2="deadline-exceeded",t3="not-found",t6="already-exists",t4="permission-denied",t5="unauthenticated",t7="resource-exhausted",t8="failed-precondition",t9="aborted",re="out-of-range",rt="unimplemented",rr="internal",ri="unavailable",rn="data-loss";class rs extends ei{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class ra{constructor(){this.promise=new Promise((e,t)=>{this.resolve=e,this.reject=t})}}class ro{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class rl{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable(()=>t(tB.UNAUTHENTICATED))}shutdown(){}}class rc{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable(()=>t(this.token.user))}shutdown(){this.changeListener=null}}class ru{constructor(e){this.authProvider=e,this.currentUser=tB.UNAUTHENTICATED,this.tokenCounter=0,this.forceRefresh=!1,this.auth=null}start(e,t){tJ(void 0===this.tokenListener,42304);let r=this.tokenCounter,i=e=>this.tokenCounter!==r?(r=this.tokenCounter,t(e)):Promise.resolve(),n=new ra;this.tokenListener=()=>{this.tokenCounter++,this.currentUser=this.getUser(),n.resolve(),n=new ra,e.enqueueRetryable(()=>i(this.currentUser))};let s=()=>{let t=n;e.enqueueRetryable(async()=>{await t.promise,await i(this.currentUser)})},a=e=>{t$("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.tokenListener&&(this.auth.addAuthTokenListener(this.tokenListener),s())};this.authProvider.onInit(e=>a(e)),setTimeout(()=>{if(!this.auth){let e=this.authProvider.getImmediate({optional:!0});e?a(e):(t$("FirebaseAuthCredentialsProvider","Auth not yet detected"),n.resolve(),n=new ra)}},0),s()}getToken(){let e=this.tokenCounter,t=this.forceRefresh;return(this.forceRefresh=!1,this.auth)?this.auth.getToken(t).then(t=>this.tokenCounter!==e?(t$("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(tJ("string"==typeof t.accessToken,31837,{tokenData:t}),new ro(t.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.tokenListener&&this.auth.removeAuthTokenListener(this.tokenListener),this.tokenListener=void 0}getUser(){let e=this.auth&&this.auth.getUid();return tJ(null===e||"string"==typeof e,2055,{currentUid:e}),new tB(e)}}class rh{constructor(e,t,r){this.sessionIndex=e,this.iamToken=t,this.authTokenFactory=r,this.type="FirstParty",this.user=tB.FIRST_PARTY,this._headers=new Map}getAuthToken(){return this.authTokenFactory?this.authTokenFactory():null}get headers(){this._headers.set("X-Goog-AuthUser",this.sessionIndex);let e=this.getAuthToken();return e&&this._headers.set("Authorization",e),this.iamToken&&this._headers.set("X-Goog-Iam-Authorization-Token",this.iamToken),this._headers}}class rd{constructor(e,t,r){this.sessionIndex=e,this.iamToken=t,this.authTokenFactory=r}getToken(){return Promise.resolve(new rh(this.sessionIndex,this.iamToken,this.authTokenFactory))}start(e,t){e.enqueueRetryable(()=>t(tB.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class rf{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class rp{constructor(e,t){this.appCheckProvider=t,this.forceRefresh=!1,this.appCheck=null,this.latestAppCheckToken=null,this.serverAppAppCheckToken=null,e9(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken)}start(e,t){tJ(void 0===this.tokenListener,3512);let r=e=>{null!=e.error&&t$("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);let r=e.token!==this.latestAppCheckToken;return this.latestAppCheckToken=e.token,t$("FirebaseAppCheckTokenProvider",`Received ${r?"new":"existing"} token.`),r?t(e.token):Promise.resolve()};this.tokenListener=t=>{e.enqueueRetryable(()=>r(t))};let i=e=>{t$("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.tokenListener&&this.appCheck.addTokenListener(this.tokenListener)};this.appCheckProvider.onInit(e=>i(e)),setTimeout(()=>{if(!this.appCheck){let e=this.appCheckProvider.getImmediate({optional:!0});e?i(e):t$("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.serverAppAppCheckToken)return Promise.resolve(new rf(this.serverAppAppCheckToken));let e=this.forceRefresh;return(this.forceRefresh=!1,this.appCheck)?this.appCheck.getToken(e).then(e=>e?(tJ("string"==typeof e.token,44558,{tokenResult:e}),this.latestAppCheckToken=e.token,new rf(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.tokenListener&&this.appCheck.removeTokenListener(this.tokenListener),this.tokenListener=void 0}}function rm(e){if(!e)return new rl;switch(e.type){case"firstParty":return new rd(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new rs(t1,"makeAuthCredentialsProvider failed due to invalid credential type")}}function rg(e){return(0,tD.randomBytes)(e)}class ry{static newId(){let e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=Math.floor(256/e.length)*e.length,r="",i=20;for(;r.length<i;){let n=rg(40);for(let s=0;s<n.length;++s)r.length<i&&n[s]<t&&(r+=e.charAt(n[s]%e.length))}return r}}function rv(e,t){return e<t?-1:+(e>t)}function rb(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let r=e.charAt(i),n=t.charAt(i);if(r!==n)return rT(r)===rT(n)?rv(r,n):rT(r)?1:-1}return rv(e.length,t.length)}let rS=55296,rC=57343;function rT(e){let t=e.charCodeAt(0);return t>=rS&&t<=rC}function rE(e,t,r){return e.length===t.length&&e.every((e,i)=>r(e,t[i]))}let r_="__name__";class rw{constructor(e,t,r){void 0===t?t=0:t>e.length&&tQ(637,{offset:t,range:e.length}),void 0===r?r=e.length-t:r>e.length-t&&tQ(1746,{length:r,range:e.length-t}),this.segments=e,this.offset=t,this.len=r}get length(){return this.len}isEqual(e){return 0===rw.comparator(this,e)}child(e){let t=this.segments.slice(this.offset,this.limit());return e instanceof rw?e.forEach(e=>{t.push(e)}):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,r=this.limit();t<r;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){let r=Math.min(e.length,t.length);for(let i=0;i<r;i++){let r=rw.compareSegments(e.get(i),t.get(i));if(0!==r)return r}return rv(e.length,t.length)}static compareSegments(e,t){let r=rw.isNumericId(e),i=rw.isNumericId(t);return r&&!i?-1:!r&&i?1:r&&i?rw.extractNumericId(e).compare(rw.extractNumericId(t)):rb(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return n.fromString(e.substring(4,e.length-2))}}class rR extends rw{construct(e,t,r){return new rR(e,t,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){let t=[];for(let r of e){if(r.indexOf("//")>=0)throw new rs(t1,`Invalid segment (${r}). Paths must not contain // in them.`);t.push(...r.split("/").filter(e=>e.length>0))}return new rR(t)}static emptyPath(){return new rR([])}}let rk=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class rA extends rw{construct(e,t,r){return new rA(e,t,r)}static isValidIdentifier(e){return rk.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),rA.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===r_}static keyField(){return new rA([r_])}static fromServerFormat(e){let t=[],r="",i=0,n=()=>{if(0===r.length)throw new rs(t1,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(r),r=""},s=!1;for(;i<e.length;){let t=e[i];if("\\"===t){if(i+1===e.length)throw new rs(t1,"Path has trailing escape character: "+e);let t=e[i+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new rs(t1,"Path has invalid escape sequence: "+e);r+=t,i+=2}else"`"===t?s=!s:"."!==t||s?r+=t:n(),i++}if(n(),s)throw new rs(t1,"Unterminated ` in path: "+e);return new rA(t)}static emptyPath(){return new rA([])}}class rI{constructor(e){this.path=e}static fromPath(e){return new rI(rR.fromString(e))}static fromName(e){return new rI(rR.fromString(e).popFirst(5))}static empty(){return new rI(rR.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===rR.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return rR.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new rI(new rR(e.slice()))}}function rO(e,t,r){if(!r)throw new rs(t1,`Function ${e}() cannot be called with an empty ${t}.`)}function rN(e,t,r,i){if(!0===t&&!0===i)throw new rs(t1,`${e} and ${r} cannot be used together.`)}function rx(e){if(!rI.isDocumentKey(e))throw new rs(t1,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function rD(e){if(rI.isDocumentKey(e))throw new rs(t1,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function rP(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function rM(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e)if(e instanceof Array)return"an array";else{let t=rL(e);return t?`a custom ${t} object`:"an object"}else if("function"==typeof e)return"a function";else return tQ(12329,{type:typeof e})}function rL(e){return e.constructor?e.constructor.name:null}function rF(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t))if(t.name===e.constructor.name)throw new rs(t1,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");else{let r=rM(e);throw new rs(t1,`Expected type '${t.name}', but it was: ${r}`)}return e}function rB(e,t){let r={typeString:e};return t&&(r.value=t),r}function rj(e,t){let r;if(!rP(e))throw new rs(t1,"JSON must be an object");for(let i in t)if(t[i]){let n=t[i].typeString,s="value"in t[i]?{value:t[i].value}:void 0;if(!(i in e)){r=`JSON missing required field: '${i}'`;break}let a=e[i];if(n&&typeof a!==n){r=`JSON field '${i}' must be a ${n}.`;break}if(void 0!==s&&a!==s.value){r=`Expected '${i}' field to equal '${s.value}'`;break}}if(r)throw new rs(t1,r);return!0}let rU=-0xe7791f700,rV=1e6;class rz{static now(){return rz.fromMillis(Date.now())}static fromDate(e){return rz.fromMillis(e.getTime())}static fromMillis(e){let t=Math.floor(e/1e3),r=Math.floor((e-1e3*t)*rV);return new rz(t,r)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0||t>=1e9)throw new rs(t1,"Timestamp nanoseconds out of range: "+t);if(e<rU||e>=0x3afff44180)throw new rs(t1,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/rV}_compareTo(e){return this.seconds===e.seconds?rv(this.nanoseconds,e.nanoseconds):rv(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:rz._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(rj(e,rz._jsonSchema))return new rz(e.seconds,e.nanoseconds)}valueOf(){return String(this.seconds-rU).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}rz._jsonSchemaVersion="firestore/timestamp/1.0",rz._jsonSchema={type:rB("string",rz._jsonSchemaVersion),seconds:rB("number"),nanoseconds:rB("number")};class rq{static fromTimestamp(e){return new rq(e)}static min(){return new rq(new rz(0,0))}static max(){return new rq(new rz(0x3afff4417f,1e9-1))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}let r$=-1;class rH{constructor(e,t,r,i){this.indexId=e,this.collectionGroup=t,this.fields=r,this.indexState=i}}function rW(e,t){let r=e.toTimestamp().seconds,i=e.toTimestamp().nanoseconds+1;return new rQ(rq.fromTimestamp(1e9===i?new rz(r+1,0):new rz(r,i)),rI.empty(),t)}function rG(e){return new rQ(e.readTime,e.key,r$)}rH.UNKNOWN_ID=-1;class rQ{constructor(e,t,r){this.readTime=e,this.documentKey=t,this.largestBatchId=r}static min(){return new rQ(rq.min(),rI.empty(),r$)}static max(){return new rQ(rq.max(),rI.empty(),r$)}}function rK(e,t){let r=e.readTime.compareTo(t.readTime);return 0!==r||0!==(r=rI.comparator(e.documentKey,t.documentKey))?r:rv(e.largestBatchId,t.largestBatchId)}let rJ="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class rY{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}async function rX(e){if(e.code===t8&&e.message===rJ)t$("LocalStore","Unexpectedly lost primary lease");else throw e}class rZ{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(e){return this.next(void 0,e)}next(e,t){return(this.callbackAttached&&tQ(59440),this.callbackAttached=!0,this.isDone)?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new rZ((r,i)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(r,i)},this.catchCallback=e=>{this.wrapFailure(t,e).next(r,i)}})}toPromise(){return new Promise((e,t)=>{this.next(e,t)})}wrapUserFunction(e){try{let t=e();if(t instanceof rZ)return t;return rZ.resolve(t)}catch(e){return rZ.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction(()=>e(t)):rZ.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction(()=>e(t)):rZ.reject(t)}static resolve(e){return new rZ((t,r)=>{t(e)})}static reject(e){return new rZ((t,r)=>{r(e)})}static waitFor(e){return new rZ((t,r)=>{let i=0,n=0,s=!1;e.forEach(e=>{++i,e.next(()=>{++n,s&&n===i&&t()},e=>r(e))}),s=!0,n===i&&t()})}static or(e){let t=rZ.resolve(!1);for(let r of e)t=t.next(e=>e?rZ.resolve(e):r());return t}static forEach(e,t){let r=[];return e.forEach((e,i)=>{r.push(t.call(this,e,i))}),this.waitFor(r)}static mapArray(e,t){return new rZ((r,i)=>{let n=e.length,s=Array(n),a=0;for(let o=0;o<n;o++){let l=o;t(e[l]).next(e=>{s[l]=e,++a===n&&r(s)},e=>i(e))}})}static doWhile(e,t){return new rZ((r,i)=>{let n=()=>{!0===e()?t().next(()=>{n()},i):r()};n()})}}function r0(e){let t=e.match(/Android ([\d.]+)/i);return Number(t?t[1].split(".").slice(0,2).join("."):"-1")}function r1(e){return"IndexedDbTransactionError"===e.name}class r2{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.setPreviousValue(e),this.writeNewSequenceNumber=e=>t.writeSequenceNumber(e))}setPreviousValue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){let e=++this.previousValue;return this.writeNewSequenceNumber&&this.writeNewSequenceNumber(e),e}}r2.INVALID=-1;let r3="\x01",r6="\x01",r4="\x10",r5="\x11";function r7(e){let t="";for(let r=0;r<e.length;r++)t.length>0&&(t=r9(t)),t=r8(e.get(r),t);return r9(t)}function r8(e,t){let r=t,i=e.length;for(let t=0;t<i;t++){let i=e.charAt(t);switch(i){case"\0":r+=r3+r4;break;case r3:r+=r3+r5;break;default:r+=i}}return r}function r9(e){return e+r3+r6}function ie(e){let t=0;for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&t++;return t}function it(e,t){for(let r in e)Object.prototype.hasOwnProperty.call(e,r)&&t(r,e[r])}function ir(e){for(let t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class ii{constructor(e,t){this.comparator=e,this.root=t||ia.EMPTY}insert(e,t){return new ii(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,ia.BLACK,null,null))}remove(e){return new ii(this.comparator,this.root.remove(e,this.comparator).copy(null,null,ia.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){let r=this.comparator(e,t.key);if(0===r)return t.value;r<0?t=t.left:r>0&&(t=t.right)}return null}indexOf(e){let t=0,r=this.root;for(;!r.isEmpty();){let i=this.comparator(e,r.key);if(0===i)return t+r.left.size;i<0?r=r.left:(t+=r.left.size+1,r=r.right)}return -1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((t,r)=>(e(t,r),!1))}toString(){let e=[];return this.inorderTraversal((t,r)=>(e.push(`${t}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new is(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new is(this.root,e,this.comparator,!1)}getReverseIterator(){return new is(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new is(this.root,e,this.comparator,!0)}}class is{constructor(e,t,r,i){this.isReverse=i,this.nodeStack=[];let n=1;for(;!e.isEmpty();)if(n=t?r(e.key,t):1,t&&i&&(n*=-1),n<0)e=this.isReverse?e.left:e.right;else if(0===n){this.nodeStack.push(e);break}else this.nodeStack.push(e),e=this.isReverse?e.right:e.left}getNext(){let e=this.nodeStack.pop(),t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;let e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class ia{constructor(e,t,r,i,n){this.key=e,this.value=t,this.color=null!=r?r:ia.RED,this.left=null!=i?i:ia.EMPTY,this.right=null!=n?n:ia.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,r,i,n){return new ia(null!=e?e:this.key,null!=t?t:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=n?n:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,r){let i=this,n=r(e,i.key);return(i=n<0?i.copy(null,null,null,i.left.insert(e,t,r),null):0===n?i.copy(null,t,null,null,null):i.copy(null,null,null,null,i.right.insert(e,t,r))).fixUp()}removeMin(){if(this.left.isEmpty())return ia.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()}remove(e,t){let r,i=this;if(0>t(e,i.key))i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,t),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===t(e,i.key))if(i.right.isEmpty())return ia.EMPTY;else r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin());i=i.copy(null,null,null,null,i.right.remove(e,t))}return i.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e}rotateLeft(){let e=this.copy(null,null,ia.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){let e=this.copy(null,null,ia.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){let e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){return Math.pow(2,this.check())<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw tQ(43730,{key:this.key,value:this.value});if(this.right.isRed())throw tQ(14113,{key:this.key,value:this.value});let e=this.left.check();if(e===this.right.check())return e+ +!this.isRed();throw tQ(27949)}}ia.EMPTY=null,ia.RED=!0,ia.BLACK=!1;class io{constructor(){this.size=0}get key(){throw tQ(57766)}get value(){throw tQ(16141)}get color(){throw tQ(16727)}get left(){throw tQ(29726)}get right(){throw tQ(36894)}copy(e,t,r,i,n){return this}insert(e,t,r){return new ia(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}}ia.EMPTY=new io;class il{constructor(e){this.comparator=e,this.data=new ii(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((t,r)=>(e(t),!1))}forEachInRange(e,t){let r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){let i=r.getNext();if(this.comparator(i.key,e[1])>=0)return;t(i.key)}}forEachWhile(e,t){let r;for(r=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){let t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new ic(this.data.getIterator())}getIteratorFrom(e){return new ic(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach(e=>{t=t.add(e)}),t}isEqual(e){if(!(e instanceof il)||this.size!==e.size)return!1;let t=this.data.getIterator(),r=e.data.getIterator();for(;t.hasNext();){let e=t.getNext().key,i=r.getNext().key;if(0!==this.comparator(e,i))return!1}return!0}toArray(){let e=[];return this.forEach(t=>{e.push(t)}),e}toString(){let e=[];return this.forEach(t=>e.push(t)),"SortedSet("+e.toString()+")"}copy(e){let t=new il(this.comparator);return t.data=e,t}}class ic{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class iu{constructor(e){this.fields=e,e.sort(rA.comparator)}static empty(){return new iu([])}unionWith(e){let t=new il(rA.comparator);for(let e of this.fields)t=t.add(e);for(let r of e)t=t.add(r);return new iu(t.toArray())}covers(e){for(let t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return rE(this.fields,e.fields,(e,t)=>e.isEqual(t))}}function ih(e){return Buffer.from(e,"base64").toString("binary")}function id(e){return Buffer.from(e,"binary").toString("base64")}class ip{constructor(e){this.binaryString=e}static fromBase64String(e){return new ip(ih(e))}static fromUint8Array(e){return new ip(im(e))}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return id(this.binaryString)}toUint8Array(){return ig(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return rv(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}function im(e){let t="";for(let r=0;r<e.length;++r)t+=String.fromCharCode(e[r]);return t}function ig(e){let t=new Uint8Array(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}ip.EMPTY_BYTE_STRING=new ip("");let iy=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function iv(e){if(tJ(!!e,39018),"string"==typeof e){let t=0,r=iy.exec(e);if(tJ(!!r,46558,{timestamp:e}),r[1]){let e=r[1];t=Number(e=(e+"000000000").substr(0,9))}return{seconds:Math.floor(new Date(e).getTime()/1e3),nanos:t}}return{seconds:ib(e.seconds),nanos:ib(e.nanos)}}function ib(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function iS(e){return"string"==typeof e?ip.fromBase64String(e):ip.fromUint8Array(e)}let iC="server_timestamp",iT="__type__",iE="__previous_value__",i_="__local_write_time__";function iw(e){return(e?.mapValue?.fields||{})[iT]?.stringValue===iC}function iR(e,t){let r={fields:{[iT]:{stringValue:iC},[i_]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&iw(t)&&(t=ik(t)),t&&(r.fields[iE]=t),{mapValue:r}}function ik(e){let t=e.mapValue.fields[iE];return iw(t)?ik(t):t}function iA(e){let t=iv(e.mapValue.fields[i_].timestampValue);return new rz(t.seconds,t.nanos)}class iI{constructor(e,t,r,i,n,s,a,o,l,c){this.databaseId=e,this.appId=t,this.persistenceKey=r,this.host=i,this.ssl=n,this.forceLongPolling=s,this.autoDetectLongPolling=a,this.longPollingOptions=o,this.useFetchStreams=l,this.isUsingEmulator=c}}let iO="(default)";class iN{constructor(e,t){this.projectId=e,this.database=t||iO}static empty(){return new iN("","")}get isDefaultDatabase(){return this.database===iO}isEqual(e){return e instanceof iN&&e.projectId===this.projectId&&e.database===this.database}}function ix(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new rs(t1,'"projectId" not provided in firebase.initializeApp.');return new iN(e.options.projectId,t)}let iD=-1;function iP(e){return null==e}function iM(e){return 0===e&&1/e==-1/0}function iL(e){return"number"==typeof e&&Number.isInteger(e)&&!iM(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}let iF="__type__",iB="__max__",ij={},iU="__vector__",iV="value";function iz(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?iw(e)?4:nm(e)?0x1fffffffffffff:nf(e)?10:11:tQ(28295,{value:e})}function iq(e,t){if(e===t)return!0;let r=iz(e);if(r!==iz(t))return!1;switch(r){case 0:case 0x1fffffffffffff:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return iA(e).isEqual(iA(t));case 3:return i$(e,t);case 5:return e.stringValue===t.stringValue;case 6:return iW(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return iH(e,t);case 2:return iG(e,t);case 9:return rE(e.arrayValue.values||[],t.arrayValue.values||[],iq);case 10:case 11:return iQ(e,t);default:return tQ(52216,{left:e})}}function i$(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;let r=iv(e.timestampValue),i=iv(t.timestampValue);return r.seconds===i.seconds&&r.nanos===i.nanos}function iH(e,t){return ib(e.geoPointValue.latitude)===ib(t.geoPointValue.latitude)&&ib(e.geoPointValue.longitude)===ib(t.geoPointValue.longitude)}function iW(e,t){return iS(e.bytesValue).isEqual(iS(t.bytesValue))}function iG(e,t){if("integerValue"in e&&"integerValue"in t)return ib(e.integerValue)===ib(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){let r=ib(e.doubleValue),i=ib(t.doubleValue);return r===i?iM(r)===iM(i):isNaN(r)&&isNaN(i)}return!1}function iQ(e,t){let r=e.mapValue.fields||{},i=t.mapValue.fields||{};if(ie(r)!==ie(i))return!1;for(let e in r)if(r.hasOwnProperty(e)&&(void 0===i[e]||!iq(r[e],i[e])))return!1;return!0}function iK(e,t){return void 0!==(e.values||[]).find(e=>iq(e,t))}function iJ(e,t){if(e===t)return 0;let r=iz(e),i=iz(t);if(r!==i)return rv(r,i);switch(r){case 0:case 0x1fffffffffffff:return 0;case 1:return rv(e.booleanValue,t.booleanValue);case 2:return iY(e,t);case 3:return iX(e.timestampValue,t.timestampValue);case 4:return iX(iA(e),iA(t));case 5:return rb(e.stringValue,t.stringValue);case 6:return i1(e.bytesValue,t.bytesValue);case 7:return iZ(e.referenceValue,t.referenceValue);case 8:return i0(e.geoPointValue,t.geoPointValue);case 9:return i2(e.arrayValue,t.arrayValue);case 10:return i3(e.mapValue,t.mapValue);case 11:return i6(e.mapValue,t.mapValue);default:throw tQ(23264,{leftType:r})}}function iY(e,t){let r=ib(e.integerValue||e.doubleValue),i=ib(t.integerValue||t.doubleValue);return r<i?-1:r>i?1:r===i?0:isNaN(r)?isNaN(i)?0:-1:1}function iX(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return rv(e,t);let r=iv(e),i=iv(t),n=rv(r.seconds,i.seconds);return 0!==n?n:rv(r.nanos,i.nanos)}function iZ(e,t){let r=e.split("/"),i=t.split("/");for(let e=0;e<r.length&&e<i.length;e++){let t=rv(r[e],i[e]);if(0!==t)return t}return rv(r.length,i.length)}function i0(e,t){let r=rv(ib(e.latitude),ib(t.latitude));return 0!==r?r:rv(ib(e.longitude),ib(t.longitude))}function i1(e,t){let r=iS(e),i=iS(t);return r.compareTo(i)}function i2(e,t){let r=e.values||[],i=t.values||[];for(let e=0;e<r.length&&e<i.length;++e){let t=iJ(r[e],i[e]);if(t)return t}return rv(r.length,i.length)}function i3(e,t){let r=e.fields||{},i=t.fields||{},n=r[iV]?.arrayValue,s=i[iV]?.arrayValue,a=rv(n?.values?.length||0,s?.values?.length||0);return 0!==a?a:i2(n,s)}function i6(e,t){if(e===ij&&t===ij)return 0;if(e===ij)return 1;if(t===ij)return -1;let r=e.fields||{},i=Object.keys(r),n=t.fields||{},s=Object.keys(n);i.sort(),s.sort();for(let e=0;e<i.length&&e<s.length;++e){let t=rb(i[e],s[e]);if(0!==t)return t;let a=iJ(r[i[e]],n[s[e]]);if(0!==a)return a}return rv(i.length,s.length)}function i4(e){return i5(e)}function i5(e){if("nullValue"in e)return"null";if("booleanValue"in e)return""+e.booleanValue;if("integerValue"in e)return""+e.integerValue;if("doubleValue"in e)return""+e.doubleValue;if("timestampValue"in e)return i8(e.timestampValue);else if("stringValue"in e)return e.stringValue;else if("bytesValue"in e)return i7(e.bytesValue);else if("referenceValue"in e)return ne(e.referenceValue);else if("geoPointValue"in e)return i9(e.geoPointValue);else if("arrayValue"in e)return nr(e.arrayValue);else if("mapValue"in e)return nt(e.mapValue);else return tQ(61005,{value:e})}function i7(e){return iS(e).toBase64()}function i8(e){let t=iv(e);return`time(${t.seconds},${t.nanos})`}function i9(e){return`geo(${e.latitude},${e.longitude})`}function ne(e){return rI.fromName(e).toString()}function nt(e){let t=Object.keys(e.fields||{}).sort(),r="{",i=!0;for(let n of t)i?i=!1:r+=",",r+=`${n}:${i5(e.fields[n])}`;return r+"}"}function nr(e){let t="[",r=!0;for(let i of e.values||[])r?r=!1:t+=",",t+=i5(i);return t+"]"}function ni(e){switch(iz(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:let t=ik(e);return t?16+ni(t):16;case 5:return 2*e.stringValue.length;case 6:return iS(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return ns(e.arrayValue);case 10:case 11:return nn(e.mapValue);default:throw tQ(13486,{value:e})}}function nn(e){let t=0;return it(e.fields,(e,r)=>{t+=e.length+ni(r)}),t}function ns(e){return(e.values||[]).reduce((e,t)=>e+ni(t),0)}function na(e){return!!e&&"integerValue"in e}function no(e){return!!e&&"doubleValue"in e}function nl(e){return na(e)||no(e)}function nc(e){return!!e&&"arrayValue"in e}function nu(e){return!!e&&"nullValue"in e}function nh(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function nd(e){return!!e&&"mapValue"in e}function nf(e){return(e?.mapValue?.fields||{})[iF]?.stringValue===iU}function np(e){if(e.geoPointValue)return{geoPointValue:{...e.geoPointValue}};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:{...e.timestampValue}};if(e.mapValue){let t={mapValue:{fields:{}}};return it(e.mapValue.fields,(e,r)=>t.mapValue.fields[e]=np(r)),t}{if(!e.arrayValue)return{...e};let t={arrayValue:{values:[]}};for(let r=0;r<(e.arrayValue.values||[]).length;++r)t.arrayValue.values[r]=np(e.arrayValue.values[r]);return t}}function nm(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===iB}class ng{constructor(e){this.value=e}static empty(){return new ng({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let r=0;r<e.length-1;++r)if(!nd(t=(t.mapValue.fields||{})[e.get(r)]))return null;return(t=(t.mapValue.fields||{})[e.lastSegment()])||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=np(t)}setAll(e){let t=rA.emptyPath(),r={},i=[];e.forEach((e,n)=>{if(!t.isImmediateParentOf(n)){let e=this.getFieldsMap(t);this.applyChanges(e,r,i),r={},i=[],t=n.popLast()}e?r[n.lastSegment()]=np(e):i.push(n.lastSegment())});let n=this.getFieldsMap(t);this.applyChanges(n,r,i)}delete(e){let t=this.field(e.popLast());nd(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return iq(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let r=0;r<e.length;++r){let i=t.mapValue.fields[e.get(r)];nd(i)&&i.mapValue.fields||(i={mapValue:{fields:{}}},t.mapValue.fields[e.get(r)]=i),t=i}return t.mapValue.fields}applyChanges(e,t,r){for(let i of(it(t,(t,r)=>e[t]=r),r))delete e[i]}clone(){return new ng(np(this.value))}}function ny(e){let t=[];return it(e.fields,(e,r)=>{let i=new rA([e]);if(nd(r)){let e=ny(r.mapValue).fields;if(0===e.length)t.push(i);else for(let r of e)t.push(i.child(r))}else t.push(i)}),new iu(t)}class nv{constructor(e,t,r,i,n,s,a){this.key=e,this.documentType=t,this.version=r,this.readTime=i,this.createTime=n,this.data=s,this.documentState=a}static newInvalidDocument(e){return new nv(e,0,rq.min(),rq.min(),rq.min(),ng.empty(),0)}static newFoundDocument(e,t,r,i){return new nv(e,1,t,rq.min(),r,i,0)}static newNoDocument(e,t){return new nv(e,2,t,rq.min(),rq.min(),ng.empty(),0)}static newUnknownDocument(e,t){return new nv(e,3,t,rq.min(),rq.min(),ng.empty(),2)}convertToFoundDocument(e,t){return this.createTime.isEqual(rq.min())&&(2===this.documentType||0===this.documentType)&&(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ng.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ng.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=rq.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof nv&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new nv(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}function nb(e,t,r){let i=t.data.field(e),n=r.data.field(e);return null!==i&&null!==n?iJ(i,n):tQ(42886)}class nS{constructor(e,t){this.position=e,this.inclusive=t}}function nC(e,t,r){let i=0;for(let n=0;n<e.position.length;n++){let s=t[n],a=e.position[n];if(i=s.field.isKeyField()?rI.comparator(rI.fromName(a.referenceValue),r.key):iJ(a,r.data.field(s.field)),"desc"===s.dir&&(i*=-1),0!==i)break}return i}function nT(e,t,r){let i=nC(e,t,r);return e.inclusive?i>=0:i>0}function nE(e,t,r){let i=nC(e,t,r);return e.inclusive?i<=0:i<0}function n_(e,t){if(null===e)return null===t;if(null===t||e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let r=0;r<e.position.length;r++)if(!iq(e.position[r],t.position[r]))return!1;return!0}class nw{constructor(e,t="asc"){this.field=e,this.dir=t}}function nR(e){return e.field.canonicalString()+e.dir}function nk(e){return`${e.field.canonicalString()} (${e.dir})`}function nA(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class nI{}class nO extends nI{constructor(e,t,r){super(),this.field=e,this.op=t,this.value=r}static create(e,t,r){if(e.isKeyField())if("in"===t||"not-in"===t)return this.createKeyFieldInFilter(e,t,r);else return new nz(e,t,r);if("array-contains"===t)return new nW(e,r);if("in"===t)return new nG(e,r);if("not-in"===t)return new nQ(e,r);if("array-contains-any"===t)return new nK(e,r);else return new nO(e,t,r)}static createKeyFieldInFilter(e,t,r){return"in"===t?new nq(e,r):new n$(e,r)}matches(e){let t=e.data.field(this.field);return"!="===this.op?null!==t&&void 0===t.nullValue&&this.matchesComparison(iJ(t,this.value)):null!==t&&iz(this.value)===iz(t)&&this.matchesComparison(iJ(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return tQ(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class nN extends nI{constructor(e,t){super(),this.filters=e,this.op=t,this.memoizedFlattenedFilters=null}static create(e,t){return new nN(e,t)}matches(e){return nx(this)?void 0===this.filters.find(t=>!t.matches(e)):void 0!==this.filters.find(t=>t.matches(e))}getFlattenedFilters(){return null!==this.memoizedFlattenedFilters||(this.memoizedFlattenedFilters=this.filters.reduce((e,t)=>e.concat(t.getFlattenedFilters()),[])),this.memoizedFlattenedFilters}getFilters(){return Object.assign([],this.filters)}}function nx(e){return"and"===e.op}function nD(e){return nP(e)&&nx(e)}function nP(e){for(let t of e.filters)if(t instanceof nN)return!1;return!0}function nM(e){if(e instanceof nO)return e.field.canonicalString()+e.op.toString()+i4(e.value);{if(nD(e))return e.filters.map(e=>nM(e)).join(",");let t=e.filters.map(e=>nM(e)).join(",");return`${e.op}(${t})`}}function nL(e,t){return e instanceof nO?nF(e,t):e instanceof nN?nB(e,t):void tQ(19439)}function nF(e,t){return t instanceof nO&&e.op===t.op&&e.field.isEqual(t.field)&&iq(e.value,t.value)}function nB(e,t){return t instanceof nN&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce((e,r,i)=>e&&nL(r,t.filters[i]),!0)}function nj(e){return e instanceof nO?nV(e):e instanceof nN?nU(e):"Filter"}function nU(e){return e.op.toString()+" {"+e.getFilters().map(nj).join(" ,")+"}"}function nV(e){return`${e.field.canonicalString()} ${e.op} ${i4(e.value)}`}class nz extends nO{constructor(e,t,r){super(e,t,r),this.key=rI.fromName(r.referenceValue)}matches(e){let t=rI.comparator(e.key,this.key);return this.matchesComparison(t)}}class nq extends nO{constructor(e,t){super(e,"in",t),this.keys=nH("in",t)}matches(e){return this.keys.some(t=>t.isEqual(e.key))}}class n$ extends nO{constructor(e,t){super(e,"not-in",t),this.keys=nH("not-in",t)}matches(e){return!this.keys.some(t=>t.isEqual(e.key))}}function nH(e,t){return(t.arrayValue?.values||[]).map(e=>rI.fromName(e.referenceValue))}class nW extends nO{constructor(e,t){super(e,"array-contains",t)}matches(e){let t=e.data.field(this.field);return nc(t)&&iK(t.arrayValue,this.value)}}class nG extends nO{constructor(e,t){super(e,"in",t)}matches(e){let t=e.data.field(this.field);return null!==t&&iK(this.value.arrayValue,t)}}class nQ extends nO{constructor(e,t){super(e,"not-in",t)}matches(e){if(iK(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let t=e.data.field(this.field);return null!==t&&void 0===t.nullValue&&!iK(this.value.arrayValue,t)}}class nK extends nO{constructor(e,t){super(e,"array-contains-any",t)}matches(e){let t=e.data.field(this.field);return!!nc(t)&&!!t.arrayValue.values&&t.arrayValue.values.some(e=>iK(this.value.arrayValue,e))}}class nJ{constructor(e,t=null,r=[],i=[],n=null,s=null,a=null){this.path=e,this.collectionGroup=t,this.orderBy=r,this.filters=i,this.limit=n,this.startAt=s,this.endAt=a,this.memoizedCanonicalId=null}}function nY(e,t=null,r=[],i=[],n=null,s=null,a=null){return new nJ(e,t,r,i,n,s,a)}function nX(e){let t=tY(e);if(null===t.memoizedCanonicalId){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(e=>nM(e)).join(","),e+="|ob:",e+=t.orderBy.map(e=>nR(e)).join(","),iP(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(e=>i4(e)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(e=>i4(e)).join(",")),t.memoizedCanonicalId=e}return t.memoizedCanonicalId}function nZ(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map(e=>nj(e)).join(", ")}]`),iP(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map(e=>nk(e)).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map(e=>i4(e)).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map(e=>i4(e)).join(",")),`Target(${t})`}function n0(e,t){if(e.limit!==t.limit||e.orderBy.length!==t.orderBy.length)return!1;for(let r=0;r<e.orderBy.length;r++)if(!nA(e.orderBy[r],t.orderBy[r]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let r=0;r<e.filters.length;r++)if(!nL(e.filters[r],t.filters[r]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!n_(e.startAt,t.startAt)&&n_(e.endAt,t.endAt)}class n1{constructor(e,t=null,r=[],i=[],n=null,s="F",a=null,o=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=r,this.filters=i,this.limit=n,this.limitType=s,this.startAt=a,this.endAt=o,this.memoizedNormalizedOrderBy=null,this.memoizedTarget=null,this.memoizedAggregateTarget=null,this.startAt,this.endAt}}function n2(e,t,r,i,n,s,a,o){return new n1(e,t,r,i,n,s,a,o)}function n3(e){return new n1(e)}function n6(e,t){return new n1(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}function n4(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function n5(e){let t=new il(rA.comparator);return e.filters.forEach(e=>{e.getFlattenedFilters().forEach(e=>{e.isInequality()&&(t=t.add(e.field))})}),t}function n7(e){return rI.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function n8(e){return null!==e.collectionGroup}function n9(e){let t=tY(e);if(null===t.memoizedNormalizedOrderBy){t.memoizedNormalizedOrderBy=[];let e=new Set;for(let r of t.explicitOrderBy)t.memoizedNormalizedOrderBy.push(r),e.add(r.field.canonicalString());let r=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";n5(t).forEach(i=>{e.has(i.canonicalString())||i.isKeyField()||t.memoizedNormalizedOrderBy.push(new nw(i,r))}),e.has(rA.keyField().canonicalString())||t.memoizedNormalizedOrderBy.push(new nw(rA.keyField(),r))}return t.memoizedNormalizedOrderBy}function se(e){let t=tY(e);return t.memoizedTarget||(t.memoizedTarget=st(t,n9(e))),t.memoizedTarget}function st(e,t){if("F"===e.limitType)return nY(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map(e=>{let t="desc"===e.dir?"asc":"desc";return new nw(e.field,t)});let r=e.endAt?new nS(e.endAt.position,e.endAt.inclusive):null,i=e.startAt?new nS(e.startAt.position,e.startAt.inclusive):null;return nY(e.path,e.collectionGroup,t,e.filters,e.limit,r,i)}}function sr(e,t,r){return new n1(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,r,e.startAt,e.endAt)}function si(e,t){return n0(se(e),se(t))&&e.limitType===t.limitType}function sn(e){return`${nX(se(e))}|lt:${e.limitType}`}function ss(e){return`Query(target=${nZ(se(e))}; limitType=${e.limitType})`}function sa(e,t){return t.isFoundDocument()&&so(e,t)&&sl(e,t)&&sc(e,t)&&su(e,t)}function so(e,t){let r=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(r):rI.isDocumentKey(e.path)?e.path.isEqual(r):e.path.isImmediateParentOf(r)}function sl(e,t){for(let r of n9(e))if(!r.field.isKeyField()&&null===t.data.field(r.field))return!1;return!0}function sc(e,t){for(let r of e.filters)if(!r.matches(t))return!1;return!0}function su(e,t){return(!e.startAt||!!nE(e.startAt,n9(e),t))&&(!e.endAt||!!nT(e.endAt,n9(e),t))}function sh(e){return(t,r)=>{let i=!1;for(let n of n9(e)){let e=sd(n,t,r);if(0!==e)return e;i=i||n.field.isKeyField()}return 0}}function sd(e,t,r){let i=e.field.isKeyField()?rI.comparator(t.key,r.key):nb(e.field,t,r);switch(e.dir){case"asc":return i;case"desc":return -1*i;default:return tQ(19790,{direction:e.dir})}}class sf{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){let t=this.mapKeyFn(e),r=this.inner[t];if(void 0!==r){for(let[t,i]of r)if(this.equalsFn(t,e))return i}}has(e){return void 0!==this.get(e)}set(e,t){let r=this.mapKeyFn(e),i=this.inner[r];if(void 0===i){this.inner[r]=[[e,t]],this.innerSize++;return}for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],e)){i[r]=[e,t];return}i.push([e,t]),this.innerSize++}delete(e){let t=this.mapKeyFn(e),r=this.inner[t];if(void 0===r)return!1;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return 1===r.length?delete this.inner[t]:r.splice(i,1),this.innerSize--,!0;return!1}forEach(e){it(this.inner,(t,r)=>{for(let[t,i]of r)e(t,i)})}isEmpty(){return ir(this.inner)}size(){return this.innerSize}}let sp=new ii(rI.comparator);function sm(){return sp}let sg=new ii(rI.comparator);function sy(...e){let t=sg;for(let r of e)t=t.insert(r.key,r);return t}function sv(){return sT()}function sb(e){let t=sg;return e.forEach((e,r)=>t=t.insert(e,r.overlayedDocument)),t}function sS(){return sT()}function sC(){return sT()}function sT(){return new sf(e=>e.toString(),(e,t)=>e.isEqual(t))}let sE=new ii(rI.comparator);function s_(){return sE}let sw=new il(rI.comparator);function sR(...e){let t=sw;for(let r of e)t=t.add(r);return t}let sk=new il(rv);function sA(){return sk}function sI(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};else if(t===1/0)return{doubleValue:"Infinity"};else if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:iM(t)?"-0":t}}function sO(e){return{integerValue:""+e}}function sN(e,t){return iL(t)?sO(t):sI(e,t)}class sx{constructor(){this._=void 0}}function sD(e,t,r){return e instanceof sF?iR(r,t):e instanceof sB?sj(e,t):e instanceof sU?sV(e,t):sq(e,t)}function sP(e,t,r){return e instanceof sB?sj(e,t):e instanceof sU?sV(e,t):r}function sM(e,t){return e instanceof sz?nl(t)?t:{integerValue:0}:null}function sL(e,t){return e instanceof sB&&t instanceof sB||e instanceof sU&&t instanceof sU?rE(e.elements,t.elements,iq):e instanceof sz&&t instanceof sz?iq(e.operand,t.operand):e instanceof sF&&t instanceof sF}class sF extends sx{}class sB extends sx{constructor(e){super(),this.elements=e}}function sj(e,t){let r=sH(t);for(let t of e.elements)r.some(e=>iq(e,t))||r.push(t);return{arrayValue:{values:r}}}class sU extends sx{constructor(e){super(),this.elements=e}}function sV(e,t){let r=sH(t);for(let t of e.elements)r=r.filter(e=>!iq(e,t));return{arrayValue:{values:r}}}class sz extends sx{constructor(e,t){super(),this.serializer=e,this.operand=t}}function sq(e,t){let r=sM(e,t),i=s$(r)+s$(e.operand);return na(r)&&na(e.operand)?sO(i):sI(e.serializer,i)}function s$(e){return ib(e.integerValue||e.doubleValue)}function sH(e){return nc(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class sW{constructor(e,t){this.field=e,this.transform=t}}function sG(e,t){return e.field.isEqual(t.field)&&sL(e.transform,t.transform)}function sQ(e,t){return void 0===e&&void 0===t||!!e&&!!t&&rE(e,t,(e,t)=>sG(e,t))}class sK{constructor(e,t){this.version=e,this.transformResults=t}}class sJ{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new sJ}static exists(e){return new sJ(void 0,e)}static updateTime(e){return new sJ(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function sY(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class sX{}function sZ(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)if(e.isNoDocument())return new ai(e.key,sJ.none());else return new s6(e.key,e.data,sJ.none());{let r=e.data,i=ng.empty(),n=new il(rA.comparator);for(let e of t.fields)if(!n.has(e)){let t=r.field(e);null===t&&e.length>1&&(e=e.popLast(),t=r.field(e)),null===t?i.delete(e):i.set(e,t),n=n.add(e)}return new s7(e.key,i,new iu(n.toArray()),sJ.none())}}function s0(e,t,r){e instanceof s6?s4(e,t,r):e instanceof s7?s8(e,t,r):an(e,t,r)}function s1(e,t,r,i){return e instanceof s6?s5(e,t,r,i):e instanceof s7?s9(e,t,r,i):as(e,t,r)}function s2(e,t){let r=null;for(let i of e.fieldTransforms){let e=t.data.field(i.field),n=sM(i.transform,e||null);null!=n&&(null===r&&(r=ng.empty()),r.set(i.field,n))}return r||null}function s3(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!sQ(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class s6 extends sX{constructor(e,t,r,i=[]){super(),this.key=e,this.value=t,this.precondition=r,this.fieldTransforms=i,this.type=0}getFieldMask(){return null}}function s4(e,t,r){let i=e.value.clone(),n=at(e.fieldTransforms,t,r.transformResults);i.setAll(n),t.convertToFoundDocument(r.version,i).setHasCommittedMutations()}function s5(e,t,r,i){if(!sY(e.precondition,t))return r;let n=e.value.clone(),s=ar(e.fieldTransforms,i,t);return n.setAll(s),t.convertToFoundDocument(t.version,n).setHasLocalMutations(),null}class s7 extends sX{constructor(e,t,r,i,n=[]){super(),this.key=e,this.data=t,this.fieldMask=r,this.precondition=i,this.fieldTransforms=n,this.type=1}getFieldMask(){return this.fieldMask}}function s8(e,t,r){if(!sY(e.precondition,t))return void t.convertToUnknownDocument(r.version);let i=at(e.fieldTransforms,t,r.transformResults),n=t.data;n.setAll(ae(e)),n.setAll(i),t.convertToFoundDocument(r.version,n).setHasCommittedMutations()}function s9(e,t,r,i){if(!sY(e.precondition,t))return r;let n=ar(e.fieldTransforms,i,t),s=t.data;return(s.setAll(ae(e)),s.setAll(n),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===r)?null:r.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map(e=>e.field))}function ae(e){let t=new Map;return e.fieldMask.fields.forEach(r=>{if(!r.isEmpty()){let i=e.data.field(r);t.set(r,i)}}),t}function at(e,t,r){let i=new Map;tJ(e.length===r.length,32656,{serverTransformResultCount:r.length,fieldTransformCount:e.length});for(let n=0;n<r.length;n++){let s=e[n],a=s.transform,o=t.data.field(s.field);i.set(s.field,sP(a,o,r[n]))}return i}function ar(e,t,r){let i=new Map;for(let n of e){let e=n.transform,s=r.data.field(n.field);i.set(n.field,sD(e,s,t))}return i}class ai extends sX{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}function an(e,t,r){t.convertToNoDocument(r.version).setHasCommittedMutations()}function as(e,t,r){return sY(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):r}class aa extends sX{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class ao{constructor(e,t,r,i){this.batchId=e,this.localWriteTime=t,this.baseMutations=r,this.mutations=i}applyToRemoteDocument(e,t){let r=t.mutationResults;for(let t=0;t<this.mutations.length;t++){let i=this.mutations[t];i.key.isEqual(e.key)&&s0(i,e,r[t])}}applyToLocalView(e,t){for(let r of this.baseMutations)r.key.isEqual(e.key)&&(t=s1(r,e,t,this.localWriteTime));for(let r of this.mutations)r.key.isEqual(e.key)&&(t=s1(r,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){let r=sC();return this.mutations.forEach(i=>{let n=e.get(i.key),s=n.overlayedDocument,a=this.applyToLocalView(s,n.mutatedFields),o=sZ(s,a=t.has(i.key)?null:a);null!==o&&r.set(i.key,o),s.isValidDocument()||s.convertToNoDocument(rq.min())}),r}keys(){return this.mutations.reduce((e,t)=>e.add(t.key),sR())}isEqual(e){return this.batchId===e.batchId&&rE(this.mutations,e.mutations,(e,t)=>s3(e,t))&&rE(this.baseMutations,e.baseMutations,(e,t)=>s3(e,t))}}class al{constructor(e,t,r,i){this.batch=e,this.commitVersion=t,this.mutationResults=r,this.docVersions=i}static from(e,t,r){tJ(e.mutations.length===r.length,58842,{mutationsSent:e.mutations.length,resultsReceived:r.length});let i=s_(),n=e.mutations;for(let e=0;e<n.length;e++)i=i.insert(n[e].key,r[e].version);return new al(e,t,r,i)}}class ac{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}function au(e){switch(e){case tX:return tQ(64938);case tZ:case t0:case t2:case t7:case rr:case ri:case t5:return!1;case t1:case t3:case t6:case t4:case t8:case t9:case re:case rt:case rn:return!0;default:return tQ(15467,{code:e})}}function ah(e){return au(e)&&e!==t9}function ad(e){if(void 0===e)return tH("GRPC error has no .code"),t0;switch(e){case a.OK:return tX;case a.CANCELLED:return tZ;case a.UNKNOWN:return t0;case a.DEADLINE_EXCEEDED:return t2;case a.RESOURCE_EXHAUSTED:return t7;case a.INTERNAL:return rr;case a.UNAVAILABLE:return ri;case a.UNAUTHENTICATED:return t5;case a.INVALID_ARGUMENT:return t1;case a.NOT_FOUND:return t3;case a.ALREADY_EXISTS:return t6;case a.PERMISSION_DENIED:return t4;case a.FAILED_PRECONDITION:return t8;case a.ABORTED:return t9;case a.OUT_OF_RANGE:return re;case a.UNIMPLEMENTED:return rt;case a.DATA_LOSS:return rn;default:return tQ(39323,{code:e})}}function af(){return new tO.TextEncoder}!function(e){e[e.OK=0]="OK",e[e.CANCELLED=1]="CANCELLED",e[e.UNKNOWN=2]="UNKNOWN",e[e.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",e[e.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",e[e.NOT_FOUND=5]="NOT_FOUND",e[e.ALREADY_EXISTS=6]="ALREADY_EXISTS",e[e.PERMISSION_DENIED=7]="PERMISSION_DENIED",e[e.UNAUTHENTICATED=16]="UNAUTHENTICATED",e[e.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",e[e.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",e[e.ABORTED=10]="ABORTED",e[e.OUT_OF_RANGE=11]="OUT_OF_RANGE",e[e.UNIMPLEMENTED=12]="UNIMPLEMENTED",e[e.INTERNAL=13]="INTERNAL",e[e.UNAVAILABLE=14]="UNAVAILABLE",e[e.DATA_LOSS=15]="DATA_LOSS"}(a||(a={})),new n([0xffffffff,0xffffffff],0);let ap=(()=>{let e={};return e.asc="ASCENDING",e.desc="DESCENDING",e})(),am=(()=>{let e={};return e["<"]="LESS_THAN",e["<="]="LESS_THAN_OR_EQUAL",e[">"]="GREATER_THAN",e[">="]="GREATER_THAN_OR_EQUAL",e["=="]="EQUAL",e["!="]="NOT_EQUAL",e["array-contains"]="ARRAY_CONTAINS",e.in="IN",e["not-in"]="NOT_IN",e["array-contains-any"]="ARRAY_CONTAINS_ANY",e})(),ag=(()=>{let e={};return e.and="AND",e.or="OR",e})();class ay{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function av(e,t){return e.useProto3Json||iP(t)?t:{value:t}}function ab(e){let t;return iP(t="object"==typeof e?e.value:e)?null:t}function aS(e,t){if(!e.useProto3Json)return{seconds:""+t.seconds,nanos:t.nanoseconds};{let e=new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z",""),r=("000000000"+t.nanoseconds).slice(-9);return`${e}.${r}Z`}}function aC(e){let t=iv(e);return new rz(t.seconds,t.nanos)}function aT(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function aE(e,t){return aS(e,t.toTimestamp())}function a_(e){return tJ(!!e,49232),rq.fromTimestamp(aC(e))}function aw(e,t){return aR(e,t).canonicalString()}function aR(e,t){let r=ax(e).child("documents");return void 0===t?r:r.child(t)}function ak(e){let t=rR.fromString(e);return tJ(on(t),10190,{key:t.toString()}),t}function aA(e,t){return aw(e.databaseId,t.path)}function aI(e,t){return aw(e.databaseId,t)}function aO(e){let t=ak(e);return 4===t.length?rR.emptyPath():aD(t)}function aN(e){return new rR(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function ax(e){return new rR(["projects",e.projectId,"databases",e.database])}function aD(e){return tJ(e.length>4&&"documents"===e.get(4),29091,{key:e.toString()}),e.popFirst(5)}function aP(e,t,r){return{name:aA(e,t),fields:r.value.mapValue.fields}}function aM(e,t){let r;if(t instanceof s6)r={update:aP(e,t.key,t.value)};else if(t instanceof ai)r={delete:aA(e,t.key)};else if(t instanceof s7)r={update:aP(e,t.key,t.data),updateMask:oi(t.fieldMask)};else{if(!(t instanceof aa))return tQ(16599,{mutationType:t.type});r={verify:aA(e,t.key)}}return t.fieldTransforms.length>0&&(r.updateTransforms=t.fieldTransforms.map(t=>aj(e,t))),t.precondition.isNone||(r.currentDocument=aL(e,t.precondition)),r}function aL(e,t){return void 0!==t.updateTime?{updateTime:aE(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:tQ(27497)}function aF(e,t){let r=e.updateTime?a_(e.updateTime):a_(t);return r.isEqual(rq.min())&&(r=a_(t)),new sK(r,e.transformResults||[])}function aB(e,t){return e&&e.length>0?(tJ(void 0!==t,14353),e.map(e=>aF(e,t))):[]}function aj(e,t){let r=t.transform;if(r instanceof sF)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(r instanceof sB)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:r.elements}};if(r instanceof sU)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:r.elements}};if(r instanceof sz)return{fieldPath:t.field.canonicalString(),increment:r.operand};throw tQ(20930,{transform:t.transform})}function aU(e,t){let r,i={structuredQuery:{}},n=t.path;null!==t.collectionGroup?(r=n,i.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(r=n.popLast(),i.structuredQuery.from=[{collectionId:n.lastSegment()}]),i.parent=aI(e,r);let s=az(t.filters);s&&(i.structuredQuery.where=s);let a=aH(t.orderBy);a&&(i.structuredQuery.orderBy=a);let o=av(e,t.limit);return null!==o&&(i.structuredQuery.limit=o),t.startAt&&(i.structuredQuery.startAt=aG(t.startAt)),t.endAt&&(i.structuredQuery.endAt=aQ(t.endAt)),{queryTarget:i,parent:r}}function aV(e){let t=aO(e.parent),r=e.structuredQuery,i=r.from?r.from.length:0,n=null;if(i>0){tJ(1===i,65062);let e=r.from[0];e.allDescendants?n=e.collectionId:t=t.child(e.collectionId)}let s=[];r.where&&(s=aq(r.where));let a=[];r.orderBy&&(a=aW(r.orderBy));let o=null;r.limit&&(o=ab(r.limit));let l=null;r.startAt&&(l=aK(r.startAt));let c=null;return r.endAt&&(c=aJ(r.endAt)),n2(t,n,a,s,o,"F",l,c)}function az(e){if(0!==e.length)return a7(nN.create(e,"and"))}function aq(e){let t=a$(e);return t instanceof nN&&nD(t)?t.getFilters():[t]}function a$(e){return void 0!==e.unaryFilter?oe(e):void 0!==e.fieldFilter?ot(e):void 0!==e.compositeFilter?or(e):tQ(30097,{filter:e})}function aH(e){if(0!==e.length)return e.map(e=>a4(e))}function aW(e){return e.map(e=>a5(e))}function aG(e){return{before:e.inclusive,values:e.position}}function aQ(e){return{before:!e.inclusive,values:e.position}}function aK(e){let t=!!e.before;return new nS(e.values||[],t)}function aJ(e){let t=!e.before;return new nS(e.values||[],t)}function aY(e){return ap[e]}function aX(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}function aZ(e){return am[e]}function a0(e){return ag[e]}function a1(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return tQ(58110);default:return tQ(50506)}}function a2(e){switch(e){case"AND":return"and";case"OR":return"or";default:return tQ(1026)}}function a3(e){return{fieldPath:e.canonicalString()}}function a6(e){return rA.fromServerFormat(e.fieldPath)}function a4(e){return{field:a3(e.field),direction:aY(e.dir)}}function a5(e){return new nw(a6(e.field),aX(e.direction))}function a7(e){return e instanceof nO?a9(e):e instanceof nN?a8(e):tQ(54877,{filter:e})}function a8(e){let t=e.getFilters().map(e=>a7(e));return 1===t.length?t[0]:{compositeFilter:{op:a0(e.op),filters:t}}}function a9(e){if("=="===e.op){if(nh(e.value))return{unaryFilter:{field:a3(e.field),op:"IS_NAN"}};else if(nu(e.value))return{unaryFilter:{field:a3(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(nh(e.value))return{unaryFilter:{field:a3(e.field),op:"IS_NOT_NAN"}};else if(nu(e.value))return{unaryFilter:{field:a3(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:a3(e.field),op:aZ(e.op),value:e.value}}}function oe(e){switch(e.unaryFilter.op){case"IS_NAN":let t=a6(e.unaryFilter.field);return nO.create(t,"==",{doubleValue:NaN});case"IS_NULL":let r=a6(e.unaryFilter.field);return nO.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let i=a6(e.unaryFilter.field);return nO.create(i,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let n=a6(e.unaryFilter.field);return nO.create(n,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return tQ(61313);default:return tQ(60726)}}function ot(e){return nO.create(a6(e.fieldFilter.field),a1(e.fieldFilter.op),e.fieldFilter.value)}function or(e){return nN.create(e.compositeFilter.filters.map(e=>a$(e)),a2(e.compositeFilter.op))}function oi(e){let t=[];return e.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function on(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class os{constructor(e){this.remoteSerializer=e}}function oa(e){let t=aV({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?sr(t,t.limit,"L"):t}function oo(e){return{name:e.name,query:oa(e.bundledQuery),readTime:a_(e.readTime)}}function ol(e){return{id:e.id,version:e.version,createTime:a_(e.createTime)}}let oc=5,ou=10,oh=13,od=15,of=20,op=25,om=30,og=37,oy=45,ov=50,ob=53,oS=55,oC=60,oT=2;class oE{constructor(){}writeIndexValue(e,t){this.writeIndexValueAux(e,t),t.writeInfinity()}writeIndexValueAux(e,t){if("nullValue"in e)this.writeValueTypeLabel(t,oc);else if("booleanValue"in e)this.writeValueTypeLabel(t,ou),t.writeNumber(+!!e.booleanValue);else if("integerValue"in e)this.writeValueTypeLabel(t,od),t.writeNumber(ib(e.integerValue));else if("doubleValue"in e){let r=ib(e.doubleValue);isNaN(r)?this.writeValueTypeLabel(t,oh):(this.writeValueTypeLabel(t,od),iM(r)?t.writeNumber(0):t.writeNumber(r))}else if("timestampValue"in e){let r=e.timestampValue;this.writeValueTypeLabel(t,of),"string"==typeof r&&(r=iv(r)),t.writeString(`${r.seconds||""}`),t.writeNumber(r.nanos||0)}else if("stringValue"in e)this.writeIndexString(e.stringValue,t),this.writeTruncationMarker(t);else if("bytesValue"in e)this.writeValueTypeLabel(t,om),t.writeBytes(iS(e.bytesValue)),this.writeTruncationMarker(t);else if("referenceValue"in e)this.writeIndexEntityRef(e.referenceValue,t);else if("geoPointValue"in e){let r=e.geoPointValue;this.writeValueTypeLabel(t,oy),t.writeNumber(r.latitude||0),t.writeNumber(r.longitude||0)}else"mapValue"in e?nm(e)?this.writeValueTypeLabel(t,Number.MAX_SAFE_INTEGER):nf(e)?this.writeIndexVector(e.mapValue,t):(this.writeIndexMap(e.mapValue,t),this.writeTruncationMarker(t)):"arrayValue"in e?(this.writeIndexArray(e.arrayValue,t),this.writeTruncationMarker(t)):tQ(19022,{indexValue:e})}writeIndexString(e,t){this.writeValueTypeLabel(t,op),this.writeUnlabeledIndexString(e,t)}writeUnlabeledIndexString(e,t){t.writeString(e)}writeIndexMap(e,t){let r=e.fields||{};for(let e of(this.writeValueTypeLabel(t,oS),Object.keys(r)))this.writeIndexString(e,t),this.writeIndexValueAux(r[e],t)}writeIndexVector(e,t){let r=e.fields||{};this.writeValueTypeLabel(t,ob);let i=iV,n=r[i].arrayValue?.values?.length||0;this.writeValueTypeLabel(t,od),t.writeNumber(ib(n)),this.writeIndexString(i,t),this.writeIndexValueAux(r[i],t)}writeIndexArray(e,t){let r=e.values||[];for(let e of(this.writeValueTypeLabel(t,ov),r))this.writeIndexValueAux(e,t)}writeIndexEntityRef(e,t){this.writeValueTypeLabel(t,og),rI.fromName(e).path.forEach(e=>{this.writeValueTypeLabel(t,oC),this.writeUnlabeledIndexString(e,t)})}writeValueTypeLabel(e,t){e.writeNumber(t)}writeTruncationMarker(e){e.writeNumber(oT)}}oE.INSTANCE=new oE;class o_{constructor(){this.collectionParentIndex=new ow}addToCollectionParentIndex(e,t){return this.collectionParentIndex.add(t),rZ.resolve()}getCollectionParents(e,t){return rZ.resolve(this.collectionParentIndex.getEntries(t))}addFieldIndex(e,t){return rZ.resolve()}deleteFieldIndex(e,t){return rZ.resolve()}deleteAllFieldIndexes(e){return rZ.resolve()}createTargetIndexes(e,t){return rZ.resolve()}getDocumentsMatchingTarget(e,t){return rZ.resolve(null)}getIndexType(e,t){return rZ.resolve(0)}getFieldIndexes(e,t){return rZ.resolve([])}getNextCollectionGroupToUpdate(e){return rZ.resolve(null)}getMinOffset(e,t){return rZ.resolve(rQ.min())}getMinOffsetFromCollectionGroup(e,t){return rZ.resolve(rQ.min())}updateCollectionGroup(e,t,r){return rZ.resolve()}updateIndexEntries(e,t){return rZ.resolve()}}class ow{constructor(){this.index={}}add(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t]||new il(rR.comparator),n=!i.has(r);return this.index[t]=i.add(r),n}has(e){let t=e.lastSegment(),r=e.popLast(),i=this.index[t];return i&&i.has(r)}getEntries(e){return(this.index[e]||new il(rR.comparator)).toArray()}}new Uint8Array(0);let oR=2;class ok{constructor(e){this.lastId=e}next(){return this.lastId+=oR,this.lastId}static forTargetCache(){return new ok(2-oR)}static forSyncEngine(){return new ok(1-oR)}}let oA={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},oI=-1,oO=0x2800000;class oN{static withCacheSize(e){return new oN(e,oN.DEFAULT_COLLECTION_PERCENTILE,oN.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=r}}oN.DEFAULT_COLLECTION_PERCENTILE=10,oN.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,oN.DEFAULT=new oN(oO,oN.DEFAULT_COLLECTION_PERCENTILE,oN.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),oN.DISABLED=new oN(oI,0,0);let ox="LruGarbageCollector",oD=1048576,oP=6e4,oM=3e5;function oL([e,t],[r,i]){let n=rv(e,r);return 0===n?rv(t,i):n}class oF{constructor(e){this.maxElements=e,this.buffer=new il(oL),this.previousIndex=0}nextIndex(){return++this.previousIndex}addElement(e){let t=[e,this.nextIndex()];if(this.buffer.size<this.maxElements)this.buffer=this.buffer.add(t);else{let e=this.buffer.last();0>oL(t,e)&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class oB{constructor(e,t,r){this.garbageCollector=e,this.asyncQueue=t,this.localStore=r,this.gcTask=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==oI&&this.scheduleGC(oP)}stop(){this.gcTask&&(this.gcTask.cancel(),this.gcTask=null)}get started(){return null!==this.gcTask}scheduleGC(e){t$(ox,`Garbage collection scheduled in ${e}ms`),this.gcTask=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.gcTask=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){r1(e)?t$(ox,"Ignoring IndexedDB error during garbage collection: ",e):await rX(e)}await this.scheduleGC(oM)})}}class oj{constructor(e,t){this.delegate=e,this.params=t}calculateTargetCount(e,t){return this.delegate.getSequenceNumberCount(e).next(e=>Math.floor(t/100*e))}nthSequenceNumber(e,t){if(0===t)return rZ.resolve(r2.INVALID);let r=new oF(t);return this.delegate.forEachTarget(e,e=>r.addElement(e.sequenceNumber)).next(()=>this.delegate.forEachOrphanedDocumentSequenceNumber(e,e=>r.addElement(e))).next(()=>r.maxValue)}removeTargets(e,t,r){return this.delegate.removeTargets(e,t,r)}removeOrphanedDocuments(e,t){return this.delegate.removeOrphanedDocuments(e,t)}collect(e,t){return this.params.cacheSizeCollectionThreshold===oI?(t$("LruGarbageCollector","Garbage collection skipped; disabled"),rZ.resolve(oA)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(t$("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),oA):this.runGarbageCollection(e,t))}getCacheSize(e){return this.delegate.getCacheSize(e)}runGarbageCollection(e,t){let r,n,s,a,o,l,c,u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(t=>(t>this.params.maximumSequenceNumbersToCollect?(t$("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),n=this.params.maximumSequenceNumbersToCollect):n=t,a=Date.now(),this.nthSequenceNumber(e,n))).next(i=>(r=i,o=Date.now(),this.removeTargets(e,r,t))).next(t=>(s=t,l=Date.now(),this.removeOrphanedDocuments(e,r))).next(e=>(c=Date.now(),tq()<=i.DEBUG&&t$("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${a-u}ms
	Determined least recently used ${n} in ${o-a}ms
	Removed ${s} targets in ${l-o}ms
	Removed ${e} documents in ${c-l}ms
Total Duration: ${c-u}ms`),rZ.resolve({didRun:!0,sequenceNumbersCollected:n,targetsRemoved:s,documentsRemoved:e})))}}function oU(e,t){return new oj(e,t)}class oV{constructor(){this.changes=new sf(e=>e.toString(),(e,t)=>e.isEqual(t)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,nv.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();let r=this.changes.get(t);return void 0!==r?rZ.resolve(r):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class oz{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class oq{constructor(e,t,r,i){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=r,this.indexManager=i}getDocument(e,t){let r=null;return this.documentOverlayCache.getOverlay(e,t).next(i=>(r=i,this.remoteDocumentCache.getEntry(e,t))).next(e=>(null!==r&&s1(r.mutation,e,iu.empty(),rz.now()),e))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.getLocalViewOfDocuments(e,t,sR()).next(()=>t))}getLocalViewOfDocuments(e,t,r=sR()){let i=sS();return this.populateOverlays(e,i,t).next(()=>this.computeViews(e,t,i,r).next(e=>{let t=sy();return e.forEach((e,r)=>{t=t.insert(e,r.overlayedDocument)}),t}))}getOverlayedDocuments(e,t){let r=sS();return this.populateOverlays(e,r,t).next(()=>this.computeViews(e,t,r,sR()))}populateOverlays(e,t,r){let i=[];return r.forEach(e=>{t.has(e)||i.push(e)}),this.documentOverlayCache.getOverlays(e,i).next(e=>{e.forEach((e,r)=>{t.set(e,r)})})}computeViews(e,t,r,i){let n=sm(),s=sT(),a=sv();return t.forEach((e,t)=>{let a=r.get(t.key);i.has(t.key)&&(void 0===a||a.mutation instanceof s7)?n=n.insert(t.key,t):void 0!==a?(s.set(t.key,a.mutation.getFieldMask()),s1(a.mutation,t,a.mutation.getFieldMask(),rz.now())):s.set(t.key,iu.empty())}),this.recalculateAndSaveOverlays(e,n).next(e=>(e.forEach((e,t)=>s.set(e,t)),t.forEach((e,t)=>a.set(e,new oz(t,s.get(e)??null))),a))}recalculateAndSaveOverlays(e,t){let r=sT(),i=new ii((e,t)=>e-t),n=sR();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next(e=>{for(let n of e)n.keys().forEach(e=>{let s=t.get(e);if(null===s)return;let a=r.get(e)||iu.empty();a=n.applyToLocalView(s,a),r.set(e,a);let o=(i.get(n.batchId)||sR()).add(e);i=i.insert(n.batchId,o)})}).next(()=>{let s=[],a=i.getReverseIterator();for(;a.hasNext();){let i=a.getNext(),o=i.key,l=i.value,c=sC();l.forEach(e=>{if(!n.has(e)){let i=sZ(t.get(e),r.get(e));null!==i&&c.set(e,i),n=n.add(e)}}),s.push(this.documentOverlayCache.saveOverlays(e,o,c))}return rZ.waitFor(s)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next(t=>this.recalculateAndSaveOverlays(e,t))}getDocumentsMatchingQuery(e,t,r,i){return n7(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):n8(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,r,i):this.getDocumentsMatchingCollectionQuery(e,t,r,i)}getNextDocuments(e,t,r,i){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,r,i).next(n=>{let s=i-n.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,r.largestBatchId,i-n.size):rZ.resolve(sS()),a=r$,o=n;return s.next(t=>rZ.forEach(t,(t,r)=>(a<r.largestBatchId&&(a=r.largestBatchId),n.get(t))?rZ.resolve():this.remoteDocumentCache.getEntry(e,t).next(e=>{o=o.insert(t,e)})).next(()=>this.populateOverlays(e,t,n)).next(()=>this.computeViews(e,o,t,sR())).next(e=>({batchId:a,changes:sb(e)})))})}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new rI(t)).next(e=>{let t=sy();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t})}getDocumentsMatchingCollectionGroupQuery(e,t,r,i){let n=t.collectionGroup,s=sy();return this.indexManager.getCollectionParents(e,n).next(a=>rZ.forEach(a,a=>{let o=n6(t,a.child(n));return this.getDocumentsMatchingCollectionQuery(e,o,r,i).next(e=>{e.forEach((e,t)=>{s=s.insert(e,t)})})}).next(()=>s))}getDocumentsMatchingCollectionQuery(e,t,r,i){let n;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,r.largestBatchId).next(s=>(n=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,r,n,i))).next(e=>{n.forEach((t,r)=>{let i=r.getKey();null===e.get(i)&&(e=e.insert(i,nv.newInvalidDocument(i)))});let r=sy();return e.forEach((e,i)=>{let s=n.get(e);void 0!==s&&s1(s.mutation,i,iu.empty(),rz.now()),sa(t,i)&&(r=r.insert(e,i))}),r})}}class o${constructor(e){this.serializer=e,this.bundles=new Map,this.namedQueries=new Map}getBundleMetadata(e,t){return rZ.resolve(this.bundles.get(t))}saveBundleMetadata(e,t){return this.bundles.set(t.id,ol(t)),rZ.resolve()}getNamedQuery(e,t){return rZ.resolve(this.namedQueries.get(t))}saveNamedQuery(e,t){return this.namedQueries.set(t.name,oo(t)),rZ.resolve()}}class oH{constructor(){this.overlays=new ii(rI.comparator),this.overlayByBatchId=new Map}getOverlay(e,t){return rZ.resolve(this.overlays.get(t))}getOverlays(e,t){let r=sS();return rZ.forEach(t,t=>this.getOverlay(e,t).next(e=>{null!==e&&r.set(t,e)})).next(()=>r)}saveOverlays(e,t,r){return r.forEach((r,i)=>{this.saveOverlay(e,t,i)}),rZ.resolve()}removeOverlaysForBatchId(e,t,r){let i=this.overlayByBatchId.get(r);return void 0!==i&&(i.forEach(e=>this.overlays=this.overlays.remove(e)),this.overlayByBatchId.delete(r)),rZ.resolve()}getOverlaysForCollection(e,t,r){let i=sS(),n=t.length+1,s=new rI(t.child("")),a=this.overlays.getIteratorFrom(s);for(;a.hasNext();){let e=a.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===n&&e.largestBatchId>r&&i.set(e.getKey(),e)}return rZ.resolve(i)}getOverlaysForCollectionGroup(e,t,r,i){let n=new ii((e,t)=>e-t),s=this.overlays.getIterator();for(;s.hasNext();){let e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>r){let t=n.get(e.largestBatchId);null===t&&(t=sS(),n=n.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}let a=sS(),o=n.getIterator();for(;o.hasNext()&&(o.getNext().value.forEach((e,t)=>a.set(e,t)),!(a.size()>=i)););return rZ.resolve(a)}saveOverlay(e,t,r){let i=this.overlays.get(r.key);if(null!==i){let e=this.overlayByBatchId.get(i.largestBatchId).delete(r.key);this.overlayByBatchId.set(i.largestBatchId,e)}this.overlays=this.overlays.insert(r.key,new ac(t,r));let n=this.overlayByBatchId.get(t);void 0===n&&(n=sR(),this.overlayByBatchId.set(t,n)),this.overlayByBatchId.set(t,n.add(r.key))}}class oW{constructor(){this.sessionToken=ip.EMPTY_BYTE_STRING}getSessionToken(e){return rZ.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,rZ.resolve()}}class oG{constructor(){this.refsByKey=new il(oQ.compareByKey),this.refsByTarget=new il(oQ.compareByTargetId)}isEmpty(){return this.refsByKey.isEmpty()}addReference(e,t){let r=new oQ(e,t);this.refsByKey=this.refsByKey.add(r),this.refsByTarget=this.refsByTarget.add(r)}addReferences(e,t){e.forEach(e=>this.addReference(e,t))}removeReference(e,t){this.removeRef(new oQ(e,t))}removeReferences(e,t){e.forEach(e=>this.removeReference(e,t))}removeReferencesForId(e){let t=new rI(new rR([])),r=new oQ(t,e),i=new oQ(t,e+1),n=[];return this.refsByTarget.forEachInRange([r,i],e=>{this.removeRef(e),n.push(e.key)}),n}removeAllReferences(){this.refsByKey.forEach(e=>this.removeRef(e))}removeRef(e){this.refsByKey=this.refsByKey.delete(e),this.refsByTarget=this.refsByTarget.delete(e)}referencesForId(e){let t=new rI(new rR([])),r=new oQ(t,e),i=new oQ(t,e+1),n=sR();return this.refsByTarget.forEachInRange([r,i],e=>{n=n.add(e.key)}),n}containsKey(e){let t=new oQ(e,0),r=this.refsByKey.firstAfterOrEqual(t);return null!==r&&e.isEqual(r.key)}}class oQ{constructor(e,t){this.key=e,this.targetOrBatchId=t}static compareByKey(e,t){return rI.comparator(e.key,t.key)||rv(e.targetOrBatchId,t.targetOrBatchId)}static compareByTargetId(e,t){return rv(e.targetOrBatchId,t.targetOrBatchId)||rI.comparator(e.key,t.key)}}class oK{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.nextBatchId=1,this.batchesByDocumentKey=new il(oQ.compareByKey)}checkEmpty(e){return rZ.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,r,i){let n=this.nextBatchId;this.nextBatchId++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let s=new ao(n,t,r,i);for(let t of(this.mutationQueue.push(s),i))this.batchesByDocumentKey=this.batchesByDocumentKey.add(new oQ(t.key,n)),this.indexManager.addToCollectionParentIndex(e,t.key.path.popLast());return rZ.resolve(s)}lookupMutationBatch(e,t){return rZ.resolve(this.findMutationBatch(t))}getNextMutationBatchAfterBatchId(e,t){let r=t+1,i=this.indexOfBatchId(r),n=i<0?0:i;return rZ.resolve(this.mutationQueue.length>n?this.mutationQueue[n]:null)}getHighestUnacknowledgedBatchId(){return rZ.resolve(0===this.mutationQueue.length?iD:this.nextBatchId-1)}getAllMutationBatches(e){return rZ.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){let r=new oQ(t,0),i=new oQ(t,1/0),n=[];return this.batchesByDocumentKey.forEachInRange([r,i],e=>{let t=this.findMutationBatch(e.targetOrBatchId);n.push(t)}),rZ.resolve(n)}getAllMutationBatchesAffectingDocumentKeys(e,t){let r=new il(rv);return t.forEach(e=>{let t=new oQ(e,0),i=new oQ(e,1/0);this.batchesByDocumentKey.forEachInRange([t,i],e=>{r=r.add(e.targetOrBatchId)})}),rZ.resolve(this.findMutationBatches(r))}getAllMutationBatchesAffectingQuery(e,t){let r=t.path,i=r.length+1,n=r;rI.isDocumentKey(n)||(n=n.child(""));let s=new oQ(new rI(n),0),a=new il(rv);return this.batchesByDocumentKey.forEachWhile(e=>{let t=e.key.path;return!!r.isPrefixOf(t)&&(t.length===i&&(a=a.add(e.targetOrBatchId)),!0)},s),rZ.resolve(this.findMutationBatches(a))}findMutationBatches(e){let t=[];return e.forEach(e=>{let r=this.findMutationBatch(e);null!==r&&t.push(r)}),t}removeMutationBatch(e,t){tJ(0===this.indexOfExistingBatchId(t.batchId,"removed"),55003),this.mutationQueue.shift();let r=this.batchesByDocumentKey;return rZ.forEach(t.mutations,i=>{let n=new oQ(i.key,t.batchId);return r=r.delete(n),this.referenceDelegate.markPotentiallyOrphaned(e,i.key)}).next(()=>{this.batchesByDocumentKey=r})}removeCachedMutationKeys(e){}containsKey(e,t){let r=new oQ(t,0),i=this.batchesByDocumentKey.firstAfterOrEqual(r);return rZ.resolve(t.isEqual(i&&i.key))}performConsistencyCheck(e){return this.mutationQueue.length,rZ.resolve()}indexOfExistingBatchId(e,t){return this.indexOfBatchId(e)}indexOfBatchId(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}findMutationBatch(e){let t=this.indexOfBatchId(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}let oJ="-9223372036854775808";function oY(){return new ii(rI.comparator)}class oX{constructor(e){this.sizer=e,this.docs=oY(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){let r=t.key,i=this.docs.get(r),n=i?i.size:0,s=this.sizer(t);return this.docs=this.docs.insert(r,{document:t.mutableCopy(),size:s}),this.size+=s-n,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){let t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){let r=this.docs.get(t);return rZ.resolve(r?r.document.mutableCopy():nv.newInvalidDocument(t))}getEntries(e,t){let r=sm();return t.forEach(e=>{let t=this.docs.get(e);r=r.insert(e,t?t.document.mutableCopy():nv.newInvalidDocument(e))}),rZ.resolve(r)}getDocumentsMatchingQuery(e,t,r,i){let n=sm(),s=t.path,a=new rI(s.child("__id"+oJ+"__")),o=this.docs.getIteratorFrom(a);for(;o.hasNext();){let{key:e,value:{document:a}}=o.getNext();if(!s.isPrefixOf(e.path))break;!(e.path.length>s.length+1||0>=rK(rG(a),r))&&(i.has(a.key)||sa(t,a))&&(n=n.insert(a.key,a.mutableCopy()))}return rZ.resolve(n)}getAllFromCollectionGroup(e,t,r,i){tQ(9500)}forEachDocumentKey(e,t){return rZ.forEach(this.docs,e=>t(e))}newChangeBuffer(e){return new o0(this)}getSize(e){return rZ.resolve(this.size)}}function oZ(e){return new oX(e)}class o0 extends oV{constructor(e){super(),this.documentCache=e}applyChanges(e){let t=[];return this.changes.forEach((r,i)=>{i.isValidDocument()?t.push(this.documentCache.addEntry(e,i)):this.documentCache.removeEntry(r)}),rZ.waitFor(t)}getFromCache(e,t){return this.documentCache.getEntry(e,t)}getAllFromCache(e,t){return this.documentCache.getEntries(e,t)}}class o1{constructor(e){this.persistence=e,this.targets=new sf(e=>nX(e),n0),this.lastRemoteSnapshotVersion=rq.min(),this.highestTargetId=0,this.highestSequenceNumber=0,this.references=new oG,this.targetCount=0,this.targetIdGenerator=ok.forTargetCache()}forEachTarget(e,t){return this.targets.forEach((e,r)=>t(r)),rZ.resolve()}getLastRemoteSnapshotVersion(e){return rZ.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return rZ.resolve(this.highestSequenceNumber)}allocateTargetId(e){return this.highestTargetId=this.targetIdGenerator.next(),rZ.resolve(this.highestTargetId)}setTargetsMetadata(e,t,r){return r&&(this.lastRemoteSnapshotVersion=r),t>this.highestSequenceNumber&&(this.highestSequenceNumber=t),rZ.resolve()}saveTargetData(e){this.targets.set(e.target,e);let t=e.targetId;t>this.highestTargetId&&(this.targetIdGenerator=new ok(t),this.highestTargetId=t),e.sequenceNumber>this.highestSequenceNumber&&(this.highestSequenceNumber=e.sequenceNumber)}addTargetData(e,t){return this.saveTargetData(t),this.targetCount+=1,rZ.resolve()}updateTargetData(e,t){return this.saveTargetData(t),rZ.resolve()}removeTargetData(e,t){return this.targets.delete(t.target),this.references.removeReferencesForId(t.targetId),this.targetCount-=1,rZ.resolve()}removeTargets(e,t,r){let i=0,n=[];return this.targets.forEach((s,a)=>{a.sequenceNumber<=t&&null===r.get(a.targetId)&&(this.targets.delete(s),n.push(this.removeMatchingKeysForTargetId(e,a.targetId)),i++)}),rZ.waitFor(n).next(()=>i)}getTargetCount(e){return rZ.resolve(this.targetCount)}getTargetData(e,t){let r=this.targets.get(t)||null;return rZ.resolve(r)}addMatchingKeys(e,t,r){return this.references.addReferences(t,r),rZ.resolve()}removeMatchingKeys(e,t,r){this.references.removeReferences(t,r);let i=this.persistence.referenceDelegate,n=[];return i&&t.forEach(t=>{n.push(i.markPotentiallyOrphaned(e,t))}),rZ.waitFor(n)}removeMatchingKeysForTargetId(e,t){return this.references.removeReferencesForId(t),rZ.resolve()}getMatchingKeysForTargetId(e,t){let r=this.references.referencesForId(t);return rZ.resolve(r)}containsKey(e,t){return rZ.resolve(this.references.containsKey(t))}}let o2="MemoryPersistence";class o3{constructor(e,t){this.mutationQueues={},this.overlays={},this.listenSequence=new r2(0),this._started=!1,this._started=!0,this.globalsCache=new oW,this.referenceDelegate=e(this),this.targetCache=new o1(this);const r=e=>this.referenceDelegate.documentSize(e);this.indexManager=new o_,this.remoteDocumentCache=oZ(r),this.serializer=new os(t),this.bundleCache=new o$(this.serializer)}start(){return Promise.resolve()}shutdown(){return this._started=!1,Promise.resolve()}get started(){return this._started}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new oH,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let r=this.mutationQueues[e.toKey()];return r||(r=new oK(t,this.referenceDelegate),this.mutationQueues[e.toKey()]=r),r}getGlobalsCache(){return this.globalsCache}getTargetCache(){return this.targetCache}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.bundleCache}runTransaction(e,t,r){t$(o2,"Starting transaction:",e);let i=new o6(this.listenSequence.next());return this.referenceDelegate.onTransactionStarted(),r(i).next(e=>this.referenceDelegate.onTransactionCommitted(i).next(()=>e)).toPromise().then(e=>(i.raiseOnCommittedEvent(),e))}mutationQueuesContainKey(e,t){return rZ.or(Object.values(this.mutationQueues).map(r=>()=>r.containsKey(e,t)))}}class o6 extends rY{constructor(e){super(),this.currentSequenceNumber=e}}class o4{constructor(e){this.persistence=e,this.localViewReferences=new oG,this._orphanedDocuments=null}static factory(e){return new o4(e)}get orphanedDocuments(){if(this._orphanedDocuments)return this._orphanedDocuments;throw tQ(60996)}addReference(e,t,r){return this.localViewReferences.addReference(r,t),this.orphanedDocuments.delete(r.toString()),rZ.resolve()}removeReference(e,t,r){return this.localViewReferences.removeReference(r,t),this.orphanedDocuments.add(r.toString()),rZ.resolve()}markPotentiallyOrphaned(e,t){return this.orphanedDocuments.add(t.toString()),rZ.resolve()}removeTarget(e,t){this.localViewReferences.removeReferencesForId(t.targetId).forEach(e=>this.orphanedDocuments.add(e.toString()));let r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,t.targetId).next(e=>{e.forEach(e=>this.orphanedDocuments.add(e.toString()))}).next(()=>r.removeTargetData(e,t))}onTransactionStarted(){this._orphanedDocuments=new Set}onTransactionCommitted(e){let t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return rZ.forEach(this.orphanedDocuments,r=>{let i=rI.fromPath(r);return this.isReferenced(e,i).next(e=>{e||t.removeEntry(i,rq.min())})}).next(()=>(this._orphanedDocuments=null,t.apply(e)))}updateLimboDocument(e,t){return this.isReferenced(e,t).next(e=>{e?this.orphanedDocuments.delete(t.toString()):this.orphanedDocuments.add(t.toString())})}documentSize(e){return 0}isReferenced(e,t){return rZ.or([()=>rZ.resolve(this.localViewReferences.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.mutationQueuesContainKey(e,t)])}}class o5{constructor(e,t){this.persistence=e,this.orphanedSequenceNumbers=new sf(e=>r7(e.path),(e,t)=>e.isEqual(t)),this.garbageCollector=oU(this,t)}static factory(e,t){return new o5(e,t)}onTransactionStarted(){}onTransactionCommitted(e){return rZ.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}getSequenceNumberCount(e){let t=this.orphanedDocumentCount(e);return this.persistence.getTargetCache().getTargetCount(e).next(e=>t.next(t=>e+t))}orphanedDocumentCount(e){let t=0;return this.forEachOrphanedDocumentSequenceNumber(e,e=>{t++}).next(()=>t)}forEachOrphanedDocumentSequenceNumber(e,t){return rZ.forEach(this.orphanedSequenceNumbers,(r,i)=>this.isPinned(e,r,i).next(e=>e?rZ.resolve():t(i)))}removeTargets(e,t,r){return this.persistence.getTargetCache().removeTargets(e,t,r)}removeOrphanedDocuments(e,t){let r=0,i=this.persistence.getRemoteDocumentCache(),n=i.newChangeBuffer();return i.forEachDocumentKey(e,i=>this.isPinned(e,i,t).next(e=>{e||(r++,n.removeEntry(i,rq.min()))})).next(()=>n.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,t){return this.orphanedSequenceNumbers.set(t,e.currentSequenceNumber),rZ.resolve()}removeTarget(e,t){let r=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,t,r){return this.orphanedSequenceNumbers.set(r,e.currentSequenceNumber),rZ.resolve()}removeReference(e,t,r){return this.orphanedSequenceNumbers.set(r,e.currentSequenceNumber),rZ.resolve()}updateLimboDocument(e,t){return this.orphanedSequenceNumbers.set(t,e.currentSequenceNumber),rZ.resolve()}documentSize(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=ni(e.data.value)),t}isPinned(e,t,r){return rZ.or([()=>this.persistence.mutationQueuesContainKey(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{let e=this.orphanedSequenceNumbers.get(t);return rZ.resolve(void 0!==e&&e>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}function o7(e,t){if(e.length!==t.length)return!1;for(let r=0;r<e.length;++r)if(e[r]!==t[r])return!1;return!0}let o8="LocalStore";class o9{constructor(e,t,r,i){this.persistence=e,this.queryEngine=t,this.serializer=i,this.targetDataByTarget=new ii(rv),this.targetIdByTarget=new sf(e=>nX(e),n0),this.collectionGroupReadTime=new Map,this.remoteDocuments=e.getRemoteDocumentCache(),this.targetCache=e.getTargetCache(),this.bundleCache=e.getBundleCache(),this.initializeUserComponents(r)}initializeUserComponents(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new oq(this.remoteDocuments,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.remoteDocuments.setIndexManager(this.indexManager),this.queryEngine.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",t=>e.collect(t,this.targetDataByTarget))}}function le(e,t,r,i){return new o9(e,t,r,i)}async function lt(e,t){let r=tY(e);return await r.persistence.runTransaction("Handle user change","readonly",e=>{let i;return r.mutationQueue.getAllMutationBatches(e).next(n=>(i=n,r.initializeUserComponents(t),r.mutationQueue.getAllMutationBatches(e))).next(t=>{let n=[],s=[],a=sR();for(let e of i)for(let t of(n.push(e.batchId),e.mutations))a=a.add(t.key);for(let e of t)for(let t of(s.push(e.batchId),e.mutations))a=a.add(t.key);return r.localDocuments.getDocuments(e,a).next(e=>({affectedDocuments:e,removedBatchIds:n,addedBatchIds:s}))})})}function lr(e,t){let r,i,n=tY(e),s=rz.now(),a=t.reduce((e,t)=>e.add(t.key),sR());return n.persistence.runTransaction("Locally write mutations","readwrite",e=>{let o=sm(),l=sR();return n.remoteDocuments.getEntries(e,a).next(e=>{(o=e).forEach((e,t)=>{t.isValidDocument()||(l=l.add(e))})}).next(()=>n.localDocuments.getOverlayedDocuments(e,o)).next(i=>{r=i;let a=[];for(let e of t){let t=s2(e,r.get(e.key).overlayedDocument);null!=t&&a.push(new s7(e.key,t,ny(t.value.mapValue),sJ.exists(!0)))}return n.mutationQueue.addMutationBatch(e,s,a,t)}).next(t=>{i=t;let s=t.applyToLocalDocumentSet(r,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,s)})}).then(()=>({batchId:i.batchId,changes:sb(r)}))}function li(e,t){let r=tY(e);return r.persistence.runTransaction("Acknowledge batch","readwrite-primary",e=>{let i=t.batch.keys(),n=r.remoteDocuments.newChangeBuffer({trackRemovals:!0});return lc(r,e,t,n).next(()=>n.apply(e)).next(()=>r.mutationQueue.performConsistencyCheck(e)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(e,i,t.batch.batchId)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,ln(t))).next(()=>r.localDocuments.getDocuments(e,i))})}function ln(e){let t=sR();for(let r=0;r<e.mutationResults.length;++r)e.mutationResults[r].transformResults.length>0&&(t=t.add(e.batch.mutations[r].key));return t}function ls(e,t){let r=tY(e);return r.persistence.runTransaction("Reject batch","readwrite-primary",e=>{let i;return r.mutationQueue.lookupMutationBatch(e,t).next(t=>(tJ(null!==t,37113),i=t.keys(),r.mutationQueue.removeMutationBatch(e,t))).next(()=>r.mutationQueue.performConsistencyCheck(e)).next(()=>r.documentOverlayCache.removeOverlaysForBatchId(e,i,t)).next(()=>r.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,i)).next(()=>r.localDocuments.getDocuments(e,i))})}function la(e){let t=tY(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.targetCache.getLastRemoteSnapshotVersion(e))}async function lo(e,t){let r=tY(e);try{await r.persistence.runTransaction("notifyLocalViewChanges","readwrite",e=>rZ.forEach(t,t=>rZ.forEach(t.addedKeys,i=>r.persistence.referenceDelegate.addReference(e,t.targetId,i)).next(()=>rZ.forEach(t.removedKeys,i=>r.persistence.referenceDelegate.removeReference(e,t.targetId,i)))))}catch(e){if(r1(e))t$(o8,"Failed to update sequence numbers: "+e);else throw e}for(let e of t){let t=e.targetId;if(!e.fromCache){let e=r.targetDataByTarget.get(t),i=e.snapshotVersion,n=e.withLastLimboFreeSnapshotVersion(i);r.targetDataByTarget=r.targetDataByTarget.insert(t,n)}}}function ll(e,t){let r=tY(e);return r.persistence.runTransaction("Get next mutation batch","readonly",e=>(void 0===t&&(t=iD),r.mutationQueue.getNextMutationBatchAfterBatchId(e,t)))}function lc(e,t,r,i){let n=r.batch,s=n.keys(),a=rZ.resolve();return s.forEach(e=>{a=a.next(()=>i.getEntry(t,e)).next(t=>{let s=r.docVersions.get(e);tJ(null!==s,48541),0>t.version.compareTo(s)&&(n.applyToRemoteDocument(t,r),t.isValidDocument()&&(t.setReadTime(r.commitVersion),i.addEntry(t)))})}),a.next(()=>e.mutationQueue.removeMutationBatch(t,n))}class lu{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}let lh=100;function ld(){return Z()?8:r0(K())>0?6:4}class lf{constructor(){this.initialized=!1,this.indexAutoCreationEnabled=!1,this.indexAutoCreationMinCollectionSize=lh,this.relativeIndexReadCostPerDocument=ld()}initialize(e,t){this.localDocumentsView=e,this.indexManager=t,this.initialized=!0}getDocumentsMatchingQuery(e,t,r,i){let n={result:null};return this.performQueryUsingIndex(e,t).next(e=>{n.result=e}).next(()=>{if(!n.result)return this.performQueryUsingRemoteKeys(e,t,i,r).next(e=>{n.result=e})}).next(()=>{if(n.result)return;let r=new lu;return this.executeFullCollectionScan(e,t,r).next(i=>{if(n.result=i,this.indexAutoCreationEnabled)return this.createCacheIndexes(e,t,r,i.size)})}).next(()=>n.result)}createCacheIndexes(e,t,r,n){return r.documentReadCount<this.indexAutoCreationMinCollectionSize?(tq()<=i.DEBUG&&t$("QueryEngine","SDK will not create cache indexes for query:",ss(t),"since it only creates cache indexes for collection contains","more than or equal to",this.indexAutoCreationMinCollectionSize,"documents"),rZ.resolve()):(tq()<=i.DEBUG&&t$("QueryEngine","Query:",ss(t),"scans",r.documentReadCount,"local documents and returns",n,"documents as results."),r.documentReadCount>this.relativeIndexReadCostPerDocument*n)?(tq()<=i.DEBUG&&t$("QueryEngine","The SDK decides to create cache indexes for query:",ss(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,se(t))):rZ.resolve()}performQueryUsingIndex(e,t){if(n4(t))return rZ.resolve(null);let r=se(t);return this.indexManager.getIndexType(e,r).next(i=>0===i?null:(null!==t.limit&&1===i&&(r=se(t=sr(t,null,"F"))),this.indexManager.getDocumentsMatchingTarget(e,r).next(i=>{let n=sR(...i);return this.localDocumentsView.getDocuments(e,n).next(i=>this.indexManager.getMinOffset(e,r).next(r=>{let s=this.applyQuery(t,i);return this.needsRefill(t,s,n,r.readTime)?this.performQueryUsingIndex(e,sr(t,null,"F")):this.appendRemainingResults(e,s,t,r)}))})))}performQueryUsingRemoteKeys(e,t,r,n){return n4(t)||n.isEqual(rq.min())?rZ.resolve(null):this.localDocumentsView.getDocuments(e,r).next(s=>{let a=this.applyQuery(t,s);return this.needsRefill(t,a,r,n)?rZ.resolve(null):(tq()<=i.DEBUG&&t$("QueryEngine","Re-using previous result from %s to execute query: %s",n.toString(),ss(t)),this.appendRemainingResults(e,a,t,rW(n,r$)).next(e=>e))})}applyQuery(e,t){let r=new il(sh(e));return t.forEach((t,i)=>{sa(e,i)&&(r=r.add(i))}),r}needsRefill(e,t,r,i){if(null===e.limit)return!1;if(r.size!==t.size)return!0;let n="F"===e.limitType?t.last():t.first();return!!n&&(n.hasPendingWrites||n.version.compareTo(i)>0)}executeFullCollectionScan(e,t,r){return tq()<=i.DEBUG&&t$("QueryEngine","Using full collection scan to execute query:",ss(t)),this.localDocumentsView.getDocumentsMatchingQuery(e,t,rQ.min(),r)}appendRemainingResults(e,t,r,i){return this.localDocumentsView.getDocumentsMatchingQuery(e,r,i).next(e=>(t.forEach(t=>{e=e.insert(t.key,t)}),e))}}class lp{constructor(){this.activeTargetIds=sA()}addQueryTarget(e){this.activeTargetIds=this.activeTargetIds.add(e)}removeQueryTarget(e){this.activeTargetIds=this.activeTargetIds.delete(e)}toWebStorageJSON(){return JSON.stringify({activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()})}}class lm{constructor(){this.localState=new lp,this.queryState={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,r){}addLocalQueryTarget(e,t=!0){return t&&this.localState.addQueryTarget(e),this.queryState[e]||"not-current"}updateQueryState(e,t,r){this.queryState[e]=t}removeLocalQueryTarget(e){this.localState.removeQueryTarget(e)}isLocalQueryTarget(e){return this.localState.activeTargetIds.has(e)}clearQueryState(e){delete this.queryState[e]}getAllActiveQueryTargets(){return this.localState.activeTargetIds}isActiveQueryTarget(e){return this.localState.activeTargetIds.has(e)}start(){return this.localState=new lp,Promise.resolve()}handleUserChange(e,t,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class lg{addCallback(e){}shutdown(){}}class ly{constructor(e){this.sendFn=e.sendFn,this.closeFn=e.closeFn}onConnected(e){this.wrappedOnConnected=e}onOpen(e){this.wrappedOnOpen=e}onClose(e){this.wrappedOnClose=e}onMessage(e){this.wrappedOnMessage=e}close(){this.closeFn()}send(e){this.sendFn(e)}callOnConnected(){this.wrappedOnConnected()}callOnOpen(){this.wrappedOnOpen()}callOnClose(e){this.wrappedOnClose(e)}callOnMessage(e){this.wrappedOnMessage(e)}}let lv=null;function lb(){return 0x10000000+Math.round(0x80000000*Math.random())}function lS(){return null===lv?lv=lb():lv++,"0x"+lv.toString(16)}function lC(e){return new Promise((t,r)=>{e((e,i)=>{e?r(e):t(i)})})}let lT="1.9.15",lE="GrpcConnection",l_=`gl-node/${process.versions.node} fire/${tj} grpc/${lT}`;function lw(e,t,r,i){tJ(null===t||"OAuth"===t.type,36936);let n=new tP.Metadata;return t&&t.headers.forEach((e,t)=>n.set(t,e)),r&&r.headers.forEach((e,t)=>n.set(t,e)),i&&n.set("X-Firebase-GMPID",i),n.set("X-Goog-Api-Client",l_),n.set("Google-Cloud-Resource-Prefix",e),n.set("x-goog-request-params",e),n}class lR{get shouldResourcePathBeIncludedInRequest(){return!0}constructor(e,t){this.databaseInfo=t,this.cachedStub=null,this.firestore=e.google.firestore.v1,this.databasePath=`projects/${t.databaseId.projectId}/databases/${t.databaseId.database}`}ensureActiveStub(){if(!this.cachedStub){t$(lE,"Creating Firestore stub.");let e=this.databaseInfo.ssl?tP.credentials.createSsl():tP.credentials.createInsecure();this.cachedStub=new this.firestore.Firestore(this.databaseInfo.host,e)}return this.cachedStub}invokeRPC(e,t,r,i,n){let s=lS(),a=this.ensureActiveStub(),o=lw(this.databasePath,i,n,this.databaseInfo.appId),l={database:this.databasePath,...r};return lC(t=>(t$(lE,`RPC '${e}' ${s} invoked with request:`,r),a[e](l,o,(r,i)=>{r?(t$(lE,`RPC '${e}' ${s} failed with error:`,r),t(new rs(ad(r.code),r.message))):(t$(lE,`RPC '${e}' ${s} completed with response:`,i),t(void 0,i))})))}invokeStreamingRPC(e,t,r,i,n,s){let a=lS(),o=[],l=new ra;t$(lE,`RPC '${e}' ${a} invoked (streaming) with request:`,r);let c=this.ensureActiveStub(),u=lw(this.databasePath,i,n,this.databaseInfo.appId),h={...r,database:this.databasePath},d=c[e](h,u),f=!1;return d.on("data",t=>{t$(lE,`RPC ${e} ${a} received result:`,t),o.push(t),void 0!==s&&o.length===s&&(f=!0,l.resolve(o))}),d.on("end",()=>{t$(lE,`RPC '${e}' ${a} completed.`),f||(f=!0,l.resolve(o))}),d.on("error",t=>{t$(lE,`RPC '${e}' ${a} failed with error:`,t);let r=ad(t.code);l.reject(new rs(r,t.message))}),l.promise}openStream(e,t,r){let i=lS(),n=this.ensureActiveStub(),s=lw(this.databasePath,t,r,this.databaseInfo.appId),a=n[e](s),o=!1,l=e=>{o||(o=!0,c.callOnClose(e),a.end())},c=new ly({sendFn:t=>{if(o)t$(lE,`RPC '${e}' stream ${i} not sending because gRPC stream is closed:`,t);else{t$(lE,`RPC '${e}' stream ${i} sending:`,t);try{a.write(t)}catch(e){throw tH("Failure sending:",t),tH("Error:",e),e}}},closeFn:()=>{t$(lE,`RPC '${e}' stream ${i} closed locally via close().`),l()}}),u=!1;return a.on("data",t=>{o||(t$(lE,`RPC '${e}' stream ${i} received:`,t),u||(c.callOnConnected(),u=!0),c.callOnMessage(t))}),a.on("end",()=>{t$(lE,`RPC '${e}' stream ${i} ended.`),l()}),a.on("error",t=>{o||(tW(lE,`RPC '${e}' stream ${i} error. Code:`,t.code,"Message:",t.message),l(new rs(ad(t.code),t.message)))}),t$(lE,`Opening RPC '${e}' stream ${i} to ${this.databaseInfo.host}`),setTimeout(()=>{c.callOnOpen()},0),c}terminate(){this.cachedStub&&(this.cachedStub.close(),this.cachedStub=void 0)}}let lk={google:{nested:{protobuf:{options:{csharp_namespace:"Google.Protobuf.WellKnownTypes",go_package:"github.com/golang/protobuf/ptypes/wrappers",java_package:"com.google.protobuf",java_outer_classname:"WrappersProto",java_multiple_files:!0,objc_class_prefix:"GPB",cc_enable_arenas:!0,optimize_for:"SPEED"},nested:{Timestamp:{fields:{seconds:{type:"int64",id:1},nanos:{type:"int32",id:2}}},FileDescriptorSet:{fields:{file:{rule:"repeated",type:"FileDescriptorProto",id:1}}},FileDescriptorProto:{fields:{name:{type:"string",id:1},package:{type:"string",id:2},dependency:{rule:"repeated",type:"string",id:3},publicDependency:{rule:"repeated",type:"int32",id:10,options:{packed:!1}},weakDependency:{rule:"repeated",type:"int32",id:11,options:{packed:!1}},messageType:{rule:"repeated",type:"DescriptorProto",id:4},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:5},service:{rule:"repeated",type:"ServiceDescriptorProto",id:6},extension:{rule:"repeated",type:"FieldDescriptorProto",id:7},options:{type:"FileOptions",id:8},sourceCodeInfo:{type:"SourceCodeInfo",id:9},syntax:{type:"string",id:12}}},DescriptorProto:{fields:{name:{type:"string",id:1},field:{rule:"repeated",type:"FieldDescriptorProto",id:2},extension:{rule:"repeated",type:"FieldDescriptorProto",id:6},nestedType:{rule:"repeated",type:"DescriptorProto",id:3},enumType:{rule:"repeated",type:"EnumDescriptorProto",id:4},extensionRange:{rule:"repeated",type:"ExtensionRange",id:5},oneofDecl:{rule:"repeated",type:"OneofDescriptorProto",id:8},options:{type:"MessageOptions",id:7},reservedRange:{rule:"repeated",type:"ReservedRange",id:9},reservedName:{rule:"repeated",type:"string",id:10}},nested:{ExtensionRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}},ReservedRange:{fields:{start:{type:"int32",id:1},end:{type:"int32",id:2}}}}},FieldDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:3},label:{type:"Label",id:4},type:{type:"Type",id:5},typeName:{type:"string",id:6},extendee:{type:"string",id:2},defaultValue:{type:"string",id:7},oneofIndex:{type:"int32",id:9},jsonName:{type:"string",id:10},options:{type:"FieldOptions",id:8}},nested:{Type:{values:{TYPE_DOUBLE:1,TYPE_FLOAT:2,TYPE_INT64:3,TYPE_UINT64:4,TYPE_INT32:5,TYPE_FIXED64:6,TYPE_FIXED32:7,TYPE_BOOL:8,TYPE_STRING:9,TYPE_GROUP:10,TYPE_MESSAGE:11,TYPE_BYTES:12,TYPE_UINT32:13,TYPE_ENUM:14,TYPE_SFIXED32:15,TYPE_SFIXED64:16,TYPE_SINT32:17,TYPE_SINT64:18}},Label:{values:{LABEL_OPTIONAL:1,LABEL_REQUIRED:2,LABEL_REPEATED:3}}}},OneofDescriptorProto:{fields:{name:{type:"string",id:1},options:{type:"OneofOptions",id:2}}},EnumDescriptorProto:{fields:{name:{type:"string",id:1},value:{rule:"repeated",type:"EnumValueDescriptorProto",id:2},options:{type:"EnumOptions",id:3}}},EnumValueDescriptorProto:{fields:{name:{type:"string",id:1},number:{type:"int32",id:2},options:{type:"EnumValueOptions",id:3}}},ServiceDescriptorProto:{fields:{name:{type:"string",id:1},method:{rule:"repeated",type:"MethodDescriptorProto",id:2},options:{type:"ServiceOptions",id:3}}},MethodDescriptorProto:{fields:{name:{type:"string",id:1},inputType:{type:"string",id:2},outputType:{type:"string",id:3},options:{type:"MethodOptions",id:4},clientStreaming:{type:"bool",id:5},serverStreaming:{type:"bool",id:6}}},FileOptions:{fields:{javaPackage:{type:"string",id:1},javaOuterClassname:{type:"string",id:8},javaMultipleFiles:{type:"bool",id:10},javaGenerateEqualsAndHash:{type:"bool",id:20,options:{deprecated:!0}},javaStringCheckUtf8:{type:"bool",id:27},optimizeFor:{type:"OptimizeMode",id:9,options:{default:"SPEED"}},goPackage:{type:"string",id:11},ccGenericServices:{type:"bool",id:16},javaGenericServices:{type:"bool",id:17},pyGenericServices:{type:"bool",id:18},deprecated:{type:"bool",id:23},ccEnableArenas:{type:"bool",id:31},objcClassPrefix:{type:"string",id:36},csharpNamespace:{type:"string",id:37},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,0x1fffffff]],reserved:[[38,38]],nested:{OptimizeMode:{values:{SPEED:1,CODE_SIZE:2,LITE_RUNTIME:3}}}},MessageOptions:{fields:{messageSetWireFormat:{type:"bool",id:1},noStandardDescriptorAccessor:{type:"bool",id:2},deprecated:{type:"bool",id:3},mapEntry:{type:"bool",id:7},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,0x1fffffff]],reserved:[[8,8]]},FieldOptions:{fields:{ctype:{type:"CType",id:1,options:{default:"STRING"}},packed:{type:"bool",id:2},jstype:{type:"JSType",id:6,options:{default:"JS_NORMAL"}},lazy:{type:"bool",id:5},deprecated:{type:"bool",id:3},weak:{type:"bool",id:10},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,0x1fffffff]],reserved:[[4,4]],nested:{CType:{values:{STRING:0,CORD:1,STRING_PIECE:2}},JSType:{values:{JS_NORMAL:0,JS_STRING:1,JS_NUMBER:2}}}},OneofOptions:{fields:{uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,0x1fffffff]]},EnumOptions:{fields:{allowAlias:{type:"bool",id:2},deprecated:{type:"bool",id:3},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,0x1fffffff]]},EnumValueOptions:{fields:{deprecated:{type:"bool",id:1},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,0x1fffffff]]},ServiceOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,0x1fffffff]]},MethodOptions:{fields:{deprecated:{type:"bool",id:33},uninterpretedOption:{rule:"repeated",type:"UninterpretedOption",id:999}},extensions:[[1e3,0x1fffffff]]},UninterpretedOption:{fields:{name:{rule:"repeated",type:"NamePart",id:2},identifierValue:{type:"string",id:3},positiveIntValue:{type:"uint64",id:4},negativeIntValue:{type:"int64",id:5},doubleValue:{type:"double",id:6},stringValue:{type:"bytes",id:7},aggregateValue:{type:"string",id:8}},nested:{NamePart:{fields:{namePart:{rule:"required",type:"string",id:1},isExtension:{rule:"required",type:"bool",id:2}}}}},SourceCodeInfo:{fields:{location:{rule:"repeated",type:"Location",id:1}},nested:{Location:{fields:{path:{rule:"repeated",type:"int32",id:1},span:{rule:"repeated",type:"int32",id:2},leadingComments:{type:"string",id:3},trailingComments:{type:"string",id:4},leadingDetachedComments:{rule:"repeated",type:"string",id:6}}}}},GeneratedCodeInfo:{fields:{annotation:{rule:"repeated",type:"Annotation",id:1}},nested:{Annotation:{fields:{path:{rule:"repeated",type:"int32",id:1},sourceFile:{type:"string",id:2},begin:{type:"int32",id:3},end:{type:"int32",id:4}}}}},Struct:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Value:{oneofs:{kind:{oneof:["nullValue","numberValue","stringValue","boolValue","structValue","listValue"]}},fields:{nullValue:{type:"NullValue",id:1},numberValue:{type:"double",id:2},stringValue:{type:"string",id:3},boolValue:{type:"bool",id:4},structValue:{type:"Struct",id:5},listValue:{type:"ListValue",id:6}}},NullValue:{values:{NULL_VALUE:0}},ListValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}},Empty:{fields:{}},DoubleValue:{fields:{value:{type:"double",id:1}}},FloatValue:{fields:{value:{type:"float",id:1}}},Int64Value:{fields:{value:{type:"int64",id:1}}},UInt64Value:{fields:{value:{type:"uint64",id:1}}},Int32Value:{fields:{value:{type:"int32",id:1}}},UInt32Value:{fields:{value:{type:"uint32",id:1}}},BoolValue:{fields:{value:{type:"bool",id:1}}},StringValue:{fields:{value:{type:"string",id:1}}},BytesValue:{fields:{value:{type:"bytes",id:1}}},Any:{fields:{typeUrl:{type:"string",id:1},value:{type:"bytes",id:2}}}}},firestore:{nested:{v1:{options:{csharp_namespace:"Google.Cloud.Firestore.V1",go_package:"google.golang.org/genproto/googleapis/firestore/v1;firestore",java_multiple_files:!0,java_outer_classname:"WriteProto",java_package:"com.google.firestore.v1",objc_class_prefix:"GCFS",php_namespace:"Google\\Cloud\\Firestore\\V1",ruby_package:"Google::Cloud::Firestore::V1"},nested:{AggregationResult:{fields:{aggregateFields:{keyType:"string",type:"Value",id:2}}},BitSequence:{fields:{bitmap:{type:"bytes",id:1},padding:{type:"int32",id:2}}},BloomFilter:{fields:{bits:{type:"BitSequence",id:1},hashCount:{type:"int32",id:2}}},DocumentMask:{fields:{fieldPaths:{rule:"repeated",type:"string",id:1}}},Precondition:{oneofs:{conditionType:{oneof:["exists","updateTime"]}},fields:{exists:{type:"bool",id:1},updateTime:{type:"google.protobuf.Timestamp",id:2}}},TransactionOptions:{oneofs:{mode:{oneof:["readOnly","readWrite"]}},fields:{readOnly:{type:"ReadOnly",id:2},readWrite:{type:"ReadWrite",id:3}},nested:{ReadWrite:{fields:{retryTransaction:{type:"bytes",id:1}}},ReadOnly:{oneofs:{consistencySelector:{oneof:["readTime"]}},fields:{readTime:{type:"google.protobuf.Timestamp",id:2}}}}},Document:{fields:{name:{type:"string",id:1},fields:{keyType:"string",type:"Value",id:2},createTime:{type:"google.protobuf.Timestamp",id:3},updateTime:{type:"google.protobuf.Timestamp",id:4}}},Value:{oneofs:{valueType:{oneof:["nullValue","booleanValue","integerValue","doubleValue","timestampValue","stringValue","bytesValue","referenceValue","geoPointValue","arrayValue","mapValue"]}},fields:{nullValue:{type:"google.protobuf.NullValue",id:11},booleanValue:{type:"bool",id:1},integerValue:{type:"int64",id:2},doubleValue:{type:"double",id:3},timestampValue:{type:"google.protobuf.Timestamp",id:10},stringValue:{type:"string",id:17},bytesValue:{type:"bytes",id:18},referenceValue:{type:"string",id:5},geoPointValue:{type:"google.type.LatLng",id:8},arrayValue:{type:"ArrayValue",id:9},mapValue:{type:"MapValue",id:6}}},ArrayValue:{fields:{values:{rule:"repeated",type:"Value",id:1}}},MapValue:{fields:{fields:{keyType:"string",type:"Value",id:1}}},Firestore:{options:{"(google.api.default_host)":"firestore.googleapis.com","(google.api.oauth_scopes)":"https://www.googleapis.com/auth/cloud-platform,https://www.googleapis.com/auth/datastore"},methods:{GetDocument:{requestType:"GetDocumentRequest",responseType:"Document",options:{"(google.api.http).get":"/v1/{name=projects/*/databases/*/documents/*/**}"},parsedOptions:[{"(google.api.http)":{get:"/v1/{name=projects/*/databases/*/documents/*/**}"}}]},ListDocuments:{requestType:"ListDocumentsRequest",responseType:"ListDocumentsResponse",options:{"(google.api.http).get":"/v1/{parent=projects/*/databases/*/documents/*/**}/{collection_id}"},parsedOptions:[{"(google.api.http)":{get:"/v1/{parent=projects/*/databases/*/documents/*/**}/{collection_id}"}}]},UpdateDocument:{requestType:"UpdateDocumentRequest",responseType:"Document",options:{"(google.api.http).patch":"/v1/{document.name=projects/*/databases/*/documents/*/**}","(google.api.http).body":"document","(google.api.method_signature)":"document,update_mask"},parsedOptions:[{"(google.api.http)":{patch:"/v1/{document.name=projects/*/databases/*/documents/*/**}",body:"document"}},{"(google.api.method_signature)":"document,update_mask"}]},DeleteDocument:{requestType:"DeleteDocumentRequest",responseType:"google.protobuf.Empty",options:{"(google.api.http).delete":"/v1/{name=projects/*/databases/*/documents/*/**}","(google.api.method_signature)":"name"},parsedOptions:[{"(google.api.http)":{delete:"/v1/{name=projects/*/databases/*/documents/*/**}"}},{"(google.api.method_signature)":"name"}]},BatchGetDocuments:{requestType:"BatchGetDocumentsRequest",responseType:"BatchGetDocumentsResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:batchGet","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:batchGet",body:"*"}}]},BeginTransaction:{requestType:"BeginTransactionRequest",responseType:"BeginTransactionResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:beginTransaction","(google.api.http).body":"*","(google.api.method_signature)":"database"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:beginTransaction",body:"*"}},{"(google.api.method_signature)":"database"}]},Commit:{requestType:"CommitRequest",responseType:"CommitResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:commit","(google.api.http).body":"*","(google.api.method_signature)":"database,writes"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:commit",body:"*"}},{"(google.api.method_signature)":"database,writes"}]},Rollback:{requestType:"RollbackRequest",responseType:"google.protobuf.Empty",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:rollback","(google.api.http).body":"*","(google.api.method_signature)":"database,transaction"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:rollback",body:"*"}},{"(google.api.method_signature)":"database,transaction"}]},RunQuery:{requestType:"RunQueryRequest",responseType:"RunQueryResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:runQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:runQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:runQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:runQuery",body:"*"}}}]},RunAggregationQuery:{requestType:"RunAggregationQueryRequest",responseType:"RunAggregationQueryResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:runAggregationQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:runAggregationQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:runAggregationQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:runAggregationQuery",body:"*"}}}]},PartitionQuery:{requestType:"PartitionQueryRequest",responseType:"PartitionQueryResponse",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:partitionQuery","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:partitionQuery","(google.api.http).additional_bindings.body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:partitionQuery",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:partitionQuery",body:"*"}}}]},Write:{requestType:"WriteRequest",requestStream:!0,responseType:"WriteResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:write","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:write",body:"*"}}]},Listen:{requestType:"ListenRequest",requestStream:!0,responseType:"ListenResponse",responseStream:!0,options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:listen","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:listen",body:"*"}}]},ListCollectionIds:{requestType:"ListCollectionIdsRequest",responseType:"ListCollectionIdsResponse",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents}:listCollectionIds","(google.api.http).body":"*","(google.api.http).additional_bindings.post":"/v1/{parent=projects/*/databases/*/documents/*/**}:listCollectionIds","(google.api.http).additional_bindings.body":"*","(google.api.method_signature)":"parent"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents}:listCollectionIds",body:"*",additional_bindings:{post:"/v1/{parent=projects/*/databases/*/documents/*/**}:listCollectionIds",body:"*"}}},{"(google.api.method_signature)":"parent"}]},BatchWrite:{requestType:"BatchWriteRequest",responseType:"BatchWriteResponse",options:{"(google.api.http).post":"/v1/{database=projects/*/databases/*}/documents:batchWrite","(google.api.http).body":"*"},parsedOptions:[{"(google.api.http)":{post:"/v1/{database=projects/*/databases/*}/documents:batchWrite",body:"*"}}]},CreateDocument:{requestType:"CreateDocumentRequest",responseType:"Document",options:{"(google.api.http).post":"/v1/{parent=projects/*/databases/*/documents/**}/{collection_id}","(google.api.http).body":"document"},parsedOptions:[{"(google.api.http)":{post:"/v1/{parent=projects/*/databases/*/documents/**}/{collection_id}",body:"document"}}]}}},GetDocumentRequest:{oneofs:{consistencySelector:{oneof:["transaction","readTime"]}},fields:{name:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},mask:{type:"DocumentMask",id:2},transaction:{type:"bytes",id:3},readTime:{type:"google.protobuf.Timestamp",id:5}}},ListDocumentsRequest:{oneofs:{consistencySelector:{oneof:["transaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},collectionId:{type:"string",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}},pageSize:{type:"int32",id:3},pageToken:{type:"string",id:4},orderBy:{type:"string",id:6},mask:{type:"DocumentMask",id:7},transaction:{type:"bytes",id:8},readTime:{type:"google.protobuf.Timestamp",id:10},showMissing:{type:"bool",id:12}}},ListDocumentsResponse:{fields:{documents:{rule:"repeated",type:"Document",id:1},nextPageToken:{type:"string",id:2}}},CreateDocumentRequest:{fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},collectionId:{type:"string",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}},documentId:{type:"string",id:3},document:{type:"Document",id:4,options:{"(google.api.field_behavior)":"REQUIRED"}},mask:{type:"DocumentMask",id:5}}},UpdateDocumentRequest:{fields:{document:{type:"Document",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},updateMask:{type:"DocumentMask",id:2},mask:{type:"DocumentMask",id:3},currentDocument:{type:"Precondition",id:4}}},DeleteDocumentRequest:{fields:{name:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},currentDocument:{type:"Precondition",id:2}}},BatchGetDocumentsRequest:{oneofs:{consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},documents:{rule:"repeated",type:"string",id:2},mask:{type:"DocumentMask",id:3},transaction:{type:"bytes",id:4},newTransaction:{type:"TransactionOptions",id:5},readTime:{type:"google.protobuf.Timestamp",id:7}}},BatchGetDocumentsResponse:{oneofs:{result:{oneof:["found","missing"]}},fields:{found:{type:"Document",id:1},missing:{type:"string",id:2},transaction:{type:"bytes",id:3},readTime:{type:"google.protobuf.Timestamp",id:4}}},BeginTransactionRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},options:{type:"TransactionOptions",id:2}}},BeginTransactionResponse:{fields:{transaction:{type:"bytes",id:1}}},CommitRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},writes:{rule:"repeated",type:"Write",id:2},transaction:{type:"bytes",id:3}}},CommitResponse:{fields:{writeResults:{rule:"repeated",type:"WriteResult",id:1},commitTime:{type:"google.protobuf.Timestamp",id:2}}},RollbackRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},transaction:{type:"bytes",id:2,options:{"(google.api.field_behavior)":"REQUIRED"}}}},RunQueryRequest:{oneofs:{queryType:{oneof:["structuredQuery"]},consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredQuery:{type:"StructuredQuery",id:2},transaction:{type:"bytes",id:5},newTransaction:{type:"TransactionOptions",id:6},readTime:{type:"google.protobuf.Timestamp",id:7}}},RunQueryResponse:{fields:{transaction:{type:"bytes",id:2},document:{type:"Document",id:1},readTime:{type:"google.protobuf.Timestamp",id:3},skippedResults:{type:"int32",id:4}}},RunAggregationQueryRequest:{oneofs:{queryType:{oneof:["structuredAggregationQuery"]},consistencySelector:{oneof:["transaction","newTransaction","readTime"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredAggregationQuery:{type:"StructuredAggregationQuery",id:2},transaction:{type:"bytes",id:4},newTransaction:{type:"TransactionOptions",id:5},readTime:{type:"google.protobuf.Timestamp",id:6}}},RunAggregationQueryResponse:{fields:{result:{type:"AggregationResult",id:1},transaction:{type:"bytes",id:2},readTime:{type:"google.protobuf.Timestamp",id:3}}},PartitionQueryRequest:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},structuredQuery:{type:"StructuredQuery",id:2},partitionCount:{type:"int64",id:3},pageToken:{type:"string",id:4},pageSize:{type:"int32",id:5}}},PartitionQueryResponse:{fields:{partitions:{rule:"repeated",type:"Cursor",id:1},nextPageToken:{type:"string",id:2}}},WriteRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},streamId:{type:"string",id:2},writes:{rule:"repeated",type:"Write",id:3},streamToken:{type:"bytes",id:4},labels:{keyType:"string",type:"string",id:5}}},WriteResponse:{fields:{streamId:{type:"string",id:1},streamToken:{type:"bytes",id:2},writeResults:{rule:"repeated",type:"WriteResult",id:3},commitTime:{type:"google.protobuf.Timestamp",id:4}}},ListenRequest:{oneofs:{targetChange:{oneof:["addTarget","removeTarget"]}},fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},addTarget:{type:"Target",id:2},removeTarget:{type:"int32",id:3},labels:{keyType:"string",type:"string",id:4}}},ListenResponse:{oneofs:{responseType:{oneof:["targetChange","documentChange","documentDelete","documentRemove","filter"]}},fields:{targetChange:{type:"TargetChange",id:2},documentChange:{type:"DocumentChange",id:3},documentDelete:{type:"DocumentDelete",id:4},documentRemove:{type:"DocumentRemove",id:6},filter:{type:"ExistenceFilter",id:5}}},Target:{oneofs:{targetType:{oneof:["query","documents"]},resumeType:{oneof:["resumeToken","readTime"]}},fields:{query:{type:"QueryTarget",id:2},documents:{type:"DocumentsTarget",id:3},resumeToken:{type:"bytes",id:4},readTime:{type:"google.protobuf.Timestamp",id:11},targetId:{type:"int32",id:5},once:{type:"bool",id:6},expectedCount:{type:"google.protobuf.Int32Value",id:12}},nested:{DocumentsTarget:{fields:{documents:{rule:"repeated",type:"string",id:2}}},QueryTarget:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{parent:{type:"string",id:1},structuredQuery:{type:"StructuredQuery",id:2}}}}},TargetChange:{fields:{targetChangeType:{type:"TargetChangeType",id:1},targetIds:{rule:"repeated",type:"int32",id:2},cause:{type:"google.rpc.Status",id:3},resumeToken:{type:"bytes",id:4},readTime:{type:"google.protobuf.Timestamp",id:6}},nested:{TargetChangeType:{values:{NO_CHANGE:0,ADD:1,REMOVE:2,CURRENT:3,RESET:4}}}},ListCollectionIdsRequest:{fields:{parent:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},pageSize:{type:"int32",id:2},pageToken:{type:"string",id:3}}},ListCollectionIdsResponse:{fields:{collectionIds:{rule:"repeated",type:"string",id:1},nextPageToken:{type:"string",id:2}}},BatchWriteRequest:{fields:{database:{type:"string",id:1,options:{"(google.api.field_behavior)":"REQUIRED"}},writes:{rule:"repeated",type:"Write",id:2},labels:{keyType:"string",type:"string",id:3}}},BatchWriteResponse:{fields:{writeResults:{rule:"repeated",type:"WriteResult",id:1},status:{rule:"repeated",type:"google.rpc.Status",id:2}}},StructuredQuery:{fields:{select:{type:"Projection",id:1},from:{rule:"repeated",type:"CollectionSelector",id:2},where:{type:"Filter",id:3},orderBy:{rule:"repeated",type:"Order",id:4},startAt:{type:"Cursor",id:7},endAt:{type:"Cursor",id:8},offset:{type:"int32",id:6},limit:{type:"google.protobuf.Int32Value",id:5}},nested:{CollectionSelector:{fields:{collectionId:{type:"string",id:2},allDescendants:{type:"bool",id:3}}},Filter:{oneofs:{filterType:{oneof:["compositeFilter","fieldFilter","unaryFilter"]}},fields:{compositeFilter:{type:"CompositeFilter",id:1},fieldFilter:{type:"FieldFilter",id:2},unaryFilter:{type:"UnaryFilter",id:3}}},CompositeFilter:{fields:{op:{type:"Operator",id:1},filters:{rule:"repeated",type:"Filter",id:2}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,AND:1,OR:2}}}},FieldFilter:{fields:{field:{type:"FieldReference",id:1},op:{type:"Operator",id:2},value:{type:"Value",id:3}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,LESS_THAN:1,LESS_THAN_OR_EQUAL:2,GREATER_THAN:3,GREATER_THAN_OR_EQUAL:4,EQUAL:5,NOT_EQUAL:6,ARRAY_CONTAINS:7,IN:8,ARRAY_CONTAINS_ANY:9,NOT_IN:10}}}},UnaryFilter:{oneofs:{operandType:{oneof:["field"]}},fields:{op:{type:"Operator",id:1},field:{type:"FieldReference",id:2}},nested:{Operator:{values:{OPERATOR_UNSPECIFIED:0,IS_NAN:2,IS_NULL:3,IS_NOT_NAN:4,IS_NOT_NULL:5}}}},Order:{fields:{field:{type:"FieldReference",id:1},direction:{type:"Direction",id:2}}},FieldReference:{fields:{fieldPath:{type:"string",id:2}}},Projection:{fields:{fields:{rule:"repeated",type:"FieldReference",id:2}}},Direction:{values:{DIRECTION_UNSPECIFIED:0,ASCENDING:1,DESCENDING:2}}}},StructuredAggregationQuery:{oneofs:{queryType:{oneof:["structuredQuery"]}},fields:{structuredQuery:{type:"StructuredQuery",id:1},aggregations:{rule:"repeated",type:"Aggregation",id:3}},nested:{Aggregation:{oneofs:{operator:{oneof:["count","sum","avg"]}},fields:{count:{type:"Count",id:1},sum:{type:"Sum",id:2},avg:{type:"Avg",id:3},alias:{type:"string",id:7}},nested:{Count:{fields:{upTo:{type:"google.protobuf.Int64Value",id:1}}},Sum:{fields:{field:{type:"FieldReference",id:1}}},Avg:{fields:{field:{type:"FieldReference",id:1}}}}}}},Cursor:{fields:{values:{rule:"repeated",type:"Value",id:1},before:{type:"bool",id:2}}},Write:{oneofs:{operation:{oneof:["update","delete","verify","transform"]}},fields:{update:{type:"Document",id:1},delete:{type:"string",id:2},verify:{type:"string",id:5},transform:{type:"DocumentTransform",id:6},updateMask:{type:"DocumentMask",id:3},updateTransforms:{rule:"repeated",type:"DocumentTransform.FieldTransform",id:7},currentDocument:{type:"Precondition",id:4}}},DocumentTransform:{fields:{document:{type:"string",id:1},fieldTransforms:{rule:"repeated",type:"FieldTransform",id:2}},nested:{FieldTransform:{oneofs:{transformType:{oneof:["setToServerValue","increment","maximum","minimum","appendMissingElements","removeAllFromArray"]}},fields:{fieldPath:{type:"string",id:1},setToServerValue:{type:"ServerValue",id:2},increment:{type:"Value",id:3},maximum:{type:"Value",id:4},minimum:{type:"Value",id:5},appendMissingElements:{type:"ArrayValue",id:6},removeAllFromArray:{type:"ArrayValue",id:7}},nested:{ServerValue:{values:{SERVER_VALUE_UNSPECIFIED:0,REQUEST_TIME:1}}}}}},WriteResult:{fields:{updateTime:{type:"google.protobuf.Timestamp",id:1},transformResults:{rule:"repeated",type:"Value",id:2}}},DocumentChange:{fields:{document:{type:"Document",id:1},targetIds:{rule:"repeated",type:"int32",id:5},removedTargetIds:{rule:"repeated",type:"int32",id:6}}},DocumentDelete:{fields:{document:{type:"string",id:1},removedTargetIds:{rule:"repeated",type:"int32",id:6},readTime:{type:"google.protobuf.Timestamp",id:4}}},DocumentRemove:{fields:{document:{type:"string",id:1},removedTargetIds:{rule:"repeated",type:"int32",id:2},readTime:{type:"google.protobuf.Timestamp",id:4}}},ExistenceFilter:{fields:{targetId:{type:"int32",id:1},count:{type:"int32",id:2},unchangedNames:{type:"BloomFilter",id:3}}}}}}},api:{options:{go_package:"google.golang.org/genproto/googleapis/api/annotations;annotations",java_multiple_files:!0,java_outer_classname:"HttpProto",java_package:"com.google.api",objc_class_prefix:"GAPI",cc_enable_arenas:!0},nested:{http:{type:"HttpRule",id:0x44f2530,extend:"google.protobuf.MethodOptions"},Http:{fields:{rules:{rule:"repeated",type:"HttpRule",id:1}}},HttpRule:{oneofs:{pattern:{oneof:["get","put","post","delete","patch","custom"]}},fields:{get:{type:"string",id:2},put:{type:"string",id:3},post:{type:"string",id:4},delete:{type:"string",id:5},patch:{type:"string",id:6},custom:{type:"CustomHttpPattern",id:8},selector:{type:"string",id:1},body:{type:"string",id:7},additionalBindings:{rule:"repeated",type:"HttpRule",id:11}}},CustomHttpPattern:{fields:{kind:{type:"string",id:1},path:{type:"string",id:2}}},methodSignature:{rule:"repeated",type:"string",id:1051,extend:"google.protobuf.MethodOptions"},defaultHost:{type:"string",id:1049,extend:"google.protobuf.ServiceOptions"},oauthScopes:{type:"string",id:1050,extend:"google.protobuf.ServiceOptions"},fieldBehavior:{rule:"repeated",type:"google.api.FieldBehavior",id:1052,extend:"google.protobuf.FieldOptions"},FieldBehavior:{values:{FIELD_BEHAVIOR_UNSPECIFIED:0,OPTIONAL:1,REQUIRED:2,OUTPUT_ONLY:3,INPUT_ONLY:4,IMMUTABLE:5,UNORDERED_LIST:6,NON_EMPTY_DEFAULT:7}}}},type:{options:{cc_enable_arenas:!0,go_package:"google.golang.org/genproto/googleapis/type/latlng;latlng",java_multiple_files:!0,java_outer_classname:"LatLngProto",java_package:"com.google.type",objc_class_prefix:"GTP"},nested:{LatLng:{fields:{latitude:{type:"double",id:1},longitude:{type:"double",id:2}}}}},rpc:{options:{cc_enable_arenas:!0,go_package:"google.golang.org/genproto/googleapis/rpc/status;status",java_multiple_files:!0,java_outer_classname:"StatusProto",java_package:"com.google.rpc",objc_class_prefix:"RPC"},nested:{Status:{fields:{code:{type:"int32",id:1},message:{type:"string",id:2},details:{rule:"repeated",type:"google.protobuf.Any",id:3}}}}}}}};var lA={nested:lk},lI=Object.freeze({__proto__:null,nested:lk,default:lA});let lO={longs:String,enums:String,defaults:!0,oneofs:!1};function lN(){let e=tM.fromJSON(lI,lO);return tP.loadPackageDefinition(e)}function lx(e){return new lR(lN(),e)}function lD(){return new lg}function lP(e){return new ay(e,!1)}let lM="ExponentialBackoff",lL=1e3,lF=1.5,lB=6e4;class lj{constructor(e,t,r=lL,i=lF,n=lB){this.queue=e,this.timerId=t,this.initialDelayMs=r,this.backoffFactor=i,this.maxDelayMs=n,this.currentBaseMs=0,this.timerPromise=null,this.lastAttemptTime=Date.now(),this.reset()}reset(){this.currentBaseMs=0}resetToMax(){this.currentBaseMs=this.maxDelayMs}backoffAndRun(e){this.cancel();let t=Math.floor(this.currentBaseMs+this.jitterDelayMs()),r=Math.max(0,Date.now()-this.lastAttemptTime),i=Math.max(0,t-r);i>0&&t$(lM,`Backing off for ${i} ms (base delay: ${this.currentBaseMs} ms, delay with jitter: ${t} ms, last attempt: ${r} ms ago)`),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,i,()=>(this.lastAttemptTime=Date.now(),e())),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)}skipBackoff(){null!==this.timerPromise&&(this.timerPromise.skipDelay(),this.timerPromise=null)}cancel(){null!==this.timerPromise&&(this.timerPromise.cancel(),this.timerPromise=null)}jitterDelayMs(){return(Math.random()-.5)*this.currentBaseMs}}let lU="PersistentStream",lV=6e4,lz=1e4;class lq{constructor(e,t,r,i,n,s,a,o){this.queue=e,this.idleTimerId=r,this.healthTimerId=i,this.connection=n,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=a,this.listener=o,this.state=0,this.closeCount=0,this.idleTimer=null,this.healthCheck=null,this.stream=null,this.responseCount=0,this.backoff=new lj(e,t)}isStarted(){return 1===this.state||5===this.state||this.isOpen()}isOpen(){return 2===this.state||3===this.state}start(){(this.responseCount=0,4===this.state)?this.performBackoff():this.auth()}async stop(){this.isStarted()&&await this.close(0)}inhibitBackoff(){this.state=0,this.backoff.reset()}markIdle(){this.isOpen()&&null===this.idleTimer&&(this.idleTimer=this.queue.enqueueAfterDelay(this.idleTimerId,lV,()=>this.handleIdleCloseTimer()))}sendRequest(e){this.cancelIdleCheck(),this.stream.send(e)}async handleIdleCloseTimer(){if(this.isOpen())return this.close(0)}cancelIdleCheck(){this.idleTimer&&(this.idleTimer.cancel(),this.idleTimer=null)}cancelHealthCheck(){this.healthCheck&&(this.healthCheck.cancel(),this.healthCheck=null)}async close(e,t){this.cancelIdleCheck(),this.cancelHealthCheck(),this.backoff.cancel(),this.closeCount++,4!==e?this.backoff.reset():t&&t.code===t7?(tH(t.toString()),tH("Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()):t&&t.code===t5&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=e,await this.listener.onClose(t)}tearDown(){}auth(){this.state=1;let e=this.getCloseGuardedDispatcher(this.closeCount),t=this.closeCount;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([e,r])=>{this.closeCount===t&&this.startStream(e,r)},t=>{e(()=>{let e=new rs(t0,"Fetching auth token failed: "+t.message);return this.handleStreamClose(e)})})}startStream(e,t){let r=this.getCloseGuardedDispatcher(this.closeCount);this.stream=this.startRpc(e,t),this.stream.onConnected(()=>{r(()=>this.listener.onConnected())}),this.stream.onOpen(()=>{r(()=>(this.state=2,this.healthCheck=this.queue.enqueueAfterDelay(this.healthTimerId,lz,()=>(this.isOpen()&&(this.state=3),Promise.resolve())),this.listener.onOpen()))}),this.stream.onClose(e=>{r(()=>this.handleStreamClose(e))}),this.stream.onMessage(e=>{r(()=>1==++this.responseCount?this.onFirst(e):this.onNext(e))})}performBackoff(){this.state=5,this.backoff.backoffAndRun(async()=>{this.state=0,this.start()})}handleStreamClose(e){return t$(lU,`close with error: ${e}`),this.stream=null,this.close(4,e)}getCloseGuardedDispatcher(e){return t=>{this.queue.enqueueAndForget(()=>this.closeCount===e?t():(t$(lU,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class l$ extends lq{constructor(e,t,r,i,n,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,r,i,s),this.serializer=n}get handshakeComplete(){return this.responseCount>0}start(){this.lastStreamToken=void 0,super.start()}tearDown(){this.handshakeComplete&&this.writeMutations([])}startRpc(e,t){return this.connection.openStream("Write",e,t)}onFirst(e){return tJ(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,tJ(!e.writeResults||0===e.writeResults.length,55816),this.listener.onHandshakeComplete()}onNext(e){tJ(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.backoff.reset();let t=aB(e.writeResults,e.commitTime),r=a_(e.commitTime);return this.listener.onMutationResult(r,t)}writeHandshake(){let e={};e.database=aN(this.serializer),this.sendRequest(e)}writeMutations(e){let t={streamToken:this.lastStreamToken,writes:e.map(e=>aM(this.serializer,e))};this.sendRequest(t)}}class lH{}class lW extends lH{constructor(e,t,r,i){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=r,this.serializer=i,this.terminated=!1}verifyInitialized(){if(this.terminated)throw new rs(t8,"The client has already been terminated.")}invokeRPC(e,t,r,i){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([n,s])=>this.connection.invokeRPC(e,aR(t,r),i,n,s)).catch(e=>{if("FirebaseError"===e.name)throw e.code===t5&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e;throw new rs(t0,e.toString())})}invokeStreamingRPC(e,t,r,i,n){return this.verifyInitialized(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,a])=>this.connection.invokeStreamingRPC(e,aR(t,r),i,s,a,n)).catch(e=>{if("FirebaseError"===e.name)throw e.code===t5&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e;throw new rs(t0,e.toString())})}terminate(){this.terminated=!0,this.connection.terminate()}}function lG(e,t,r,i){return new lW(e,t,r,i)}function lQ(e,t,r){let i=tY(e);return i.verifyInitialized(),new l$(t,i.connection,i.authCredentials,i.appCheckCredentials,i.serializer,r)}let lK="OnlineStateTracker",lJ=1,lY=1e4;class lX{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}handleWatchStreamStart(){0===this.watchStreamFailures&&(this.setAndBroadcast("Unknown"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay("online_state_timeout",lY,()=>(this.onlineStateTimer=null,this.logClientOfflineWarningIfNecessary(`Backend didn't respond within ${lY/1e3} seconds.`),this.setAndBroadcast("Offline"),Promise.resolve())))}handleWatchStreamFailure(e){"Online"===this.state?this.setAndBroadcast("Unknown"):(this.watchStreamFailures++,this.watchStreamFailures>=lJ&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary(`Connection failed ${lJ} times. Most recent error: ${e.toString()}`),this.setAndBroadcast("Offline")))}set(e){this.clearOnlineStateTimer(),this.watchStreamFailures=0,"Online"===e&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(e)}setAndBroadcast(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}logClientOfflineWarningIfNecessary(e){let t=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.shouldWarnClientIsOffline?(tH(t),this.shouldWarnClientIsOffline=!1):t$(lK,t)}clearOnlineStateTimer(){null!==this.onlineStateTimer&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)}}let lZ="RemoteStore",l0=10;class l1{constructor(e,t,r,i,n){this.localStore=e,this.datastore=t,this.asyncQueue=r,this.remoteSyncer={},this.writePipeline=[],this.listenTargets=new Map,this.offlineCauses=new Set,this.onNetworkStatusChange=[],this.connectivityMonitor=n,this.connectivityMonitor.addCallback(e=>{r.enqueueAndForget(async()=>{l5(this)&&(t$(lZ,"Restarting streams for network reachability change."),await cc(this))})}),this.onlineStateTracker=new lX(r,i)}}function l2(e,t,r,i,n){return new l1(e,t,r,i,n)}async function l3(e){if(l5(e))for(let t of e.onNetworkStatusChange)await t(!0)}async function l6(e){for(let t of e.onNetworkStatusChange)await t(!1)}async function l4(e){let t=tY(e);t$(lZ,"RemoteStore shutting down."),t.offlineCauses.add(5),await l6(t),t.connectivityMonitor.shutdown(),t.onlineStateTracker.set("Unknown")}function l5(e){return 0===tY(e).offlineCauses.size}async function l7(e,t,r){if(r1(t))e.offlineCauses.add(1),await l6(e),e.onlineStateTracker.set("Offline"),r||(r=()=>la(e.localStore)),e.asyncQueue.enqueueRetryable(async()=>{t$(lZ,"Retrying IndexedDB access"),await r(),e.offlineCauses.delete(1),await l3(e)});else throw t}function l8(e,t){return t().catch(r=>l7(e,r,t))}async function l9(e){let t=tY(e),r=cd(t),i=t.writePipeline.length>0?t.writePipeline[t.writePipeline.length-1].batchId:iD;for(;ce(t);)try{let e=await ll(t.localStore,i);if(null===e){0===t.writePipeline.length&&r.markIdle();break}i=e.batchId,ct(t,e)}catch(e){await l7(t,e)}cr(t)&&ci(t)}function ce(e){return l5(e)&&e.writePipeline.length<l0}function ct(e,t){e.writePipeline.push(t);let r=cd(e);r.isOpen()&&r.handshakeComplete&&r.writeMutations(t.mutations)}function cr(e){return l5(e)&&!cd(e).isStarted()&&e.writePipeline.length>0}function ci(e){cd(e).start()}async function cn(e){cd(e).writeHandshake()}async function cs(e){let t=cd(e);for(let r of e.writePipeline)t.writeMutations(r.mutations)}async function ca(e,t,r){let i=e.writePipeline.shift(),n=al.from(i,t,r);await l8(e,()=>e.remoteSyncer.applySuccessfulWrite(n)),await l9(e)}async function co(e,t){t&&cd(e).handshakeComplete&&await cl(e,t),cr(e)&&ci(e)}async function cl(e,t){if(ah(t.code)){let r=e.writePipeline.shift();cd(e).inhibitBackoff(),await l8(e,()=>e.remoteSyncer.rejectFailedWrite(r.batchId,t)),await l9(e)}}async function cc(e){let t=tY(e);t.offlineCauses.add(4),await l6(t),t.onlineStateTracker.set("Unknown"),t.offlineCauses.delete(4),await l3(t)}async function cu(e,t){let r=tY(e);r.asyncQueue.verifyOperationInProgress(),t$(lZ,"RemoteStore received new credentials");let i=l5(r);r.offlineCauses.add(3),await l6(r),i&&r.onlineStateTracker.set("Unknown"),await r.remoteSyncer.handleCredentialChange(t),r.offlineCauses.delete(3),await l3(r)}async function ch(e,t){let r=tY(e);t?(r.offlineCauses.delete(2),await l3(r)):t||(r.offlineCauses.add(2),await l6(r),r.onlineStateTracker.set("Unknown"))}function cd(e){return e.writeStream||(e.writeStream=lQ(e.datastore,e.asyncQueue,{onConnected:()=>Promise.resolve(),onOpen:cn.bind(null,e),onClose:co.bind(null,e),onHandshakeComplete:cs.bind(null,e),onMutationResult:ca.bind(null,e)}),e.onNetworkStatusChange.push(async t=>{t?(e.writeStream.inhibitBackoff(),await l9(e)):(await e.writeStream.stop(),e.writePipeline.length>0&&(t$(lZ,`Stopping write stream with ${e.writePipeline.length} pending writes`),e.writePipeline=[]))})),e.writeStream}let cf="AsyncQueue";class cp{constructor(e,t,r,i,n){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=r,this.op=i,this.removalCallback=n,this.deferred=new ra,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(e=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,t,r,i,n){let s=new cp(e,t,Date.now()+r,i,n);return s.start(r),s}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new rs(tZ,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function cm(e,t){if(tH(cf,`${t}: ${e}`),r1(e))return new rs(ri,`${t}: ${e}`);throw e}function cg(){return new cy}class cy{constructor(){this.queries=cv(),this.onlineState="Unknown",this.snapshotsInSyncListeners=new Set}terminate(){cS(this,new rs(t9,"Firestore shutting down"))}}function cv(){return new sf(e=>sn(e),si)}function cb(e,t){let r=tY(e);r.onlineState=t;let i=!1;r.queries.forEach((e,r)=>{for(let e of r.listeners)e.applyOnlineStateChange(t)&&(i=!0)}),i&&cC(r)}function cS(e,t){let r=tY(e),i=r.queries;r.queries=cv(),i.forEach((e,r)=>{for(let e of r.listeners)e.onError(t)})}function cC(e){e.snapshotsInSyncListeners.forEach(e=>{e.next()})}!function(e){e.Default="default",e.Cache="cache"}(o||(o={}));class cT{constructor(e,t,r,i){this.targetId=e,this.fromCache=t,this.addedKeys=r,this.removedKeys=i}static fromSnapshot(e,t){let r=sR(),i=sR();for(let e of t.docChanges)switch(e.type){case 0:r=r.add(e.doc.key);break;case 1:i=i.add(e.doc.key)}return new cT(e,t.fromCache,r,i)}}let cE="SyncEngine";class c_{constructor(e,t,r,i,n,s){this.localStore=e,this.remoteStore=t,this.eventManager=r,this.sharedClientState=i,this.currentUser=n,this.maxConcurrentLimboResolutions=s,this.syncEngineListener={},this.queryViewsByQuery=new sf(e=>sn(e),si),this.queriesByTarget=new Map,this.enqueuedLimboResolutions=new Set,this.activeLimboTargetsByKey=new ii(rI.comparator),this.activeLimboResolutionsByTarget=new Map,this.limboDocumentRefs=new oG,this.mutationUserCallbacks={},this.pendingWritesCallbacks=new Map,this.limboTargetIdGenerator=ok.forSyncEngine(),this.onlineState="Unknown",this._isPrimaryClient=void 0}get isPrimaryClient(){return!0===this._isPrimaryClient}}function cw(e,t,r,i,n,s,a){let o=new c_(e,t,r,i,n,s);return a&&(o._isPrimaryClient=!0),o}async function cR(e,t,r){let i=cL(e);try{let e=await lr(i.localStore,t);i.sharedClientState.addPendingMutation(e.batchId),cx(i,e.batchId,r),await cP(i,e.changes),await l9(i.remoteStore)}catch(t){let e=cm(t,"Failed to persist write");r.reject(e)}}function ck(e,t,r){let i=tY(e);if(i.isPrimaryClient&&0===r||!i.isPrimaryClient&&1===r){let e=[];i.queryViewsByQuery.forEach((r,i)=>{let n=i.view.applyOnlineStateChange(t);n.snapshot&&e.push(n.snapshot)}),cb(i.eventManager,t),e.length&&i.syncEngineListener.onWatchChange(e),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}async function cA(e,t){let r=tY(e),i=t.batch.batchId;try{let e=await li(r.localStore,t);cD(r,i,null),cO(r,i),r.sharedClientState.updateMutationState(i,"acknowledged"),await cP(r,e)}catch(e){await rX(e)}}async function cI(e,t,r){let i=tY(e);try{let e=await ls(i.localStore,t);cD(i,t,r),cO(i,t),i.sharedClientState.updateMutationState(t,"rejected",r),await cP(i,e)}catch(e){await rX(e)}}function cO(e,t){(e.pendingWritesCallbacks.get(t)||[]).forEach(e=>{e.resolve()}),e.pendingWritesCallbacks.delete(t)}function cN(e,t){e.pendingWritesCallbacks.forEach(e=>{e.forEach(e=>{e.reject(new rs(tZ,t))})}),e.pendingWritesCallbacks.clear()}function cx(e,t,r){let i=e.mutationUserCallbacks[e.currentUser.toKey()];i||(i=new ii(rv)),i=i.insert(t,r),e.mutationUserCallbacks[e.currentUser.toKey()]=i}function cD(e,t,r){let i=tY(e),n=i.mutationUserCallbacks[i.currentUser.toKey()];if(n){let e=n.get(t);e&&(r?e.reject(r):e.resolve(),n=n.remove(t)),i.mutationUserCallbacks[i.currentUser.toKey()]=n}}async function cP(e,t,r){let i=tY(e),n=[],s=[],a=[];i.queryViewsByQuery.isEmpty()||(i.queryViewsByQuery.forEach((e,o)=>{a.push(i.applyDocChanges(o,t,r).then(e=>{if((e||r)&&i.isPrimaryClient){let t=e?!e.fromCache:r?.targetChanges.get(o.targetId)?.current;i.sharedClientState.updateQueryState(o.targetId,t?"current":"not-current")}if(e){n.push(e);let t=cT.fromSnapshot(o.targetId,e);s.push(t)}}))}),await Promise.all(a),i.syncEngineListener.onWatchChange(n),await lo(i.localStore,s))}async function cM(e,t){let r=tY(e);if(!r.currentUser.isEqual(t)){t$(cE,"User change. New user:",t.toKey());let e=await lt(r.localStore,t);r.currentUser=t,cN(r,"'waitForPendingWrites' promise is rejected due to a user change."),r.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await cP(r,e.affectedDocuments)}}function cL(e){let t=tY(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=cA.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=cI.bind(null,t),t}class cF{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=lP(e.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(e),this.persistence=this.createPersistence(e),await this.persistence.start(),this.localStore=this.createLocalStore(e),this.gcScheduler=this.createGarbageCollectionScheduler(e,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(e,this.localStore)}createGarbageCollectionScheduler(e,t){return null}createIndexBackfillerScheduler(e,t){return null}createLocalStore(e){return le(this.persistence,new lf,e.initialUser,this.serializer)}createPersistence(e){return new o3(o4.factory,this.serializer)}createSharedClientState(e){return new lm}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}cF.provider={build:()=>new cF};class cB extends cF{constructor(e){super(),this.cacheSizeBytes=e}createGarbageCollectionScheduler(e,t){return tJ(this.persistence.referenceDelegate instanceof o5,46915),new oB(this.persistence.referenceDelegate.garbageCollector,e.asyncQueue,t)}createPersistence(e){let t=void 0!==this.cacheSizeBytes?oN.withCacheSize(this.cacheSizeBytes):oN.DEFAULT;return new o3(e=>o5.factory(e,t),this.serializer)}}class cj{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>ck(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=cM.bind(null,this.syncEngine),await ch(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return cg()}createDatastore(e){let t=lP(e.databaseInfo.databaseId),r=lx(e.databaseInfo);return lG(e.authCredentials,e.appCheckCredentials,r,t)}createRemoteStore(e){return l2(this.localStore,this.datastore,e.asyncQueue,e=>ck(this.syncEngine,e,0),lD())}createSyncEngine(e,t){return cw(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await l4(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}cj.provider={build:()=>new cj};let cU="FirestoreClient",cV=100,cz=11,cq=20,c$=22;class cH{constructor(e,t,r,i,n){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=r,this.databaseInfo=i,this.user=tB.UNAUTHENTICATED,this.clientId=ry.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=n,this.authCredentials.start(r,async e=>{t$(cU,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e}),this.appCheckCredentials.start(r,e=>(t$(cU,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:cV}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();let e=new ra;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(r){let t=cm(r,"Failed to shutdown persistence");e.reject(t)}}),e.promise}}async function cW(e,t){e.asyncQueue.verifyOperationInProgress(),t$(cU,"Initializing OfflineComponentProvider");let r=e.configuration;await t.initialize(r);let i=r.initialUser;e.setCredentialChangeListener(async e=>{i.isEqual(e)||(await lt(t.localStore,e),i=e)}),t.persistence.setDatabaseDeletedListener(()=>e.terminate()),e._offlineComponents=t}async function cG(e,t){e.asyncQueue.verifyOperationInProgress();let r=await cK(e);t$(cU,"Initializing OnlineComponentProvider"),await t.initialize(r,e.configuration),e.setCredentialChangeListener(e=>cu(t.remoteStore,e)),e.setAppCheckTokenChangeListener((e,r)=>cu(t.remoteStore,r)),e._onlineComponents=t}function cQ(e){return"FirebaseError"===e.name?e.code===t8||e.code===rt:!("undefined"!=typeof DOMException&&e instanceof DOMException)||e.code===c$||e.code===cq||e.code===cz}async function cK(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){t$(cU,"Using user provided OfflineComponentProvider");try{await cW(e,e._uninitializedComponentsProvider._offline)}catch(r){let t=r;if(!cQ(t))throw t;tW("Error using user provided cache. Falling back to memory cache: "+t),await cW(e,new cF)}}else t$(cU,"Using default OfflineComponentProvider"),await cW(e,new cB(void 0));return e._offlineComponents}async function cJ(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(t$(cU,"Using user provided OnlineComponentProvider"),await cG(e,e._uninitializedComponentsProvider._online)):(t$(cU,"Using default OnlineComponentProvider"),await cG(e,new cj))),e._onlineComponents}function cY(e){return cJ(e).then(e=>e.syncEngine)}function cX(e,t){let r=new ra;return e.asyncQueue.enqueueAndForget(async()=>cR(await cY(e),t,r)),r.promise}function cZ(e,t){return e.timeoutSeconds===t.timeoutSeconds}function c0(e){let t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}let c1="ComponentProvider",c2=new Map;function c3(e){let t=c2.get(e);t&&(t$(c1,"Removing Datastore"),c2.delete(e),t.terminate())}function c6(e,t,r,i){return new iI(e,t,r,i.host,i.ssl,i.experimentalForceLongPolling,i.experimentalAutoDetectLongPolling,c0(i.experimentalLongPollingOptions),i.useFetchStreams,i.isUsingEmulator)}let c4="firestore.googleapis.com",c5=!0,c7=5,c8=30,c9=!0;class ue{constructor(e){if(void 0===e.host){if(void 0!==e.ssl)throw new rs(t1,"Can't provide ssl option if host option is not set");this.host=c4,this.ssl=c5}else this.host=e.host,this.ssl=e.ssl??c5;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=oO;else if(e.cacheSizeBytes!==oI&&e.cacheSizeBytes<oD)throw new rs(t1,`cacheSizeBytes must be at least ${oD}`);else this.cacheSizeBytes=e.cacheSizeBytes;rN("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=c9:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=c0(e.experimentalLongPollingOptions??{}),ut(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&cZ(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}function ut(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new rs(t1,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<c7)throw new rs(t1,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is ${c7})`);if(e.timeoutSeconds>c8)throw new rs(t1,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is ${c8})`)}}class ur{constructor(e,t,r,i){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=r,this._app=i,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new ue({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new rs(t8,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new rs(t8,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new ue(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=rm(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return c3(this),Promise.resolve()}}function ui(e,t,r,i={}){e=rF(e,ur);let n=H(t),s=e._getSettings(),a={...s,emulatorOptions:e._getEmulatorOptions()},o=`${t}:${r}`;n&&(W(`https://${o}`),Q("Firestore",!0)),s.host!==c4&&s.host!==o&&tW("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");let l={...s,host:o,ssl:n,emulatorOptions:i};if(!eo(l,a)&&(e._setSettings(l),i.mockUserToken)){let t,r;if("string"==typeof i.mockUserToken)t=i.mockUserToken,r=tB.MOCK_USER;else{t=G(i.mockUserToken,e._app?.options.projectId);let n=i.mockUserToken.sub||i.mockUserToken.user_id;if(!n)throw new rs(t1,"mockUserToken must contain 'sub' or 'user_id' field!");r=new tB(n)}e._authCredentials=new rc(new ro(t,r))}}class un{constructor(e,t,r){this.converter=t,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new un(this.firestore,e,this._query)}}class us{constructor(e,t,r){this.converter=t,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ua(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new us(this.firestore,e,this._key)}toJSON(){return{type:us._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,r){if(rj(t,us._jsonSchema))return new us(e,r||null,new rI(rR.fromString(t.referencePath)))}}us._jsonSchemaVersion="firestore/documentReference/1.0",us._jsonSchema={type:rB("string",us._jsonSchemaVersion),referencePath:rB("string")};class ua extends un{constructor(e,t,r){super(e,t,n3(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let e=this._path.popLast();return e.isEmpty()?null:new us(this.firestore,null,new rI(e))}withConverter(e){return new ua(this.firestore,e,this._path)}}function uo(e,t,...r){if(e=ec(e),rO("collection","path",t),e instanceof ur){let i=rR.fromString(t,...r);return rD(i),new ua(e,null,i)}{if(!(e instanceof us)&&!(e instanceof ua))throw new rs(t1,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=e._path.child(rR.fromString(t,...r));return rD(i),new ua(e.firestore,null,i)}}function ul(e,t,...r){if(e=ec(e),1==arguments.length&&(t=ry.newId()),rO("doc","path",t),e instanceof ur){let i=rR.fromString(t,...r);return rx(i),new us(e,null,new rI(i))}{if(!(e instanceof us)&&!(e instanceof ua))throw new rs(t1,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=e._path.child(rR.fromString(t,...r));return rx(i),new us(e.firestore,e instanceof ua?e.converter:null,new rI(i))}}let uc="AsyncQueue";class uu{constructor(e=Promise.resolve()){this.retryableOps=[],this._isShuttingDown=!1,this.delayedOperations=[],this.failure=null,this.operationInProgress=!1,this.skipNonRestrictedTasks=!1,this.timerIdsToSkip=[],this.backoff=new lj(this,"async_queue_retry"),this.visibilityHandler=()=>{this.backoff.skipBackoff()},this.tail=e}get isShuttingDown(){return this._isShuttingDown}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.verifyNotFailed(),this.enqueueInternal(e)}enterRestrictedMode(e){this._isShuttingDown||(this._isShuttingDown=!0,this.skipNonRestrictedTasks=e||!1)}enqueue(e){if(this.verifyNotFailed(),this._isShuttingDown)return new Promise(()=>{});let t=new ra;return this.enqueueInternal(()=>this._isShuttingDown&&this.skipNonRestrictedTasks?Promise.resolve():(e().then(t.resolve,t.reject),t.promise)).then(()=>t.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.retryableOps.push(e),this.retryNextOp()))}async retryNextOp(){if(0!==this.retryableOps.length){try{await this.retryableOps[0](),this.retryableOps.shift(),this.backoff.reset()}catch(e){if(r1(e))t$(uc,"Operation failed with retryable error: "+e);else throw e}this.retryableOps.length>0&&this.backoff.backoffAndRun(()=>this.retryNextOp())}}enqueueInternal(e){let t=this.tail.then(()=>(this.operationInProgress=!0,e().catch(e=>{throw this.failure=e,this.operationInProgress=!1,tH("INTERNAL UNHANDLED ERROR: ",uh(e)),e}).then(e=>(this.operationInProgress=!1,e))));return this.tail=t,t}enqueueAfterDelay(e,t,r){this.verifyNotFailed(),this.timerIdsToSkip.indexOf(e)>-1&&(t=0);let i=cp.createAndSchedule(this,e,t,r,e=>this.removeDelayedOperation(e));return this.delayedOperations.push(i),i}verifyNotFailed(){this.failure&&tQ(47125,{messageOrStack:uh(this.failure)})}verifyOperationInProgress(){}async drain(){let e;do e=this.tail,await e;while(e!==this.tail)}containsDelayedOperation(e){for(let t of this.delayedOperations)if(t.timerId===e)return!0;return!1}runAllDelayedOperationsUntil(e){return this.drain().then(()=>{for(let t of(this.delayedOperations.sort((e,t)=>e.targetTimeMs-t.targetTimeMs),this.delayedOperations))if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.drain()})}skipDelaysForTimerId(e){this.timerIdsToSkip.push(e)}removeDelayedOperation(e){let t=this.delayedOperations.indexOf(e);this.delayedOperations.splice(t,1)}}function uh(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}class ud extends ur{constructor(e,t,r,i){super(e,t,r,i),this.type="firestore",this._queue=new uu,this._persistenceKey=i?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){let e=this._firestoreClient.terminate();this._queue=new uu(e),this._firestoreClient=void 0,await e}}}function uf(e,t){let r="object"==typeof e?e:tl(),i="string"==typeof e?e:t||iO,n=e4(r,"firestore").getImmediate({identifier:i});if(!n._initialized){let e=z("firestore");e&&ui(n,...e)}return n}function up(e){if(e._terminated)throw new rs(t8,"The client has already been terminated.");return e._firestoreClient||um(e),e._firestoreClient}function um(e){let t=e._freezeSettings(),r=c6(e._databaseId,e._app?.options.appId||"",e._persistenceKey,t);!e._componentsProvider&&t.localCache?._offlineComponentProvider&&t.localCache?._onlineComponentProvider&&(e._componentsProvider={_offline:t.localCache._offlineComponentProvider,_online:t.localCache._onlineComponentProvider}),e._firestoreClient=new cH(e._authCredentials,e._appCheckCredentials,e._queue,r,e._componentsProvider&&ug(e._componentsProvider))}function ug(e){let t=e?._online.build();return{_offline:e?._offline.build(t),_online:t}}function uy(e,t=!0){tU(ts),e6(new eu("firestore",(e,{instanceIdentifier:r,options:i})=>{let n=e.getProvider("app").getImmediate(),s=new ud(new ru(e.getProvider("auth-internal")),new rp(n,e.getProvider("app-check-internal")),ix(n,r),n);return i={useFetchStreams:t,...i},s._setSettings(i),s},"PUBLIC").setMultipleInstances(!0)),th(tL,tF,e),th(tL,tF,"esm2020")}class uv{constructor(e){this._byteString=e}static fromBase64String(e){try{return new uv(ip.fromBase64String(e))}catch(e){throw new rs(t1,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new uv(ip.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:uv._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(rj(e,uv._jsonSchema))return uv.fromBase64String(e.bytes)}}uv._jsonSchemaVersion="firestore/bytes/1.0",uv._jsonSchema={type:rB("string",uv._jsonSchemaVersion),bytes:rB("string")};class ub{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new rs(t1,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new rA(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class uS{constructor(e){this._methodName=e}}class uC{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new rs(t1,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new rs(t1,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return rv(this._lat,e._lat)||rv(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:uC._jsonSchemaVersion}}static fromJSON(e){if(rj(e,uC._jsonSchema))return new uC(e.latitude,e.longitude)}}uC._jsonSchemaVersion="firestore/geoPoint/1.0",uC._jsonSchema={type:rB("string",uC._jsonSchemaVersion),latitude:rB("number"),longitude:rB("number")};class uT{constructor(e){this._values=(e||[]).map(e=>e)}toArray(){return this._values.map(e=>e)}isEqual(e){return o7(this._values,e._values)}toJSON(){return{type:uT._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(rj(e,uT._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(e=>"number"==typeof e))return new uT(e.vectorValues);throw new rs(t1,"Expected 'vectorValues' field to be a number array")}}}uT._jsonSchemaVersion="firestore/vectorValue/1.0",uT._jsonSchema={type:rB("string",uT._jsonSchemaVersion),vectorValues:rB("object")};let uE=/^__.*__$/;class u_{constructor(e,t,r){this.data=e,this.fieldMask=t,this.fieldTransforms=r}toMutation(e,t){return null!==this.fieldMask?new s7(e,this.data,this.fieldMask,t,this.fieldTransforms):new s6(e,this.data,t,this.fieldTransforms)}}function uw(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw tQ(40011,{dataSource:e})}}class uR{constructor(e,t,r,i,n,s){this.settings=e,this.databaseId=t,this.serializer=r,this.ignoreUndefinedProperties=i,void 0===n&&this.validatePath(),this.fieldTransforms=n||[],this.fieldMask=s||[]}get path(){return this.settings.path}get dataSource(){return this.settings.dataSource}contextWith(e){return new uR({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}childContextForField(e){let t=this.path?.child(e),r=this.contextWith({path:t,arrayElement:!1});return r.validatePathSegment(e),r}childContextForFieldPath(e){let t=this.path?.child(e),r=this.contextWith({path:t,arrayElement:!1});return r.validatePath(),r}childContextForArray(e){return this.contextWith({path:void 0,arrayElement:!0})}createError(e){return uz(e,this.settings.methodName,this.settings.hasConverter||!1,this.path,this.settings.targetDoc)}contains(e){return void 0!==this.fieldMask.find(t=>e.isPrefixOf(t))||void 0!==this.fieldTransforms.find(t=>e.isPrefixOf(t.field))}validatePath(){if(this.path)for(let e=0;e<this.path.length;e++)this.validatePathSegment(this.path.get(e))}validatePathSegment(e){if(0===e.length)throw this.createError("Document fields must not be empty");if(uw(this.dataSource)&&uE.test(e))throw this.createError('Document fields cannot begin and end with "__"')}}class uk{constructor(e,t,r){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=r||lP(e)}createContext(e,t,r,i=!1){return new uR({dataSource:e,methodName:t,targetDoc:r,path:rA.emptyPath(),arrayElement:!1,hasConverter:i},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function uA(e){let t=e._freezeSettings(),r=lP(e._databaseId);return new uk(e._databaseId,!!t.ignoreUndefinedProperties,r)}function uI(e,t,r,i,n,s={}){let a,o,l=e.createContext(s.merge||s.mergeFields?2:0,t,r,n);uB("Data must be an object, but it was:",l,i);let c=ux(i,l);if(s.merge)a=new iu(l.fieldMask),o=l.fieldTransforms;else if(s.mergeFields){let e=[];for(let i of s.mergeFields){let n=uj(t,i,r);if(!l.contains(n))throw new rs(t1,`Field '${n}' is specified in your field mask but missing from your input data.`);uq(e,n)||e.push(n)}a=new iu(e),o=l.fieldTransforms.filter(e=>a.covers(e.field))}else a=null,o=l.fieldTransforms;return new u_(new ng(c),a,o)}class uO extends uS{_toFieldTransform(e){return new sW(e.path,new sF)}isEqual(e){return e instanceof uO}}function uN(e,t){if(uF(e=ec(e)))return uB("Unsupported field value:",t,e),ux(e,t);if(e instanceof uS)return uP(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),!(e instanceof Array))return uM(e,t);if(t.settings.arrayElement&&4!==t.dataSource)throw t.createError("Nested arrays are not supported");return uD(e,t)}function ux(e,t){let r={};return ir(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):it(e,(e,i)=>{let n=uN(i,t.childContextForField(e));null!=n&&(r[e]=n)}),{mapValue:{fields:r}}}function uD(e,t){let r=[],i=0;for(let n of e){let e=uN(n,t.childContextForArray(i));null==e&&(e={nullValue:"NULL_VALUE"}),r.push(e),i++}return{arrayValue:{values:r}}}function uP(e,t){if(!uw(t.dataSource))throw t.createError(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.createError(`${e._methodName}() is not currently supported inside arrays`);let r=e._toFieldTransform(t);r&&t.fieldTransforms.push(r)}function uM(e,t){if(null===(e=ec(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return sN(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){let r=rz.fromDate(e);return{timestampValue:aS(t.serializer,r)}}else if(e instanceof rz){let r=new rz(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:aS(t.serializer,r)}}else if(e instanceof uC)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};else if(e instanceof uv)return{bytesValue:aT(t.serializer,e._byteString)};else if(e instanceof us){let r=t.databaseId,i=e.firestore._databaseId;if(!i.isEqual(r))throw t.createError(`Document reference is for database ${i.projectId}/${i.database} but should be for database ${r.projectId}/${r.database}`);return{referenceValue:aw(e.firestore._databaseId||t.databaseId,e._key.path)}}else if(e instanceof uT)return uL(e,t);else throw t.createError(`Unsupported field value: ${rM(e)}`)}function uL(e,t){return{mapValue:{fields:{[iF]:{stringValue:iU},[iV]:{arrayValue:{values:e.toArray().map(e=>{if("number"!=typeof e)throw t.createError("VectorValues must only contain numeric values.");return sI(t.serializer,e)})}}}}}}function uF(e){return"object"==typeof e&&null!==e&&!(e instanceof Array)&&!(e instanceof Date)&&!(e instanceof rz)&&!(e instanceof uC)&&!(e instanceof uv)&&!(e instanceof us)&&!(e instanceof uS)&&!(e instanceof uT)}function uB(e,t,r){if(!uF(r)||!rP(r)){let i=rM(r);if("an object"===i)throw t.createError(e+" a custom object");throw t.createError(e+" "+i)}}function uj(e,t,r){if((t=ec(t))instanceof ub)return t._internalPath;if("string"==typeof t)return uV(e,t);throw uz("Field path arguments must be of type string or ",e,!1,void 0,r)}let uU=RegExp("[~\\*/\\[\\]]");function uV(e,t,r){if(t.search(uU)>=0)throw uz(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,r);try{return new ub(...t.split("."))._internalPath}catch(i){throw uz(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,r)}}function uz(e,t,r,i,n){let s=i&&!i.isEmpty(),a=void 0!==n,o=`Function ${t}() called with invalid data`;r&&(o+=" (via `toFirestore()`)"),o+=". ";let l="";return(s||a)&&(l+=" (found",s&&(l+=` in field ${i}`),a&&(l+=` in document ${n}`),l+=")"),new rs(t1,o+e+l)}function uq(e,t){return e.some(e=>e.isEqual(t))}class u${constructor(e,t,r,i,n){this._firestore=e,this._userDataWriter=t,this._key=r,this._document=i,this._converter=n}get id(){return this._key.path.lastSegment()}get ref(){return new us(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(!this._converter)return this._userDataWriter.convertValue(this._document.data.value);{let e=new uH(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}}}get(e){if(this._document){let t=this._document.data.field(uW("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class uH extends u${data(){return super.data()}}function uW(e,t){return"string"==typeof t?uV(e,t):t instanceof ub?t._internalPath:t._delegate._internalPath}function uG(e,t,r){return e?r&&(r.merge||r.mergeFields)?e.toFirestore(t,r):e.toFirestore(t):t}let uQ=af();function uK(e){let t=JSON.stringify(e),r=uQ.encode(t).byteLength;return`${r}${t}`}uK({metadata:{id:"test-bundle",createTime:{seconds:0x5e0be105,nanos:6},version:1,totalDocuments:1,totalBytes:416}}),uK({documentMetadata:{name:"projects/test-project/databases/(default)/documents/collectionId/doc1",readTime:{seconds:5,nanos:6},exists:!0}}),uK({document:{name:"projects/test-project/databases/(default)/documents/collectionId/doc1",createTime:{seconds:1,nanos:2e6},updateTime:{seconds:3,nanos:4e3},fields:{foo:{stringValue:"value"},bar:{integerValue:-42}}}}),uK({documentMetadata:{name:"projects/test-project/databases/(default)/documents/collectionId/doc2",readTime:{seconds:5,nanos:6},exists:!0}}),uK({document:{name:"projects/test-project/databases/(default)/documents/collectionId/doc2",createTime:{seconds:1,nanos:2e6},updateTime:{seconds:3,nanos:4e3},fields:{foo:{stringValue:"value1"},bar:{integerValue:42},emptyArray:{arrayValue:{}},emptyMap:{mapValue:{}}}}}),uK({documentMetadata:{name:"projects/test-project/databases/(default)/documents/collectionId/nodoc",readTime:{seconds:5,nanos:6},exists:!1}}),uK({namedQuery:{name:"limitQuery",bundledQuery:{parent:"projects/fireeats-97d5e/databases/(default)/documents",structuredQuery:{from:[{collectionId:"node_3.7.5_7Li7XoCjutvNxwD0tpo9"}],orderBy:[{field:{fieldPath:"sort"},direction:"DESCENDING"}],limit:{value:1}},limitType:"FIRST"},readTime:{seconds:0x5ec5a5f3,nanos:191164e3}}}),uK({namedQuery:{name:"limitToLastQuery",bundledQuery:{parent:"projects/fireeats-97d5e/databases/(default)/documents",structuredQuery:{from:[{collectionId:"node_3.7.5_7Li7XoCjutvNxwD0tpo9"}],orderBy:[{field:{fieldPath:"sort"},direction:"ASCENDING"}],limit:{value:1}},limitType:"LAST"},readTime:{seconds:0x5ec5a5f3,nanos:543063e3}}});let uJ=1;class uY{constructor(e,t){this.firestore=e,this.bundleId=t,this.documents=new Map,this.namedQueries=new Map,this.latestReadTime=new rz(0,0),this.databaseId=e._databaseId,this.serializer=new ay(this.databaseId,!0),this.userDataReader=new uk(this.databaseId,!0,this.serializer)}addBundleDocument(e,t){let r=this.documents.get(e.documentPath),i=r?.metadata.queries,n=e.readTime,s=r?.metadata.readTime?aC(r.metadata.readTime):null,a=!n&&null==s,o=void 0!==n&&(null==s||s<n);if((a||o)&&this.documents.set(e.documentPath,{document:this.toBundleDocument(e),metadata:{name:aA(this.serializer,e.documentKey),readTime:n?aS(this.serializer,n):void 0,exists:e.documentExists}}),n&&n>this.latestReadTime&&(this.latestReadTime=n),t){let r=this.documents.get(e.documentPath);r.metadata.queries=i||[],r.metadata.queries.push(t)}}addBundleQuery(e){if(this.namedQueries.has(e.name))throw Error(`Query name conflict: ${name} has already been added.`);let t=new rz(0,0);for(let r of e.docBundleDataArray)this.addBundleDocument(r,e.name),r.readTime&&r.readTime>t&&(t=r.readTime);let r=aU(this.serializer,se(e.query)),i={parent:e.parent,structuredQuery:r.queryTarget.structuredQuery};this.namedQueries.set(e.name,{name:e.name,bundledQuery:i,readTime:aS(this.serializer,t)})}toBundleDocument(e){let t=this.userDataReader.createContext(4,"internal toBundledDocument"),r=ux(e.documentData,t);return{name:aA(this.serializer,e.documentKey),fields:r.mapValue.fields,updateTime:aS(this.serializer,e.versionTime),createTime:aS(this.serializer,e.createdTime)}}lengthPrefixedString(e){let t=JSON.stringify(e),r=uQ.encode(t).byteLength;return`${r}${t}`}build(){let e="";for(let t of this.namedQueries.values())e+=this.lengthPrefixedString({namedQuery:t});for(let t of this.documents.values()){let r=t.metadata;e+=this.lengthPrefixedString({documentMetadata:r});let i=t.document;i&&(e+=this.lengthPrefixedString({document:i}))}let t={id:this.bundleId,createTime:aS(this.serializer,this.latestReadTime),version:uJ,totalDocuments:this.documents.size,totalBytes:uQ.encode(e).length};return this.lengthPrefixedString({metadata:t})+e}}function uX(e,t,r,i){let n=new uY(e,ry.newId());return n.addBundleDocument(u0(i,r,t)),n.build()}function uZ(e,t,r,i,n,s,a){let o=[];for(let e=0;e<s.length;e++)o.push(u0(n[e],a[e],s[e]));let l={name:r,query:t,parent:i,docBundleDataArray:o},c=new uY(e,r);return c.addBundleQuery(l),c.build()}function u0(e,t,r){return{documentData:t,documentKey:r.mutableCopy().key,documentPath:e,documentExists:!0,createdTime:r.createTime.toTimestamp(),readTime:r.readTime.toTimestamp(),versionTime:r.version.toTimestamp()}}class u1{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class u2 extends u${constructor(e,t,r,i,n,s){super(e,t,r,i,s),this._firestore=e,this._firestoreImpl=e,this.metadata=n}exists(){return super.exists()}data(e={}){if(this._document){if(!this._converter)return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps);{let t=new u3(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}}}get(e,t={}){if(this._document){let r=this._document.data.field(uW("DocumentSnapshot.get",e));if(null!==r)return this._userDataWriter.convertValue(r,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new rs(t8,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e=this._document,t={};if(t.type=u2._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument())return t;let r=this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous");return t.bundle=uX(this._firestore,e,r,this.ref.path),t}}u2._jsonSchemaVersion="firestore/documentSnapshot/1.0",u2._jsonSchema={type:rB("string",u2._jsonSchemaVersion),bundleSource:rB("string","DocumentSnapshot"),bundleName:rB("string"),bundle:rB("string")};class u3 extends u2{data(e={}){return super.data(e)}}class u6{constructor(e,t,r,i){this._firestore=e,this._userDataWriter=t,this._snapshot=i,this.metadata=new u1(i.hasPendingWrites,i.fromCache),this.query=r}get docs(){let e=[];return this.forEach(t=>e.push(t)),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach(r=>{e.call(t,new u3(this._firestore,this._userDataWriter,r.key,r,new u1(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){let t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new rs(t1,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=u4(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new rs(t8,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");let e={};e.type=u6._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=ry.newId();let t=this._firestore._databaseId.database,r=this._firestore._databaseId.projectId,i=`projects/${r}/databases/${t}/documents`,n=[],s=[],a=[];return this.docs.forEach(e=>{null!==e._document&&(n.push(e._document),s.push(this._userDataWriter.convertObjectMap(e._document.data.value.mapValue.fields,"previous")),a.push(e.ref.path))}),e.bundle=uZ(this._firestore,this.query._query,e.bundleName,i,a,n,s),e}}function u4(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map(r=>{let i=new u3(e._firestore,e._userDataWriter,r.doc.key,r.doc,new u1(e._snapshot.mutatedKeys.has(r.doc.key),e._snapshot.fromCache),e.query.converter);return r.doc,{type:"added",doc:i,oldIndex:-1,newIndex:t++}})}{let r=e._snapshot.oldDocs;return e._snapshot.docChanges.filter(e=>t||3!==e.type).map(t=>{let i=new u3(e._firestore,e._userDataWriter,t.doc.key,t.doc,new u1(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter),n=-1,s=-1;return 0!==t.type&&(n=r.indexOf(t.doc.key),r=r.delete(t.doc.key)),1!==t.type&&(s=(r=r.add(t.doc)).indexOf(t.doc.key)),{type:u5(t.type),doc:i,oldIndex:n,newIndex:s}})}}function u5(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return tQ(61501,{type:e})}}function u7(e,t){let r=rF(e.firestore,ud),i=ul(e),n=uG(e.converter,t);return u8(r,[uI(uA(e.firestore),"addDoc",i._key,n,null!==e.converter,{}).toMutation(i._key,sJ.exists(!1))]).then(()=>i)}function u8(e,t){return cX(up(e),t)}function u9(){return new uO("serverTimestamp")}u6._jsonSchemaVersion="firestore/querySnapshot/1.0",u6._jsonSchema={type:rB("string",u6._jsonSchemaVersion),bundleSource:rB("string","QuerySnapshot"),bundleName:rB("string"),bundle:rB("string")},new WeakMap,uy("node");let he={apiKey:"AIzaSyBf-dvyFjMttuLD43V4MBBRbuvfbwBRKsI",authDomain:"wines-sheet.firebaseapp.com",projectId:"wines-sheet",storageBucket:"wines-sheet.firebasestorage.app",messagingSenderId:"313820033015",appId:"1:313820033015:web:75cc4ccf84217324bf08f2"},ht=uf(0===tc().length?ta(he):tc()[0]);async function hr(e){try{let t=await e.formData(),r=t.get("username"),i=t.get("password"),n=t.get("feedback"),s=t.getAll("images");if(!r||!i||!n)return R.NextResponse.json({error:"Missing required fields"},{status:400});let a=await Promise.all(s.map(async e=>{let t=await e.arrayBuffer(),r=Buffer.from(t).toString("base64");return`data:${e.type};base64,${r}`}));return await u7(uo(ht,"feedbacks"),{username:r,password:i,feedback:n,images:a,phone:"7569971307",timestamp:u9(),createdAt:new Date().toISOString()}),R.NextResponse.json({success:!0})}catch(e){return console.error("Error sending feedback:",e),R.NextResponse.json({error:"Failed to send feedback"},{status:500})}}e.s(["POST",()=>hr],16932);var hi=e.i(16932);let hn="standalone",hs=new l.AppRouteRouteModule({definition:{kind:c.RouteKind.APP_ROUTE,page:"/api/send-feedback/route",pathname:"/api/send-feedback",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/pro/wine/app/api/send-feedback/route.ts",nextConfigOutput:hn,userland:hi}),{workAsyncStorage:ha,workUnitAsyncStorage:ho,serverHooks:hl}=hs;function hc(){return(0,u.patchFetch)({workAsyncStorage:ha,workUnitAsyncStorage:ho})}async function hu(e,t,r){hs.isDev&&(0,h.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let i="/api/send-feedback/route";i=i.replace(/\/index$/,"")||"/";let n=!1,s=await hs.prepare(e,t,{srcPage:i,multiZoneDraftMode:n});if(!s)return t.statusCode=400,t.end("Bad Request"),null==r.waitUntil||r.waitUntil.call(r,Promise.resolve()),null;let{buildId:a,params:o,nextConfig:l,parsedUrl:u,isDraftMode:R,prerenderManifest:k,routerServerContext:A,isOnDemandRevalidate:I,revalidateOnlyGenerated:O,resolvedPathname:N,clientReferenceManifest:x,serverActionsManifest:D}=s,P=(0,m.normalizeAppPath)(i),M=!!(k.dynamicRoutes[P]||k.routes[N]),L=async()=>((null==A?void 0:A.render404)?await A.render404(e,t,u,!1):t.end("This page could not be found"),null);if(M&&!R){let e=!!k.routes[N],t=k.dynamicRoutes[P];if(t&&!1===t.fallback&&!e){if(l.experimental.adapterPath)return await L();throw new _.NoFallbackError}}let F=null;!M||hs.isDev||R||(F="/index"===(F=N)?"/":F);let B=!0===hs.isDev||!M,j=M&&!B;D&&x&&(0,f.setReferenceManifestsSingleton)({page:i,clientReferenceManifest:x,serverActionsManifest:D,serverModuleMap:(0,p.createServerModuleMap)({serverActionsManifest:D})});let U=e.method||"GET",V=(0,d.getTracer)(),z=V.getActiveScopeSpan(),q={params:o,prerenderManifest:k,renderOpts:{experimental:{authInterrupts:!!l.experimental.authInterrupts},cacheComponents:!!l.cacheComponents,supportsDynamicResponse:B,incrementalCache:(0,h.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:l.cacheLife,waitUntil:r.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,r,i)=>hs.onRequestError(e,t,i,A)},sharedContext:{buildId:a}},$=new g.NodeNextRequest(e),H=new g.NodeNextResponse(t),W=y.NextRequestAdapter.fromNodeNextRequest($,(0,y.signalFromNodeResponse)(t));try{let n=async e=>hs.handle(W,q).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let r=V.getRootSpanAttributes();if(!r)return;if(r.get("next.span_type")!==v.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${r.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let n=r.get("next.route");if(n){let t=`${U} ${n}`;e.setAttributes({"next.route":n,"http.route":n,"next.span_name":t}),e.updateName(t)}else e.updateName(`${U} ${i}`)}),s=!!(0,h.getRequestMeta)(e,"minimalMode"),a=async a=>{var o,u;let h=async({previousCacheEntry:o})=>{try{if(!s&&I&&O&&!o)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let i=await n(a);e.fetchMetrics=q.renderOpts.fetchMetrics;let l=q.renderOpts.pendingWaitUntil;l&&r.waitUntil&&(r.waitUntil(l),l=void 0);let c=q.renderOpts.collectedTags;if(!M)return await (0,S.sendResponse)($,H,i,q.renderOpts.pendingWaitUntil),null;{let e=await i.blob(),t=(0,C.toNodeOutgoingHttpHeaders)(i.headers);c&&(t[E.NEXT_CACHE_TAGS_HEADER]=c),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let r=void 0!==q.renderOpts.collectedRevalidate&&!(q.renderOpts.collectedRevalidate>=E.INFINITE_CACHE)&&q.renderOpts.collectedRevalidate,n=void 0===q.renderOpts.collectedExpire||q.renderOpts.collectedExpire>=E.INFINITE_CACHE?void 0:q.renderOpts.collectedExpire;return{value:{kind:w.CachedRouteKind.APP_ROUTE,status:i.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:r,expire:n}}}}catch(t){throw(null==o?void 0:o.isStale)&&await hs.onRequestError(e,t,{routerKind:"App Router",routePath:i,routeType:"route",revalidateReason:(0,b.getRevalidateReason)({isStaticGeneration:j,isOnDemandRevalidate:I})},A),t}},d=await hs.handleResponse({req:e,nextConfig:l,cacheKey:F,routeKind:c.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:k,isRoutePPREnabled:!1,isOnDemandRevalidate:I,revalidateOnlyGenerated:O,responseGenerator:h,waitUntil:r.waitUntil,isMinimalMode:s});if(!M)return null;if((null==d||null==(o=d.value)?void 0:o.kind)!==w.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==d||null==(u=d.value)?void 0:u.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});s||t.setHeader("x-nextjs-cache",I?"REVALIDATED":d.isMiss?"MISS":d.isStale?"STALE":"HIT"),R&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let f=(0,C.fromNodeOutgoingHttpHeaders)(d.value.headers);return s&&M||f.delete(E.NEXT_CACHE_TAGS_HEADER),!d.cacheControl||t.getHeader("Cache-Control")||f.get("Cache-Control")||f.set("Cache-Control",(0,T.getCacheControlHeader)(d.cacheControl)),await (0,S.sendResponse)($,H,new Response(d.value.body,{headers:f,status:d.value.status||200})),null};z?await a(z):await V.withPropagatedContext(e.headers,()=>V.trace(v.BaseServerSpan.handleRequest,{spanName:`${U} ${i}`,kind:d.SpanKind.SERVER,attributes:{"http.method":U,"http.target":e.url}},a))}catch(t){if(t instanceof _.NoFallbackError||await hs.onRequestError(e,t,{routerKind:"App Router",routePath:P,routeType:"route",revalidateReason:(0,b.getRevalidateReason)({isStaticGeneration:j,isOnDemandRevalidate:I})}),M)throw t;return await (0,S.sendResponse)($,H,new Response(null,{status:500})),null}}e.s(["handler",()=>hu,"patchFetch",()=>hc,"routeModule",()=>hs,"serverHooks",()=>hl,"workAsyncStorage",()=>ha,"workUnitAsyncStorage",()=>ho],27671)}];

//# sourceMappingURL=4f487_67b04dde._.js.map